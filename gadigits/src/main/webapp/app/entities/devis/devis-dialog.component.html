<form name="editForm" role="form" novalidate #editForm="ngForm">
    <!-- Breadcrumb -->
    <div class="breadcrumb-holder">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-10">
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a routerLink="/"><span class="fa fa-home"></span>&nbsp;&nbsp;<span
                                    jhiTranslate="global.menu.home">Home</span></a></li>
                        <li class="breadcrumb-item"><span jhiTranslate="auxiliumApp.devis.home.title">Dossiers</span>
                        </li>
                    </ul>
                </div>
                <div class="col-sm-2"
                    *ngIf="(viewGaDigits && reparateur.isGaEstimate  &&  isQuoteEntry  && receiveVehiculeAdd && !isConfirmationModificationPrix)
                    || (viewGaDigits && reparateur.isGaEstimate  && isQuoteEntry && !receiveVehicule && DevisComplementary) || (demontageGT && reparateur.isGaEstimate)">
                    <button type="button" class="btn btn-primary btn-sm pull-right"
                        (click)="GTEstimate();addListenerToIframe($event);" style="margin-top:15px">
                        <span class="fa fa-edit"></span> <span>GA Estimate</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-11">
        <i class="fa fa-history" aria-hidden="true" (click)="historyApec()"
            style="font-size: 35px; position: absolute; right: 16px;top: 11px;"></i>
    </div>
    <!-- iframe for gt estimate -->
    <iframe *ngIf="useGtEstimate" id="myFrame" [src]="this.gaestimateUrl " name="myFrame" width="100%" height="2000px"
        frameBorder="0"></iframe>

    <section class="forms">

        <body>
            <div class="container-fluid">
                <!-- Page Header-->
                <header>
                    <h1 class="h3 display">
                        <jhi-alert-error></jhi-alert-error>
                    </h1>
                </header>
                <!-- Insured and recption vehicle details blocks -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="row">
                            <!-- Insured details -->
                            <div class="col-sm-6">
                                <div class="card">
                                    <span class="anchor" id="formUserEdit"></span>
                                    <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                        data-toggle="collapse" href="#AssurDetails">
                                        <strong jhiTranslate="auxiliumApp.contratAssurance.assure">Détails de
                                            l'assuré</strong>{{sinisterPec.reference}}
                                    </div>
                                    <br />
                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="form-group col-sm-3">
                                                <label jhiTranslate="auxiliumApp.assure.assure"
                                                    for="field_assurePrenom">Assuré</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    name="assurePrenom" id="field_assurePrenom"
                                                    [(ngModel)]="insured.fullName" readonly />
                                            </div>
                                            <div class="form-group col-sm-3">
                                                <label jhiTranslate="auxiliumApp.vehiculeAssure.immatriculationVehicule"
                                                    for="field_immatriculationVehicule"> Immatriculation </label>
                                                <input type="text" class="form-control form-control-sm"
                                                    name="immatriculationVehicule" id="field_immatriculationVehicule"
                                                    [(ngModel)]="vehicule.immatriculationVehicule" readonly />
                                            </div>
                                            <div class="form-group col-sm-6">
                                                <label jhiTranslate="auxiliumApp.vehiculeAssure.numeroChassis"
                                                    for="field_numeroChassis">Numéro du chassis</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    name="numeroChassis" id="field_numeroChassis" [required]="isReceptVeh"
                                                    [(ngModel)]="vehicule.numeroChassis" [disabled]="!isReceptVeh" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="form-group col-sm-3">
                                                <label jhiTranslate="auxiliumApp.contratAssurance.energie"
                                                    for="field_energie">Energie</label>
                                                <input type="text" class="form-control form-control-sm" name="energie"
                                                    id="field_energie" [(ngModel)]="vehicule.puissance" readonly />
                                            </div>
                                            <div class="form-group col-sm-3">
                                                <label jhiTranslate="auxiliumApp.contratAssurance.marque"
                                                    for="field_marqueLibelle">Marque</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    name="marqueLibelle" id="field_marqueLibelle"
                                                    [(ngModel)]="vehicule.marqueLibelle" readonly />
                                            </div>
                                            <div class="form-group col-sm-3">
                                                <label jhiTranslate="auxiliumApp.contratAssurance.modele"
                                                    for="field_modeleLibelle">Modele</label>
                                                <input id="field_modeleLibelle" type="text"
                                                    class="form-control form-control-sm" name="modeleLibelle"
                                                    [(ngModel)]="vehicule.modeleLibelle" readonly />
                                            </div>
                                            <div class="col-sm-3">
                                                <div *ngIf="AvisExpert">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.reparateur.detail.title"
                                                        for="field_raisonSociale">Raison Sociale</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="raisonSociale" id="field_raisonSocial"
                                                        [(ngModel)]="reparateur.raisonSociale" disabled />
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <div *ngIf="AvisExpert &&  contratAssurance.marketValue ">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.contratAssurance.valeurAssure"
                                                        for="field_raisonSociale">Raison Sociale</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="marketValue" id="field_marketValue"
                                                        [(ngModel)]=" contratAssurance.marketValue" disabled />
                                                </div>
                                            </div>
                                            <div class="col-sm-3" *ngIf="AvisExpert && reparateur.raisonSociale">
                                                <label class="form-control-label"
                                                    jhiTranslate="auxiliumApp.reparateur.telPerVisVis"
                                                    for="field_telPerVisVis">telPerVisVis</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    name="telPerVisVis" id="field_telPerVisVis"
                                                    [(ngModel)]="reparateur.telPerVisVis" disabled />
                                            </div>

                                            <div class="col-sm-3" *ngIf="AvisExpert">
                                                <label class="form-control-label"
                                                    jhiTranslate="auxiliumApp.sinisterPec.modeGestion"
                                                    for="field_modeGestion">modeGestion</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    name="telmodeGestion" id="field_modeGestion"
                                                    [(ngModel)]="sinisterPec.labelModeGestion" disabled />
                                            </div>
                                            <div class="col-sm-3">
                                                <label jhiTranslate="auxiliumApp.contratAssurance.usage"
                                                    for="field_usage"> Usage </label>
                                                <select class="form-control form-control-sm" id="field_usage"
                                                    name="usage" [(ngModel)]="vehicule.usageId" disabled>
                                                    <option [ngValue]="refUsageContratOption.id"
                                                        *ngFor="let refUsageContratOption of refusagecontrats;">
                                                        {{refUsageContratOption.label}}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Vehicle reception details -->
                            <div class="col-sm-6">
                                <div *ngIf="expert != true">
                                    <div class="card">
                                        <span class="anchor" id="formUserEdit"></span>
                                        <div
                                            class=" collapsible-card card-header align-items-center collapsed notice notice-info">
                                            <strong> Réception Véhicule</strong>
                                        </div>
                                        <br />
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.sinisterPec.receptionVehicule"
                                                        for="field_receptionVehicule">Réception Véhicule</label>
                                                    <input type="checkbox" class="check-input" name="receptionVehicule"
                                                        id="field_receptionVehicule"
                                                        [(ngModel)]="sinisterPec.receptionVehicule" required
                                                        [disabled]="!receiveVehicule" />
                                                </div>
                                                <div class="col-sm-6" *ngIf="sinisterPec.receptionVehicule">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.sinisterPec.dateReceptionVehicule"
                                                        for="field_dateReceptionVehicule">dateReceptionVehicule</label>
                                                    <div class="input-group">
                                                        <input id="field_myDateReceptionVehicule"
                                                            class="form-control form-control-sm"
                                                            name="myDateReceptionVehicule" [(ngModel)]="myDate" required
                                                            readonly />
                                                        <span class="input-group-btn"></span>&nbsp;&nbsp;
                                                    </div>
                                                </div>

                                                <!--<div class="col-sm-6" *ngIf="!sinisterPec.receptionVehicule">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.sinisterPec.dateReceptionVehicule"
                                                        for="field_dateReceptionVehicule">dateReceptionVehicule</label>
                                                    <div class="input-group">
                                                        <input id="field_dateReceptionVehicule" type="text"
                                                            class="form-control form-control-sm"
                                                            name="dateReceptionVehicule" ngbDatepicker
                                                            #dateReceptionVehiculeDp="ngbDatepicker"
                                                            [(ngModel)]="sinisterPec.vehicleReceiptDate" required
                                                            [disabled]="!receiveVehicule" />
                                                        <span class="input-group-btn">
                                                            <button type="button" class="btn btn-sm btn-default"
                                                                (click)="dateReceptionVehiculeDp.toggle()"><i
                                                                    class="fa fa-calendar"></i></button>
                                                        </span>
                                                    </div>
                                                </div>-->
                                            </div>
                                        </div>
                                        <br />
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.sinisterPec.etatDuChoc"
                                                        for="field_etatduchoc">etat du choc</label>
                                                    <div class="input-group" data-toggle="buttons">
                                                        <label class="btn btn-sm btn-primary" for="ppInsured"
                                                            (click)="changeNatureReparation(true);">
                                                            <input type="radio"
                                                                [disabled]="sinisterPec.stepId != 15 && sinisterPec.stepId != 25 "
                                                                name="natureReparation" id="leger" autocomplete="off"
                                                                [value]="true" [(ngModel)]="sinisterPec.lightShock">
                                                            Choc Léger
                                                        </label> &nbsp;
                                                        <label class="btn btn-sm btn-primary" for="pmInsured"
                                                            (click)="changeNatureReparation(false);">
                                                            <input type="radio"
                                                                [disabled]="sinisterPec.stepId != 15 && sinisterPec.stepId != 25"
                                                                name="natureReparation" id="nonLeger" autocomplete="off"
                                                                [value]="false" [(ngModel)]="sinisterPec.lightShock">
                                                            Choc non léger
                                                        </label>
                                                    </div>
                                                </div>

                                                <div class="col-sm-6">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.sinisterPec.demandeDeDemantage"
                                                        for="field_demandededemantage">demande de demontage</label>
                                                    <div class="input-group" data-toggle="buttons">
                                                        <label class="btn btn-sm btn-primary" for="ppInsured">
                                                            <input type="radio" name="demontage" id="demontage"
                                                                autocomplete="off" [value]="true"
                                                                [(ngModel)]="sinisterPec.disassemblyRequest" disabled>
                                                            Oui
                                                        </label> &nbsp;
                                                        <label class="btn btn-sm btn-primary" for="pmInsured">
                                                            <input type="radio" name="demontage" id="nonDemontage"
                                                                autocomplete="off" [value]="false"
                                                                [(ngModel)]="sinisterPec.disassemblyRequest" disabled>
                                                            Non
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <br>
                                        <div class="col-sm-12" *ngIf="AvisExpert || receiveVehiculeAdd ">
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.pieceJointe.constat"
                                                        for="attachmentConstat">constat</label>
                                                </div>

                                                <div class="col-sm-3">
                                                    <span class="input-group-btn">
                                                        <button type="button" class="btn btn-sm btn-default"
                                                            (click)="getPieceNew('prestationPEC', sinisterPec.id, 'Constat')"><i
                                                                class="fa fa-sm fa-download"></i></button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <br>
                                        <div class="col-sm-12" *ngIf="AvisExpert">
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.pieceJointe.ordreMission"
                                                        for="attachmentConstat">ordreMission</label>
                                                </div>

                                                <div class="col-sm-3" *ngIf="AvisExpert">
                                                    <div class="btn-group flex-btn-group-container">
                                                        <button type="button"
                                                            (click)="getOrdreMissionExpertPdf(sinisterPec)"
                                                            class="btn btn-sm btn-default"><i
                                                                class="fa fa-sm fa-download"></i></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- End vehicle reception details block -->

                        </div>
                    </div>
                </div>
                <!-- End insured and recption vehicle details blocks -->

                <!-------------------------------------------------------------------------Photos avant réparation------------------------------------------------------------------------------------->
                <form name="editFormPieceJointe" role="form" novalidate #editFormPieceJointe="ngForm"
                    *ngIf="sinisterPec.lightShock != undefined">
                    <div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="card">
                                    <span class="anchor" id="formUserEdit"></span>
                                    <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                        data-toggle="collapse" href="#collapsePhotos">
                                        <strong>Photos avant réparation</strong>
                                    </div>
                                    <br />
                                    <div id="collapsePhotos" class="card-body collapse" [ngbCollapse]="isCollapsed">
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_faceAvantDoit"
                                                                    jhiTranslate="auxiliumApp.reparateur.faceAvantDroit"
                                                                    for="field_faceAvantDoit">face
                                                                    Avant Droit
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showFaceAvantDroitAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_faceAvantDoit" required type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="faceAvantDroit"
                                                                        [(ngModel)]="faceAvantDroitAttachment.label"
                                                                        (change)="onFaceAvantDroitFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="faceAvantDroitPreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadfaceAvantDroitFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceAvantDroit">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Face Avant Droit')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceAvantDroit">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteFaceAvantDroitFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <br />

                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_faceAvantGauche"
                                                                    jhiTranslate="auxiliumApp.reparateur.faceAvantGauche"
                                                                    for="field_faceAvantGauche">face
                                                                    Avant Gauche
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showFaceAvantGaucheAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_faceAvantGauche" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="faceAvantGauche"
                                                                        [(ngModel)]="faceAvantGaucheAttachment.label"
                                                                        (change)="onFaceAvantGaucheFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="faceAvantGauchePreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadFaceAvantGaucheFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceAvantGauche">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Face Avant Gauche')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceAvantGauche">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteFaceAvantGaucheFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <br />


                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_faceArriereDroit"
                                                                    jhiTranslate="auxiliumApp.reparateur.faceArriereDroit"
                                                                    for="field_faceArriereDroit">face Arriere Droit
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4"
                                                                *ngIf="showFaceArriereDroitAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_faceArriereDroit" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="faceArriereDroit"
                                                                        [(ngModel)]="faceArriereDroitAttachment.label"
                                                                        (change)="onFaceArriereDroitFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="faceArriereDroitPreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadFaceArriereDroitFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceArriereDroit">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Face Arriere Droit')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceArriereDroit">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteFaceArriereDroitFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_FaceArriereGauche"
                                                                    jhiTranslate="auxiliumApp.reparateur.faceArriereGauche"
                                                                    for="field_FaceArriereGauche">Face Arriere Gauche
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4"
                                                                *ngIf="showFaceArriereGaucheAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_FaceArriereGauche" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="FaceArriereGauche"
                                                                        [(ngModel)]="faceArriereGaucheAttachment.label"
                                                                        (change)="onFaceArriereGaucheFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="faceArriereGauchePreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadFaceArriereGaucheFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceArriereGauche">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Face Arriere Gauche')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showFaceArriereGauche">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteFaceArriereGaucheFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_Finition"
                                                                    jhiTranslate="auxiliumApp.reparateur.finition"
                                                                    for="field_Finition">Finition
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showFinitionAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_Finition" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="Finition"
                                                                        [(ngModel)]="finitionAttachment.label"
                                                                        (change)="onFinitionFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="finitionPreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadFinitionFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn" *ngIf="showFinition">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Finition')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn" *ngIf="showFinition">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteFinitionFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <br />
                                                <div class="col-lg-6">
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_nSerie"
                                                                    jhiTranslate="auxiliumApp.reparateur.nSerie"
                                                                    for="field_nSerie">N°
                                                                    Série
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showNSerieAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_nSerie" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="nSerie"
                                                                        [(ngModel)]="nSerieAttachment.label"
                                                                        (change)="onNSerieFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn" *ngIf="nSeriePreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadNSerieFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn" *ngIf="showNSerie">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'NSerie')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn" *ngIf="showNSerie">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteNSerieFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_immatriculation"
                                                                    jhiTranslate="auxiliumApp.reparateur.immatriculation"
                                                                    for="field_immatriculation">Immatriculation</label>
                                                            </div>

                                                            <div class="col-lg-4" *ngIf="showImmatriculationAttachment">
                                                                <div class="form-group">

                                                                    <input id="field_immatriculation" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="immatriculation"
                                                                        [(ngModel)]="immatriculationAttachment.label"
                                                                        (change)="onImmatriculationFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="immatriculationPreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadImmatriculationFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showImmatriculation">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Immatriculation')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showImmatriculation">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteImmatriculationFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>


                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_compteur"
                                                                    jhiTranslate="auxiliumApp.reparateur.compteur"
                                                                    for="field_compteur">compteur</label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showCompteurAttachment">
                                                                <div class="form-group">

                                                                    <input id="field_compteur" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="compteur"
                                                                        [(ngModel)]="compteurAttachment.label"
                                                                        (change)="onCompteurFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="compteurPreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadCompteurFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn" *ngIf="showCompteur">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Compteur')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn" *ngIf="showCompteur">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteCompteurFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <br />
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_carteGrise"
                                                                    jhiTranslate="auxiliumApp.reparateur.carteGrise"
                                                                    for="field_carteGrise">carte Grise</label>
                                                            </div>

                                                            <div class="col-lg-4" *ngIf="showCarteGriseAttachment">
                                                                <div class="form-group">

                                                                    <input id="field_carteGrise" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="carteGrise"
                                                                        [(ngModel)]="carteGriseAttachment.label"
                                                                        (change)="onCarteGriseFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png,.pdf" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="carteGrisePreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadCarteGriseFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showCarteGrise">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('quotation', sinisterPec.id, 'Carte Grise Quotation')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showCarteGrise">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteCarteGriseFile()"
                                                                            [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <br />
                                                    <!--<div *ngIf="showBlockGTRapport" class="col-lg-12">
                                                                <div class="row">
                                                                    <div class="col-sm-3">
                                                                        <label class="field_gt"
                                                                            jhiTranslate="auxiliumApp.quotation.gtRapport"
                                                                            for="field_gt">gt Rapport</label>
                                                                    </div>
            
                                                                    <div class="col-lg-4" *ngIf="showGTAttachment && !gtShow">
                                                                        <div class="form-group">
            
                                                                            <input id="field_gt" type="file"
                                                                                class="form-control form-control-sm" name="gt"
                                                                                [(ngModel)]="gtAttachment.label"
                                                                                (change)="onGTFileChange($event)"
                                                                                accept=".jpg,.jpeg,.png,.pdf" required />
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-5">
                                                                        <div class="form-group">
                                                                            <span class="input-group-btn"
                                                                                *ngIf="gtPreview && !gtShow">
                                                                                <button type="button" class="btn btn-sm btn-default"
                                                                                    (click)="downloadGTFile()"><i
                                                                                        class="fa fa-sm fa-download"></i></button>
                                                                            </span>
                                                                            <span class="input-group-btn" *ngIf="gtShow">
                                                                                <button type="button" class="btn btn-sm btn-default"
                                                                                    (click)="getPieceNew('quotation', sinisterPec.id, 'GTEstimate')"><i
                                                                                        class="fa fa-sm fa-download"></i></button>
                                                                            </span>
                                                                            <span class="input-group-btn"
                                                                                *ngIf="gtPreview && !gtShow">
                                                                                <button type="button" class="btn btn-danger btn-sm"
                                                                                    (click)="deleteGTFile()"
                                                                                    [disabled]="!isReceptionVehicule && !isDemontageVehicule"><i
                                                                                        class="fa fa-sm fa-remove"></i></label>
                                                                            </span>
                                                                        </div>
                                                                    </div>
            
                                                                </div>
                                                            </div>-->
                                                    <br />
                                                    <div class="col-lg-12"
                                                        *ngIf="quoteValidation && sinisterPec.modeId == 2">
                                                        <div class="row">
                                                            <div class="col-sm-6">
                                                                <label class="form-control-label"
                                                                    jhiTranslate="auxiliumApp.sinisterPec.photosTiers"
                                                                    for="field_receptionVehicule">Photos Tiers</label>
                                                                <input type="checkbox" class="check-input"
                                                                    name="receptionVehicule"
                                                                    id="field_receptionVehicule"
                                                                    [(ngModel)]="sinisterPec.thirdPhotos" />
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                        <br />
                                        <div class="col-sm-2"
                                            *ngIf="(isReceptionVehicule || isDemontageVehicule) && !isConfirmationModificationPrix && isNvModif ">
                                            <button type="button" class="btn btn-primary btn-sm pull-right"
                                                (click)="ajoutNouvelpieceJointe();" style="margin-top:15px">
                                                <span class="fa fa-edit"></span> <span>Ajouter Nouvelle Piéce Jointe
                                                </span>
                                            </button>
                                        </div>
                                        <br /><br />

                                        <div *ngIf="ajoutNouvelpieceform">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-3">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.pieceJointe.libelle"
                                                            for="field_libelle">Libelle</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            name="libelle" id="libelle"
                                                            [(ngModel)]="pieceAttachment1.label" />
                                                        <div [hidden]="!isError">
                                                            <small class="form-text text-danger"
                                                                [hidden]="!islibelleError"
                                                                jhiTranslate="entity.validation.required">This
                                                                field is required.</small>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.pieceJointe.file"
                                                            for="field_chemin">Fichier</label>
                                                        <input id="field_chemin" type="file"
                                                            class="form-control form-control-sm" name="field_chemin"
                                                            (change)="onPieceFileChange1($event)"
                                                            accept=".jpg,.jpeg,.png" [(ngModel)]="pieceAttachment1.type"
                                                            required />



                                                        <span class="input-group-btn" *ngIf="piecePreview1">
                                                            <button type="button" class="btn btn-sm btn-default"
                                                                (click)="downloadPieceFile1()"><i
                                                                    class="fa fa-sm fa-download"></i></button>
                                                        </span>



                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label style="width: 100%">&nbsp;</label>
                                                        <button
                                                            [disabled]="pieceAttachment1.label  == null ||  pieceAttachment1.type == undefined"
                                                            class="btn btn-sm btn-primary addnew"
                                                            (click)="ajoutPiece1();">
                                                            <span class="fa fa-plus"></span>
                                                            <span
                                                                jhiTranslate="auxiliumApp.observation.home.createLabel">Create
                                                                new Description
                                                            </span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <br /><br />
                                        <div class="col-sm-12">
                                            <div class="table-responsive"
                                                *ngIf="piecesAttachments && piecesAttachments.length > 0">
                                                <table class="table table-sm table-hover table-bordered">
                                                    <thead>
                                                        <tr jhiSort style="color: white; background-color: #167F92">
                                                            <th jhiSortBy="date"><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.libelle">Libelle</span>
                                                                <span class="fa fa-sort"></span></th>
                                                            <th jhiSortBy="date"><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.dateCreation">Date
                                                                    Creation</span>
                                                                <span class="fa fa-sort"></span></th>

                                                            <th><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.file">Fichier</span>
                                                                <span class="fa fa-sort"></span></th>
                                                            <th><span></span>
                                                                <span class="fa fa-sort"></span></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let piecesjointe of piecesAttachments">
                                                            <td>{{piecesjointe.label}}</td>
                                                            <td>{{piecesjointe.creationDate | date:'dd/MM/yyyy HH:mm:ss'}}</td>

                                                            <td class="text-right" *ngIf="!piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button" class="btn btn-sm btn-default"
                                                                        (click)="downloadPieceFile(piecesjointe.pieceFile)"><i
                                                                            class="fa fa-sm fa-download"></i></button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right" *ngIf="piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button" class="btn btn-sm btn-default"
                                                                        (click)="getPieceForAttachment('PHOTOREPARATION', piecesjointe.id, piecesjointe.originalName)"><i
                                                                            class="fa fa-sm fa-download"></i></button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right" *ngIf="!piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <!--<button type="button"
                                                                                    (click)="prepareEditPieceJ(piecesjointe)"
                                                                                    class="btn btn-primary btn-sm">
                                                                                    <span class="fa fa-pencil"></span>
                                                                                </button>-->
                                                                    <button type="button"
                                                                        (click)="deletePieceJ(piecesjointe)"
                                                                        class="btn btn-danger btn-sm">
                                                                        <span class="fa fa-sm fa-remove"></span>
                                                                    </button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right"
                                                                *ngIf="piecesjointe.id && (isMaJDevis  || isReceptionVehicule || isDemontageVehicule)">
                                                                <div class="btn-group flex-btn-group-container">

                                                                    <button type="button"
                                                                        (click)="deletePieceJointesPH(piecesjointe)"
                                                                        class="btn btn-danger btn-sm"><i
                                                                            class="fa fa-sm fa-remove"></i></button>
                                                                </div>
                                                            </td>

                                                            </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <br>
                                        <div class="modal-footer" *ngIf="showButtonSaveAttachments">
                                            <button type="submit" class="btn btn-sm btn-primary"
                                                [disabled]="editFormPieceJointe.form.invalid"
                                                (click)="saveAttachments()">
                                                <span class="fa fa-save"></span>&nbsp;
                                                <span>Enregistrer les pièces jointes</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <!-------------------------------------------------------------------------Photos d'expertise------------------------------------------------------------------------------------->
                <form name="editFormPieceJointeExpertise" role="form" novalidate #editFormPieceJointeExpertise="ngForm" [hidden]="sinisterPec.stepId != 18"
                    >
                    <div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="card">
                                    <span class="anchor" id="formUserEdit"></span>
                                    <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                        data-toggle="collapse" href="#collapseExpertise">
                                        <strong>Photos aprés expertise terrain</strong>
                                    </div>
                                    <br />
                                    <div id="collapseExpertise" class="card-body collapse" [ngbCollapse]="isCollapsed">
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_pointChoc1"
                                                                    jhiTranslate="auxiliumApp.reparateur.pointChoc1"
                                                                    for="field_pointChoc1">Point Choc 1
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showPointChoc1Attachment">
                                                                <div class="form-group">
                                                                    <input id="field_pointChoc1" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="pointChoc1"
                                                                        [(ngModel)]="pointChoc1Attachment.label"
                                                                        (change)="onPointChoc1FileChange($event)" required
                                                                        accept=".jpg,.jpeg,.png,.pdf"  />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="pointChoc1Preview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadPointChoc1File()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showPointChoc1">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('pointChocExpertise', sinisterPec.id, 'Point Choc 1')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showPointChoc1">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deletePointChoc1File()"
                                                                            ><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <br />

                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_pointChoc2"
                                                                    jhiTranslate="auxiliumApp.reparateur.pointChoc2"
                                                                    for="field_pointChoc2">point Choc 2
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showPointChoc2Attachment">
                                                                <div class="form-group">
                                                                    <input id="field_pointChoc2" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="pointChoc2"
                                                                        [(ngModel)]="pointChoc2Attachment.label"
                                                                        (change)="onPointChoc2FileChange($event)" required
                                                                        accept=".jpg,.jpeg,.png,.pdf" />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="pointChoc2Preview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadPointChoc2File()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showPointChoc2">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="getPieceNew('pointChocExpertise', sinisterPec.id, 'Point Choc 2')"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="showPointChoc2">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deletePointChoc2File()"
                                                                            ><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>


                                                    
                                                </div>
                                                <br />
                                                <div class="col-lg-6">
                                                        <div class="col-lg-12">
                                                            <div class="row">
                                                                    <div class="col-sm-3">
                                                                        <label class="field_pointChoc3"
                                                                            jhiTranslate="auxiliumApp.reparateur.pointChoc3"
                                                                            for="field_pointChoc3">point Choc 3
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-lg-4"
                                                                        *ngIf="showPointChoc3Attachment">
                                                                        <div class="form-group">
                                                                            <input id="field_pointChoc3" type="file"
                                                                                class="form-control form-control-sm"
                                                                                name="pointChoc3"
                                                                                [(ngModel)]="pointChoc3Attachment.label"
                                                                                (change)="onPointChoc3FileChange($event)" required
                                                                                accept=".jpg,.jpeg,.png,.pdf" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-5">
                                                                        <div class="form-group">
                                                                            <span class="input-group-btn"
                                                                                *ngIf="pointChoc3Preview">
                                                                                <button type="button"
                                                                                    class="btn btn-sm btn-default"
                                                                                    (click)="downloadPointChoc3File()"><i
                                                                                        class="fa fa-sm fa-download"></i></button>
                                                                            </span>
                                                                            <span class="input-group-btn"
                                                                                *ngIf="showPointChoc3">
                                                                                <button type="button"
                                                                                    class="btn btn-sm btn-default"
                                                                                    (click)="getPieceNew('pointChocExpertise', sinisterPec.id, 'Point Choc 3')"><i
                                                                                        class="fa fa-sm fa-download"></i></button>
                                                                            </span>
                                                                            <span class="input-group-btn"
                                                                                *ngIf="showPointChoc3">
                                                                                <button type="button"
                                                                                    class="btn btn-danger btn-sm"
                                                                                    (click)="deletePointChoc3File()"
                                                                                    ><i
                                                                                        class="fa fa-sm fa-remove"></i></label>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                            </div>
                                                        </div>
                                                            <br />
                                                        <div class="col-lg-12">
                                                            <div class="row">
                                                                    <div class="col-sm-3">
                                                                        <label class="field_pointChoc4"
                                                                            jhiTranslate="auxiliumApp.reparateur.pointChoc4"
                                                                            for="field_pointChoc4">point Choc 4
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-lg-4"
                                                                        *ngIf="showPointChoc4Attachment">
                                                                        <div class="form-group">
                                                                            <input id="field_pointChoc4" type="file"
                                                                                class="form-control form-control-sm"
                                                                                name="pointChoc4"
                                                                                [(ngModel)]="pointChoc4Attachment.label"
                                                                                (change)="onPointChoc4FileChange($event)" required
                                                                                accept=".jpg,.jpeg,.png,.pdf" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-5">
                                                                        <div class="form-group">
                                                                            <span class="input-group-btn"
                                                                                *ngIf="pointChoc4Preview">
                                                                                <button type="button"
                                                                                    class="btn btn-sm btn-default"
                                                                                    (click)="downloadPointChoc4File()"><i
                                                                                        class="fa fa-sm fa-download"></i></button>
                                                                            </span>
                                                                            <span class="input-group-btn"
                                                                                *ngIf="showPointChoc4">
                                                                                <button type="button"
                                                                                    class="btn btn-sm btn-default"
                                                                                    (click)="getPieceNew('pointChocExpertise', sinisterPec.id, 'Point Choc 4')"><i
                                                                                        class="fa fa-sm fa-download"></i></button>
                                                                            </span>-
                                                                            <span class="input-group-btn"
                                                                                *ngIf="showPointChoc4">
                                                                                <button type="button"
                                                                                    class="btn btn-danger btn-sm"
                                                                                    (click)="deletePointChoc4File()"
                                                                                    ><i
                                                                                        class="fa fa-sm fa-remove"></i></label>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                            </div>
                                                        </div>

                                                </div>

                                            </div>
                                        </div>
                                        <br />
                                        <div class="col-sm-2">
                                            <button type="button" class="btn btn-primary btn-sm pull-right"
                                                (click)="ajoutNouvelpieceJointeExpertise();" style="margin-top:15px">
                                                <span class="fa fa-edit"></span> <span>Ajouter Nouvelle Piéce Jointe
                                                </span>
                                            </button>
                                        </div>
                                        <br /><br />

                                        <div *ngIf="ajoutNouvelpieceformExpertise">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-3">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.pieceJointe.libelle"
                                                            for="libellePointChoc">Libelle</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            name="libellePointChoc" id="libellePointChoc"
                                                            [(ngModel)]="pieceAttachment1.label" />
                                                        <div [hidden]="!isError">
                                                            <small class="form-text text-danger"
                                                                [hidden]="!islibelleError"
                                                                jhiTranslate="entity.validation.required">This
                                                                field is required.</small>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.pieceJointe.file"
                                                            for="field_cheminPointChoc">Fichier</label>
                                                        <input id="field_cheminPointChoc" type="file"
                                                            class="form-control form-control-sm" name="field_cheminPointChoc"
                                                            (change)="onPieceFileChange1($event)"
                                                            accept=".jpg,.jpeg,.png" [(ngModel)]="pieceAttachment1.type"
                                                            required />



                                                        <span class="input-group-btn" *ngIf="piecePreview1">
                                                            <button type="button" class="btn btn-sm btn-default"
                                                                (click)="downloadPieceFile1()"><i
                                                                    class="fa fa-sm fa-download"></i></button>
                                                        </span>



                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label style="width: 100%">&nbsp;</label>
                                                        <button
                                                            [disabled]="pieceAttachment1.label  == null ||  pieceAttachment1.type == undefined"
                                                            class="btn btn-sm btn-primary addnew"
                                                            (click)="ajoutPiece1Expertise();">
                                                            <span class="fa fa-plus"></span>
                                                            <span
                                                                jhiTranslate="auxiliumApp.observation.home.createLabel">Create
                                                                new Description
                                                            </span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <br /><br />
                                        <div class="col-sm-12">
                                            <div class="table-responsive"
                                                *ngIf="piecesAttachmentsExpertise && piecesAttachmentsExpertise.length > 0">
                                                <table class="table table-sm table-hover table-bordered">
                                                    <thead>
                                                        <tr jhiSort style="color: white; background-color: #167F92">
                                                            <th jhiSortBy="date"><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.libelle">Libelle</span>
                                                                <span class="fa fa-sort"></span></th>
                                                            <th jhiSortBy="date"><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.dateCreation">Date
                                                                    Creation</span>
                                                                <span class="fa fa-sort"></span></th>

                                                            <th><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.file">Fichier</span>
                                                                <span class="fa fa-sort"></span></th>
                                                            <th><span></span>
                                                                <span class="fa fa-sort"></span></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let piecesjointe of piecesAttachmentsExpertise">
                                                            <td>{{piecesjointe.label}}</td>
                                                            <td>{{piecesjointe.creationDate | date:'dd/MM/yyyy HH:mm:ss'}}</td>

                                                            <td class="text-right" *ngIf="!piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button" class="btn btn-sm btn-default"
                                                                        (click)="downloadPieceFile(piecesjointe.pieceFile)"><i
                                                                            class="fa fa-sm fa-download"></i></button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right" *ngIf="piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button" class="btn btn-sm btn-default"
                                                                        (click)="getPieceForAttachment('EXPERTISE', piecesjointe.id, piecesjointe.originalName)"><i
                                                                            class="fa fa-sm fa-download"></i></button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right" *ngIf="!piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <!--<button type="button"
                                                                                    (click)="prepareEditPieceJ(piecesjointe)"
                                                                                    class="btn btn-primary btn-sm">
                                                                                    <span class="fa fa-pencil"></span>
                                                                                </button>-->
                                                                    <button type="button"
                                                                        (click)="deletePieceJ(piecesjointe)"
                                                                        class="btn btn-danger btn-sm">
                                                                        <span class="fa fa-sm fa-remove"></span>
                                                                    </button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right"
                                                                *ngIf="piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">

                                                                    <button type="button"
                                                                        (click)="deletePieceJointesExpertise(piecesjointe)"
                                                                        class="btn btn-danger btn-sm"><i
                                                                            class="fa fa-sm fa-remove"></i></button>
                                                                </div>
                                                            </td>

                                                            </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <br>
                                        <div class="modal-footer">
                                            <button type="submit" class="btn btn-sm btn-primary"
                                                [disabled]="editFormPieceJointeExpertise.form.invalid || ((pieceAttachment1.label  != null ||  pieceAttachment1.type != undefined) && ajoutNouvelpieceformExpertise )"
                                                (click)="saveAttachmentsExpertise()">
                                                <span class="fa fa-save"></span>&nbsp;
                                                <span>Enregistrer les pièces jointes</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <!----------------------------------------------------------------devis------------------------------------------------------------->

                <div *ngIf="isQuoteEntry == true">
                    <div class="row">
                        <div class="col-lg-12">

                            <div class="card">
                                <span class="anchor" id="formUserEdit"></span>

                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#collapsedevis">
                                    <strong>Devis</strong>
                                </div>
                                <!--<button type="submit" class="btn btn-info btn-sm  center-block"
                                    (click)="printQuotationPdf()">
                                    <span class="fa fa-print"></span>&nbsp;
                                    <span jhiTranslate="entity.action.generation-lettre-ida">genererQuotation</span>
                                </button>-->
                                <div id="collapsedevis" class="card-body collapse" [ngbCollapse]="isCollapsed">
                                    <div class="card-body">
                                        <div class="row">
                                            <!-- MO details list -->

                                            <div class="col-lg-12">
                                                <div class="card">
                                                    <div class=" collapsible-card card-header align-items-center collapsed"
                                                        data-toggle="collapse" href="#collapseDetailsMo">
                                                        <h4 style="font-weight:bold;"
                                                            jhiTranslate="auxiliumApp.detailsMo.home.title">Details
                                                            mo
                                                        </h4>
                                                    </div>
                                                    <div id="collapseDetailsMo" class="card-body collapse">
                                                        <div class="row">
                                                            <div class="col-sm-12"
                                                                *ngIf="!AvisExpert && !quoteValidation && !modeConfirmation && isNvModif">
                                                                <label *ngIf="!moPieces || moPieces.length == 0"
                                                                    style="color: white">Vous
                                                                    devez paramètrer des types de pièce !</label>
                                                                <input type="button"
                                                                    class="btn btn-sm btn-primary addnew float-sm-right"
                                                                    style="margin-bottom: 10px;"
                                                                    (click)="addNewMoLine()"
                                                                    value="Ajouter main d'oeuvre">
                                                            </div>
                                                            <div class="col-sm-12">
                                                                <div class="table-responsive"
                                                                    *ngIf="detailsPiecesMO && detailsPiecesMO.length > 0" style="max-height: 500px;overflow: auto; ">
                                                                    <table class="table table-striped">
                                                                        <thead>
                                                                            <tr>
                                                                               
                                                                                <th
                                                                                    *ngIf="modeConfirmation || isMaJDevis  || validDevis">
                                                                                </th>
                                                                                <th
                                                                                    *ngIf="AvisExpert || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined )">
                                                                                    <span>Observation Expert</span>
                                                                                </th>
                                                                                <th *ngIf="AvisExpert">
                                                                                    <span> Nombre MO estimée
                                                                                    </span>
                                                                                </th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.designation">Designation</span>
                                                                                </th>
                                                                                <th></th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.typeIntervention">Type
                                                                                        Intervention
                                                                                    </span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.th">th</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.nombreHeures">Nombre
                                                                                        Heures
                                                                                    </span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                </th>
                                                                                <th></th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr
                                                                                *ngFor="let detailsPieceMo of detailsPiecesMO; let i=index">
                                                                             
                                                                                <td
                                                                                    *ngIf="modeConfirmation || isMaJDevis  || validDevis">
                                                                                    <div *ngIf="!detailsPieceMo.scaledDown && detailsPieceMo.isModified"
                                                                                       >
                                                                                        <a (click)="addLineModified(detailsPieceMo,detailsPiecesMO);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-plus"
                                                                                                style="color: red"></span></a>
                                                                                    </div>


                                                                                    <div *ngIf="detailsPieceMo.scaledDown  && detailsPieceMo.isModified"
                                                                                      >
                                                                                        <a (click)="removeLineModified(detailsPieceMo,detailsPiecesMO);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: rgb(84, 146, 71)"></span></a>

                                                                                    </div>
                                                                                </td>


                                                                                <td
                                                                                    *ngIf="AvisExpert  || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined && observationExpertColumn)">

                                                                                    <div *ngIf="AvisExpert || validDevis || (isOther && sinisterPec.expertId != undefined) || (modeConfirmation && detailsPieceMo.observationExpert !=  undefined )"
                                                                                       >
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="moObservation[{{i}}]"
                                                                                            [(ngModel)]="detailsPieceMo.observationExpert"
                                                                                            (ngModelChange)="DecisionExpertByObser(detailsPieceMo.observationExpert,detailsPieceMo)"
                                                                                            [disabled]=" modeConfirmation  || validDevis || isMaJDevis || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                            required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </div>
                                                                                </td>
                                                                                <td *ngIf="AvisExpert ">
                                                                                    <input type="number"
                                                                                        class="form-control form-control-sm"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.nombreMOEstime"
                                                                                        name="nombreMOEstime[{{i}}]"
                                                                                        [disabled]="detailsPieceMo.observationExpert == 1 || detailsPieceMo.observationExpert == 2 || modeConfirmation || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                </td>
                                                                                <td>
                                                                                    <input type="hidden"
                                                                                        name="piecMoDesignationId[{{i}}]"
                                                                                        [(ngModel)]="detailsPieceMo.designationId"
                                                                                        required>
                                                                                    <input list="piecesmodes"
                                                                                        name="piecMoDesignation[{{i}}]"
                                                                                        [(ngModel)]="detailsPieceMo.designation"
                                                                                        (change)="selectPieceMoDesignation(detailsPieceMo)"
                                                                                        (ngModelChange)="selectTapedPieceMoDesignation(detailsPieceMo)"
                                                                                        placeholder="Choisissez une désignation"
                                                                                        class="input input-sm"
                                                                                        [disabled]="( AvisExpert && detailsPieceMo.observationExpert == 1 ) || (AvisExpert && detailsPieceMo.observationExpert == 2) || modeConfirmation || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        required />
                                                                                    <datalist id="piecesmodes">
                                                                                        <select>
                                                                                            <option
                                                                                                *ngFor="let designationOption of moPieces; trackBy: trackPieceById">
                                                                                                {{designationOption.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </datalist>
                                                                                </td>
                                                                                <td>

                                                                                    <button type="button"
                                                                                        (click)="openAddPiece(detailsPieceMo, 1)"
                                                                                        [disabled]="modeConfirmation  || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        class="btn btn-sm btn-primary margin-right-5">
                                                                                        <span class="fa fa-plus"></span>
                                                                                    </button>

                                                                                </td>
                                                                                <td>
                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        [(ngModel)]="detailsPieceMo.typeInterventionId"
                                                                                        (ngModelChange)="observationExpertByTypeIntervention(detailsPieceMo); changeTypeInterventionMO(detailsPieceMo)"
                                                                                        [disabled]="AvisExpert || modeConfirmation  || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        name="interventionMo[{{i}}]"
                                                                                        required>
                                                                                        <option
                                                                                            [ngValue]="reftypeinterventionOption.id"
                                                                                            *ngFor="let reftypeinterventionOption of refOperationTypesMo">
                                                                                            {{reftypeinterventionOption.libelle}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.prixUnit"
                                                                                        (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                        name="puMo[{{i}}]"
                                                                                        [disabled]="AvisExpert  || modeConfirmation || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.nombreHeures"
                                                                                        (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                        name="nombreHeures[{{i}}]"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        [disabled]="AvisExpert || modeConfirmation"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.totalHt"
                                                                                        name="moTht[{{i}}]" readonly />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.discount"
                                                                                        (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                        name="discount[{{i}}]"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.amountDiscount"
                                                                                        name="totalDiscount[{{i}}]"
                                                                                        [disabled]="AvisExpert || modeConfirmation  || (isMaJDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.amountAfterDiscount"
                                                                                        name="amountAfterDiscountMo[{{i}}]"
                                                                                        [disabled]="AvisExpert || modeConfirmation  || (isMaJDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        readonly>
                                                                                </td>-->
                                                                                <td>
                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        name="vatMo[{{i}}]"
                                                                                        [(ngModel)]="detailsPieceMo.tva"
                                                                                        (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                        [disabled]="AvisExpert|| modeConfirmation || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        required>
                                                                                        <option [ngValue]="vat.vatRate"
                                                                                            *ngFor="let vat of listVat;">
                                                                                            {{vat.vatRate}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.amountVat"
                                                                                        name="amountTvaMo[{{i}}]"
                                                                                        [disabled]="AvisExpert|| modeConfirmation  || (isMaJDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        readonly />
                                                                                </td>-->
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.totalTtc"
                                                                                        name="moTtc[{{i}}]"
                                                                                        [disabled]="AvisExpert || modeConfirmation  || (isMaJDevis && detailsPieceMo.modifiedLine != null) || (validDevis && detailsPieceMo.modifiedLine != null)"
                                                                                        readonly />
                                                                                </td>
                                                                                <td
                                                                                    *ngIf="!modeConfirmation && !showRemoveLine">
                                                                                    <div
                                                                                        >
                                                                                        <a (click)="removeMoLine(detailsPieceMo, i)"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: red"></span></a>
                                                                                    </div>
                                                                                </td>
                                                                                <td *ngIf="modeConfirmation">
                                                                                    <div *ngIf="!detailsPieceMo.scaledDown && detailsPieceMo.isModified"
                                                                                       >
                                                                                        <a (click)="addLineModified(detailsPieceMo,detailsPiecesMO);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-plus"
                                                                                                style="color: red"></span></a>
                                                                                    </div>


                                                                                    <div *ngIf="detailsPieceMo.scaledDown  && detailsPieceMo.isModified"
                                                                                        >
                                                                                        <a (click)="removeLineModified(detailsPieceMo,detailsPiecesMO);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: rgb(84, 146, 71)"></span></a>

                                                                                    </div>
                                                                                </td>

                                                                            </tr>
                                                                            <tr>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    <div class="row justify-content-center"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- home peinture list -->
                                            <div class="col-lg-12">
                                                <div class="card">
                                                    <div class=" collapsible-card card-header align-items-center collapsed"
                                                        data-toggle="collapse" href="#collapseHomePaint">
                                                        <h4 style="font-weight:bold;"
                                                            jhiTranslate="auxiliumApp.detailsPieces.homePeinture">
                                                            Home
                                                            Peinture
                                                        </h4>
                                                    </div>
                                                    <div id="collapseHomePaint" class="card-body collapse">
                                                        <div class="row">
                                                            <div class="col-sm-12"
                                                                *ngIf="!AvisExpert && !quoteValidation  && !modeConfirmation &&isNvModif">
                                                                <label
                                                                    *ngIf="!ingredientPieces || ingredientPieces.length == 0"
                                                                    style="color: white">Vous
                                                                    devez paramètrer des types de pièce !</label>
                                                                <input type="button"
                                                                    class="btn btn-sm btn-primary addnew float-sm-right"
                                                                    style="margin-bottom: 10px;"
                                                                    (click)="addNewIngredientLine()"
                                                                    value="Ajouter ingrédient de peinture">
                                                            </div>
                                                            <div class="col-sm-12">
                                                                <div class="table-responsive"
                                                                    *ngIf="detailsPiecesIngredient && detailsPiecesIngredient.length > 0" style="max-height: 500px;overflow: auto; ">
                                                                    <table class="table table-striped">
                                                                        <thead>
                                                                            <tr>
                                                                              
                                                                                <th
                                                                                    *ngIf="modeConfirmation || isMaJDevis  || validDevis">
                                                                                </th>
                                                                                <th
                                                                                    *ngIf="AvisExpert  || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined ) && observationExpertColumn">
                                                                                    <span>Observation Expert</span>
                                                                                </th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.designation">Designation</span>
                                                                                </th>
                                                                                <th></th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.typeIntervention">Type
                                                                                        Intervention
                                                                                    </span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.th">th</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.nombreHeures">Nombre
                                                                                        Heures
                                                                                    </span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                </th>
                                                                                <th></th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr
                                                                                *ngFor="let dpIngredient of detailsPiecesIngredient ; let i=index">
                                                                              
                                                                                <td
                                                                                    *ngIf="modeConfirmation  || isMaJDevis  || validDevis">
                                                                                    <div *ngIf="!dpIngredient.scaledDown && dpIngredient.isModified"
                                                                                       >
                                                                                        <a (click)="addLineModified(dpIngredient,detailsPiecesIngredient);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-plus"
                                                                                                style="color: red"></span></a>
                                                                                    </div>
                                                                                    <div *ngIf="dpIngredient.scaledDown  && dpIngredient.isModified"
                                                                                        >
                                                                                        <a (click)="removeLineModified(dpIngredient,detailsPiecesIngredient);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: rgb(84, 146, 71)"></span></a>

                                                                                    </div>
                                                                                </td>

                                                                                <td
                                                                                    *ngIf="AvisExpert  || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined ) && observationExpertColumn">

                                                                                    <div *ngIf="AvisExpert  || validDevis ||  ((isOther || modeConfirmation) && dpIngredient.observationExpert !=  undefined)"
                                                                                        class="col-sm-3">
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="dpObservation[{{i}}]"
                                                                                            [(ngModel)]="dpIngredient.observationExpert"
                                                                                            (ngModelChange)="DecisionExpertByObser(dpIngredient.observationExpert,dpIngredient)"
                                                                                            [disabled]=" modeConfirmation  || validDevis || isMaJDevis || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                            required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </div>
                                                                                </td>

                                                                                <td>

                                                                                    <input type="hidden"
                                                                                        name="piecPeDesignationId[{{i}}]"
                                                                                        [(ngModel)]="dpIngredient.designationId"
                                                                                        required>
                                                                                    <input list="piecespedes"
                                                                                        name="piecPeDesignation[{{i}}]"
                                                                                        [(ngModel)]="dpIngredient.designation"
                                                                                        (change)="selectPiecePeDesignation(dpIngredient)"
                                                                                        (ngModelChange)="selectTapedPiecePeDesignation(dpIngredient)"
                                                                                        placeholder="Choisissez une désignation"
                                                                                        class="input input-sm"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        required />



                                                                                    <datalist id="piecespedes">
                                                                                        <select>
                                                                                            <option
                                                                                                *ngFor="let designationOption of ingredientPieces; trackBy: trackPieceById">
                                                                                                {{designationOption.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </datalist>

                                                                                </td>
                                                                                <td>

                                                                                    <button type="button"
                                                                                        (click)="openAddPiece(dpIngredient, 2)"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        class="btn btn-sm btn-primary margin-right-5">
                                                                                        <span class="fa fa-plus"></span>
                                                                                    </button>

                                                                                </td>

                                                                                <td>

                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        [(ngModel)]="dpIngredient.typeInterventionId"
                                                                                        (ngModelChange)="changeTypeInterventionIP(dpIngredient)"
                                                                                        [disabled]="AvisExpert|| modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        name="interventionIng[{{i}}]"
                                                                                        required>
                                                                                        <option
                                                                                            [ngValue]="reftypeinterventionOption.id"
                                                                                            *ngFor="let reftypeinterventionOption of refOperationTypesPeinture">
                                                                                            {{reftypeinterventionOption.libelle}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td>

                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.prixUnit"
                                                                                        (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                        name="pu[{{i}}]"
                                                                                        [disabled]=" (AvisExpert && dpIngredient.observationExpert == 1) || ( AvisExpert && dpIngredient.observationExpert == 2) ||  modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required readonly />
                                                                                </td>
                                                                                <td>

                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="dpIngredient.quantite"
                                                                                        (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                        name="quantite[{{i}}]"
                                                                                        style="width: 100px"
                                                                                        [disabled]="(AvisExpert && dpIngredient.observationExpert == 1) || (AvisExpert && dpIngredient.observationExpert == 2) || modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [value]="dpIngredient.totalHt"
                                                                                        name="ingrTht[{{i}}]" readonly
                                                                                        style="width: 100px"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null)" />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="dpIngredient.discount"
                                                                                        [disabled]="modeConfirmation"
                                                                                        (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                        name="discountIng[{{i}}]"
                                                                                        style="width: 100px"
                                                                                        [disabled]="AvisExpert|| modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.amountDiscount"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null)"
                                                                                        name="totalDiscountIng[{{i}}]"
                                                                                        readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.amountAfterDiscount"
                                                                                        name="amountAfterDiscountIng[{{i}}]"
                                                                                        readonly>
                                                                                </td>-->
                                                                                <td>

                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        name="vatIng[{{i}}]"
                                                                                        [(ngModel)]="dpIngredient.tva"
                                                                                        (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                        [disabled]="AvisExpert|| modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        required>
                                                                                        <option [ngValue]="vat.vatRate"
                                                                                            *ngFor="let vat of listVat;">
                                                                                            {{vat.vatRate}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.amountVat"
                                                                                        name="amountTvaIng[{{i}}]"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null)"
                                                                                        readonly>
                                                                                </td>-->
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="dpIngredient.totalTtc"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && dpIngredient.modifiedLine != null) || (validDevis && dpIngredient.modifiedLine != null)"
                                                                                        name="ingrTtc[{{i}}]" readonly
                                                                                        style="width: 100px" />
                                                                                </td>
                                                                                <td
                                                                                    *ngIf="!modeConfirmation && !showRemoveLine">
                                                                                    <div >
                                                                                        <a (click)="removeIngredientLine(dpIngredient, i)"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: red"></span></a>
                                                                                    </div>
                                                                                </td>

                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    <div class="row justify-content-center"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- home fourniture list -->
                                                        </br>

                                                        <div class="row">
                                                            <div class="col-sm-12"
                                                                *ngIf="!AvisExpert && !quoteValidation  && !modeConfirmation && isNvModif">
                                                                <label
                                                                    *ngIf="!fourniturePieces || fourniturePieces.length == 0"
                                                                    style="color: white">Vous
                                                                    devez paramètrer des types de pièce !</label>
                                                                <input type="button"
                                                                    class="btn btn-sm btn-primary addnew float-sm-right"
                                                                    style="margin-bottom: 10px;"
                                                                    (click)="addNewPieceFournitureLineForPetiteFourniture()"
                                                                    value="Ajouter petite fourniture">
                                                            </div>
                                                            <div class="col-sm-12">
                                                                <div class="table-responsive"
                                                                    *ngIf="detailsPiecesFourniture && detailsPiecesFourniture.length > 0" style="max-height: 500px;overflow: auto; ">
                                                                    <table class="table table-striped">
                                                                        <thead>
                                                                            <tr>
                                                                              
                                                                               
                                                                                <th
                                                                                    *ngIf="modeConfirmation || isMaJDevis  || validDevis ">
                                                                                </th>
                                                                                <th
                                                                                    *ngIf="AvisExpert || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined && observationExpertColumn)">
                                                                                    <span>Observation Expert</span>
                                                                                </th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.designation">Designation</span>
                                                                                </th>
                                                                                <th></th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.typeIntervention">Type
                                                                                        Intervention
                                                                                    </span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.th">th</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.nombreHeures">Nombre
                                                                                        Heures
                                                                                    </span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                </th>
                                                                                <th></th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr
                                                                                *ngFor="let fourniture of detailsPiecesFourniture ; let i=index">

                                                                            
                                                                               
                                                                                <td
                                                                                    *ngIf="modeConfirmation || isMaJDevis  || validDevis">
                                                                                    <div *ngIf="!fourniture.scaledDown && fourniture.isModified">
                                                                                        <a (click)="addLineModified(fourniture,detailsPiecesFourniture);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-plus"
                                                                                                style="color: red"></span></a>
                                                                                    </div>
                                                                                    <div *ngIf="fourniture.scaledDown  && fourniture.isModified">
                                                                                        <a (click)="removeLineModified(fourniture,detailsPiecesFourniture);"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: rgb(84, 146, 71)"></span></a>

                                                                                    </div>
                                                                                </td>




                                                                                <td
                                                                                    *ngIf="AvisExpert || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined && observationExpertColumn)">
                                                                                    <div *ngIf="AvisExpert  || ((validDevis || isOther || modeConfirmation)  && fourniture.observationExpert !=  undefined )"
                                                                                        class="col-sm-3">
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="fournObservation[{{i}}]"
                                                                                            [(ngModel)]="fourniture.observationExpert"
                                                                                            (ngModelChange)="DecisionExpertByObser(fourniture.observationExpert,fourniture)"
                                                                                            [disabled]="modeConfirmation || validDevis || ((isMaJDevis || modeConfirmation)  && fourniture.modifiedLine != null) || isMaJDevis || (validDevis && fourniture.modifiedLine != null)"
                                                                                            required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservationsPF">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </div>
                                                                                </td>

                                                                                <td>
                                                                                    <input type="hidden"
                                                                                        name="piecFoDesignationId[{{i}}]"
                                                                                        [(ngModel)]="fourniture.designationId"
                                                                                        required>
                                                                                    <input list="piecesfodes"
                                                                                        name="piecFoDesignation[{{i}}]"
                                                                                        [(ngModel)]="fourniture.designation"
                                                                                        (ngModelChange)="selectTapedPieceFoDesignation(fourniture)"
                                                                                        (change)="selectPieceFoDesignation(fourniture)"
                                                                                        placeholder="Choisissez une désignation"
                                                                                        class="input input-sm"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)"
                                                                                        required />


                                                                                    <datalist id="piecesfodes">
                                                                                        <select>
                                                                                            <option
                                                                                                *ngFor="let designationOption of fourniturePieces; trackBy: trackPieceById">
                                                                                                {{designationOption.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </datalist>

                                                                                </td>
                                                                                <td>

                                                                                    <button type="button"
                                                                                        (click)="openAddPiece(fourniture, 3)"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)"
                                                                                        class="btn btn-sm btn-primary margin-right-5">
                                                                                        <span class="fa fa-plus"></span>
                                                                                    </button>

                                                                                </td>

                                                                                <td>

                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        [(ngModel)]="fourniture.typeInterventionId"
                                                                                        (ngModelChange)="changeTypeInterventionPF(fourniture)"
                                                                                        [disabled]=" AvisExpert || modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)"
                                                                                        name="interventionFourn[{{i}}]"
                                                                                        required>
                                                                                        <option
                                                                                            [ngValue]="reftypeinterventionOption.id"
                                                                                            *ngFor="let reftypeinterventionOption of refOperationTypesFourniture">
                                                                                            {{reftypeinterventionOption.libelle}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td>

                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.prixUnit"
                                                                                        (ngModelChange)="changeFourniture(fourniture)"
                                                                                        name="puFour[{{i}}]"
                                                                                        [disabled]="AvisExpert|| modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required readonly />

                                                                                </td>
                                                                                <td>

                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="fourniture.quantite"
                                                                                        (ngModelChange)="changeFourniture(fourniture)"
                                                                                        name="quantiteFourn[{{i}}]"
                                                                                        style="width: 100px"
                                                                                        [disabled]=" ( AvisExpert && fourniture.observationExpert == 1 )|| ( AvisExpert && fourniture.observationExpert == 2 )|| modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [value]="fourniture.totalHt"
                                                                                        name="fournTht[{{i}}]" readonly
                                                                                        style="width: 100px" />
                                                                                </td>

                                                                                <td>
                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="fourniture.discount"
                                                                                        (ngModelChange)="changeFourniture(fourniture)"
                                                                                        name="discountFourn[{{i}}]"
                                                                                        style="width: 100px" min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null)"
                                                                                        required />
                                                                                </td>

                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.amountDiscount "
                                                                                        name="totalDiscountFourn[{{i}}]"
                                                                                        [disabled]="(AvisExpert && fourniture.observationExpert == 1) || (AvisExpert && fourniture.observationExpert == 2 ) || modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null) "
                                                                                        readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.amountAfterDiscount"
                                                                                        name="amountAfterDiscountFourn[{{i}}]"
                                                                                        [disabled]="(AvisExpert && fourniture.observationExpert == 1) || ( AvisExpert &&fourniture.observationExpert == 2) ||  modeConfirmation || (isMaJDevis && fourniture.modifiedLine != null)"
                                                                                        readonly>
                                                                                </td>-->
                                                                                <td>

                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        name="vatFourn[{{i}}]"
                                                                                        [(ngModel)]="fourniture.tva"
                                                                                        (ngModelChange)="changeFourniture(fourniture)"
                                                                                        [disabled]="AvisExpert || modeConfirmation  || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)"
                                                                                        required>
                                                                                        <option [ngValue]="vat.vatRate"
                                                                                            *ngFor="let vat of listVat;">
                                                                                            {{vat.vatRate}}
                                                                                        </option>
                                                                                    </select>

                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.amountVat"
                                                                                        name="amountTvaFourn[{{i}}]"
                                                                                        [disabled]="modeConfirmation  || (isMaJDevis && fourniture.modifiedLine != null)"
                                                                                        readonly>
                                                                                </td>-->
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="fourniture.totalTtc"
                                                                                        name="fournTtc[{{i}}]" readonly
                                                                                        style="width: 100px"
                                                                                        [disabled]="AvisExpert || modeConfirmation  || (isMaJDevis && fourniture.modifiedLine != null) || (validDevis && fourniture.modifiedLine != null)" />
                                                                                </td>
                                                                                <td
                                                                                    *ngIf="!modeConfirmation && !showRemoveLine">
                                                                                    <div>
                                                                                        <a (click)="removeFournitureLine(fourniture, i)"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: red"></span></a>
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    <div class="row justify-content-center"></div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <!-- End fourniture list-->

                                                    </div>
                                                </div>
                                            </div>

                                            <!-- pieces de rechange -->
                                            <div class="col-lg-12">
                                                <div class="card">
                                                    <div class=" collapsible-card card-header align-items-center collapsed"
                                                        data-toggle="collapse" href="#collapseHomePieces">
                                                        <h4 style="font-weight:bold;"
                                                            jhiTranslate="auxiliumApp.detailsPieces.homeRechange">
                                                            Home
                                                            pieces
                                                        </h4>
                                                    </div>

                                                    <div id="collapseHomePieces" class="card-body collapse">
                                                        <div class="row">
                                                            <div class="col-sm-12"
                                                                *ngIf="!AvisExpert && !quoteValidation && !modeConfirmation &&isNvModif ">
                                                                <label *ngIf="!moPieces || moPieces.length == 0"
                                                                    style="color: white">Vous
                                                                    devez paramètrer des types de pièce !</label>
                                                                <input type="button"
                                                                    class="btn btn-sm btn-primary addnew float-sm-right"
                                                                    style="margin-bottom: 10px;"
                                                                    (click)="addNewPieceRechangeLine()"
                                                                    value="Ajouter pièce de rechange">
                                                            </div>
                                                            <div class="col-sm-12">
                                                                <div class="table-responsive"
                                                                    *ngIf="detailsPieces && detailsPieces.length > 0" style="max-height: 500px;overflow: auto; " >
                                                                    <table class="table table-striped" >
                                                                        <thead >
                                                                            <tr>

                                                                                <th
                                                                                    *ngIf="modeConfirmation || isMaJDevis  || validDevis">

                                                                                </th>
                                                                                <th
                                                                                    *ngIf="AvisExpert  || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined && observationExpertColumn)">
                                                                                    <span>Observation Expert</span>
                                                                                </th>
                                                                                <th
                                                                                    *ngIf="AvisExpert == true || showVetuste">
                                                                                    <span>Vétusté</span>
                                                                                </th>

                                                                                <!--<th *ngIf="AvisExpert || showVetuste">
                                                                                    <span>Vétusté HT </span>
                                                                                </th>
                                                                                <th *ngIf="AvisExpert || showVetuste">
                                                                                    <span> Vétusté TTC</span>
                                                                                </th>-->
                                                                                <!-- <th *ngIf="AvisExpert">
                                                                                    <span>participation
                                                                                        d’assuré </span>
                                                                                </th>
                                                                                <th *ngIf="AvisExpert">
                                                                                    <span> type participation
                                                                                        d’assuré </span>
                                                                                </th>-->
                                                                                <th><span>Observation</span></th>
                                                                                <th><span>Référence</span></th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsPieces.designation">Designation</span>
                                                                                </th>
                                                                                <th></th>
                                                                                <th></th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsPieces.prixUnit">Prix
                                                                                        Unit
                                                                                    </span></th>
                                                                                <th><span>Nature Pièce</span></th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsPieces.quantite">Quantite</span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                </th>
                                                                                <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                </th>
                                                                                <th></th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr
                                                                                *ngFor="let pieces of detailsPieces ; let i=index">

                                                                              
                                                                             
                                                                                <td
                                                                                    *ngIf="modeConfirmation  || isMaJDevis || validDevis">
                                                                                        <button (click)="addLineModified(pieces,detailsPieces);"
                                                                                        *ngIf="!pieces.scaledDown && pieces.isModified "
                                                                                            class="btn btn-sm btn-default " ><span
                                                                                                class="fa fa-plus"
                                                                                                style="color: red;"></span></button>
                                                                                        <button (click)="removeLineModified(pieces,detailsPieces);"
                                                                                        *ngIf="pieces.scaledDown  && pieces.isModified"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: rgb(84, 146, 71);"></span></button>

                                                                                   
                                                                                </td>


                                                                                <td
                                                                                    *ngIf="AvisExpert  || ((validDevis || isOther  || modeConfirmation) && sinisterPec.expertId != undefined)">

                                                                                    <div
                                                                                        *ngIf="AvisExpert || ((validDevis || isOther || modeConfirmation) && pieces.observationExpert != undefined )">

                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white;"
                                                                                            name="piecesObservation[{{i}}]"
                                                                                            [(ngModel)]="pieces.observationExpert"
                                                                                            (ngModelChange)="DecisionExpertByObser(pieces.observationExpert,pieces)"
                                                                                            [disabled]=" modeConfirmation || validDevis || (isMaJDevis && pieces.modifiedLine != null) || isMaJDevis || (validDevis && pieces.modifiedLine != null) "
                                                                                            required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </div>
                                                                                </td>

                                                                                <td
                                                                                    *ngIf="AvisExpert == true || showVetuste">
                                                                                    <input type="number"
                                                                                        class="form-control form-control-sm"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.vetuste"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        (ngModelChange)="calculerHTVVetusteAndTTCVetuste(pieces)"
                                                                                        name="vetuste[{{i}}]" min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />
                                                                                    <!--   [disabled]=" pieces.observationExpert == 1 || pieces.observationExpert == 2 || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null)"-->

                                                                                </td>


                                                                                <!--<td *ngIf="AvisExpert || showVetuste">
                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.HTVetuste"
                                                                                        name="piecThtVetuste[{{i}}]"
                                                                                        readonly style="width: 100px"
                                                                                        [disabled]=" pieces.observationExpert == 1 || pieces.observationExpert == 2 || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)" />
                                                                                </td>
                                                                                <td
                                                                                    *ngIf="AvisExpert == true || showVetuste">
                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.TTCVetuste"
                                                                                        name="TTCVetuste[{{i}}]"
                                                                                        readonly style="width: 100px"
                                                                                        [disabled]=" pieces.observationExpert == 1 || pieces.observationExpert == 2 || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)" />
                                                                                </td>-->
                                                                                <!--<td *ngIf="AvisExpert == true">
                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.insuredParticipation"
                                                                                        name="insuredParticipation"
                                                                                        style="width: 100px"
                                                                                        [disabled]=" modeConfirmation || (isMaJDevis && pieces.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?" />


                                                                                </td>

                                                                                <td *ngIf="AvisExpert">
                                                                                    <select class="btn-default btn-sm"
                                                                                        [(ngModel)]="pieces.typePA"
                                                                                        name="typePA" id="field_typePA"
                                                                                        style="width: 100px"
                                                                                        style="background-color: white"
                                                                                        [required]="pieces.insuredParticipation>0">

                                                                                        <option value="%">
                                                                                            %
                                                                                        </option>
                                                                                        <option value="TND">
                                                                                            TND
                                                                                        </option>
                                                                                    </select>
                                                                                </td>-->

                                                                                <td
                                                                                    *ngIf="reparateurEtat == true || isGestionnaire == true || isResponsable == true">
                                                                                    <input type="text"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.observation"
                                                                                        name="piecesObservation[{{i}}]"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null) "
                                                                                        required />
                                                                                </td>
                                                                                <td>

                                                                                    <select class="btn-default btn-sm"
                                                                                        [(ngModel)]="pieces.observationRepairer"
                                                                                        name="observation[{{i}}]"
                                                                                        id="field_observation"
                                                                                        style="width: 100px"
                                                                                        style="background-color: white"
                                                                                        [disabled]="AvisExpert  || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        required>
                                                                                        <option
                                                                                            value="PIECE_DISPONIBLE">
                                                                                            PIECE_DISPONIBLE
                                                                                        </option>
                                                                                        <option value="COMMANDE_FERME">
                                                                                            COMMANDE_FERME
                                                                                        </option>
                                                                                        <option
                                                                                            value="PIECE_NON_DISPONIBLE">
                                                                                            PIECE_NON_DISPONIBLE
                                                                                        </option>
                                                                                    </select>
                                                                                </td>

                                                                                <td>

                                                                                    <input type="hidden"
                                                                                        name="piecReferenceId[{{i}}]"
                                                                                        [(ngModel)]="pieces.designationId"
                                                                                        required>
                                                                                    <input list="piecesrechange"
                                                                                        name="piecReference[{{i}}]"
                                                                                        [(ngModel)]="pieces.designationReference"
                                                                                        (change)="selectPieceCode(pieces)"
                                                                                        (ngModelChange)="selectTapedPieceCode(pieces)"
                                                                                        placeholder="Choisissez une référence"
                                                                                        class="input input-sm"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null) "
                                                                                        required />


                                                                                    <datalist id="piecesrechange">
                                                                                        <select
                                                                                            [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null) ">
                                                                                            <option
                                                                                                *ngFor="let referenceOption of moPieces; trackBy: trackPieceById"
                                                                                                style="background:#FFFFFF">
                                                                                                {{referenceOption.reference}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </datalist>




                                                                                </td>
                                                                                <td>

                                                                                    <input list="piecesrechangedes"
                                                                                        name="piecDesignation[{{i}}]"
                                                                                        [(ngModel)]="pieces.designation"
                                                                                        (change)="selectPieceDesignation(pieces)"
                                                                                        (ngModelChange)="selectTapedPieceDesignation(pieces)"
                                                                                        placeholder="Choisissez une désignation"
                                                                                        class="input input-sm"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (validDevis && pieces.modifiedLine != null) || (isMaJDevis && pieces.modifiedLine != null)"
                                                                                        required />



                                                                                    <datalist id="piecesrechangedes">
                                                                                        <select
                                                                                            [disabled]="AvisExpert || modeConfirmation || (validDevis && pieces.modifiedLine != null) || (isMaJDevis && pieces.modifiedLine != null)" >
                                                                                            <option
                                                                                                *ngFor="let designationOption of moPieces; trackBy: trackPieceById">
                                                                                                {{designationOption.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </datalist>


                                                                                </td>
                                                                                <td>
                                                                                    <div  *ngIf="pieces.designationSource == 'REPARATOR'">
                                                                                        <i class="fa fa-info-circle"  style="font-size:24px"
                                                                                    title="Réparateur"></i></div> 
                                                                                    <div  *ngIf="pieces.designationSource == 'GT ESTIMATE'">
                                                                                        <i class="fa fa-info-circle"  style="font-size:24px"
                                                                                    title="GT ESTIMATE"></i></div> 

                                                                                    </td>

                                                                                    <td>
                                                                                    <button type="submit"
                                                                                        [disabled]="modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        (click)="openAddPiece(pieces, 1)"
                                                                                        class="btn btn-sm btn-primary margin-right-5">
                                                                                        <span class="fa fa-plus"></span>
                                                                                    </button>


                                                                                </td>


                                                                                <td>
                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.prixUnit"
                                                                                        (ngModelChange)="changePieceRechange(pieces)"
                                                                                        name="piecPrixUnit[{{i}}]"
                                                                                        [disabled]=" (AvisExpert && pieces.observationExpert == 1 ) || (AvisExpert && pieces.observationExpert == 2) || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />


                                                                                </td>
                                                                                <td>
                                                                                    <select class="btn-default btn-sm"
                                                                                        name="naturePiece[{{i}}]"
                                                                                        [(ngModel)]="pieces.naturePiece"
                                                                                        (ngModelChange)="changeNaturePieceRechange(pieces.naturePiece, pieces)"
                                                                                        id="field_naturePiece"
                                                                                        style="width: 100px"
                                                                                        style="background-color: white"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        required>
                                                                                        <option value="ORIGINE">
                                                                                            Origine
                                                                                        </option>
                                                                                        <option value="GENERIQUE">
                                                                                            Générique</option>
                                                                                        <option value="CASSE">Casse
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td>

                                                                                    <input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.quantite"
                                                                                        (ngModelChange)="changePieceRechange(pieces)"
                                                                                        name="piecQuantite[{{i}}]"
                                                                                        style="width: 100px"
                                                                                        [disabled]="(AvisExpert && pieces.observationExpert == 1 ) || ( AvisExpert && pieces.observationExpert == 2) || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        required />

                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [value]="pieces.totalHt"
                                                                                        name="piecTht[{{i}}]" readonly
                                                                                        style="width: 100px"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null)" />
                                                                                </td>
                                                                                <td>
                                                                                    <input type="text"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.discount"
                                                                                        (ngModelChange)="changePieceRechange(pieces)"
                                                                                        name="discountPiece[{{i}}]"
                                                                                        min="0"
                                                                                        pattern="[0-9]+([.][0-9]+)?"
                                                                                        style="width: 100px" />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.amountDiscount"
                                                                                        name="totalDiscountPiece[{{i}}]"
                                                                                        readonly
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null)">
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.amountAfterDiscount"
                                                                                        name="amountAfterDiscountPiece[{{i}}]"
                                                                                        readonly
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null)">
                                                                                </td>-->
                                                                                <td>
                                                                                    <select class="btn-default btn-sm"
                                                                                        style="background-color: white"
                                                                                        name="piecTva[{{i}}]"
                                                                                        [(ngModel)]="pieces.tva"
                                                                                        (ngModelChange)="changePieceRechange(pieces)"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)"
                                                                                        required>
                                                                                        <option [ngValue]="vat.vatRate"
                                                                                            *ngFor="let vat of listVat;">
                                                                                            {{vat.vatRate}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.amountVat"
                                                                                        name="amountTvaPiec[{{i}}]"
                                                                                        readonly
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null)">
                                                                                </td>-->

                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.totalTtc"
                                                                                        name="piecTtc[{{i}}]" readonly
                                                                                        style="width: 100px"
                                                                                        [disabled]="AvisExpert || modeConfirmation || (isMaJDevis && pieces.modifiedLine != null) || (validDevis && pieces.modifiedLine != null)" />
                                                                                </td>
                                                                                <td
                                                                                    *ngIf="!modeConfirmation && !showRemoveLine">
                                                                                    <div>
                                                                                        <a (click)="removePieceRechangeLine(pieces, i)"
                                                                                            class="btn btn-sm btn-default"><span
                                                                                                class="fa fa-remove"
                                                                                                style="color: red"></span></a>
                                                                                    </div>
                                                                                </td>



                                                                            </tr>
                                                                            <tr>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                    <div class="row justify-content-center"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row top-buffer"></div>
                                            <br />
                                            <div class="col-lg-2">

                                            </div>
                                            <div class="col-lg-8">
                                                <span class="anchor" id="formUserEdit"></span>
                                                <div class="card">
                                                    <div class="card-header align-items-center notice-info">
                                                        <strong>Total Réparation</strong>
                                                    </div>

                                                    <div class="card-body">
                                                        <div class="row">

                                                            <div class="form-group col-sm-3">
                                                                <label
                                                                    jhiTranslate="auxiliumApp.devis.droitTimbre">droitTimbre</label>

                                                                <input id="field_droitTimbre" type="number"
                                                                    class="form-control input input-sm"
                                                                    name="droitTimbre" [(ngModel)]="quotation.stampDuty"
                                                                    readonly />
                                                            </div>
                                                            <div class="form-group col-sm-3">
                                                                <label
                                                                    jhiTranslate="auxiliumApp.devis.totalTtc">totalTtc</label>
                                                                <input id="field_totalTtc" type="text"
                                                                    class="form-control input input-sm" name="totalTtc"
                                                                    [(ngModel)]="quotation.ttcAmount" readonly />
                                                            </div>
                                                        </div>


                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <form name="editFormExpertise" role="form" novalidate #editFormExpertise="ngForm" *ngIf="viewGaDigits">
                    <!-- debut Avis Expert -->
                    <!--<div class="row" *ngIf="AvisExpert && quotation.id">
                        <div class="col-lg-12">
                            <span class="anchor" id="formUserEdit"></span>
                            <div class="card">
                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#expertiseDetailsQuote">
                                    <strong>Avis Technique</strong>
                                </div>
                                <div id="expertiseDetailsQuote" class="card-body collapse">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <label class="form-control-label" for="field_dateAccidentQuote">Date
                                                d'expertise
                                            </label>
                                            <div class="input-group">
                                                <input id="field_dateExpertiseQuote"
                                                    class="form-control form-control-sm" name="dateExpertiseQuote"
                                                    [(ngModel)]="quotation.expertiseDate" readonly />
                                                <span class="input-group-btn">
                                                </span>&nbsp;&nbsp;
                                            </div>

                                        </div>

                                        <div class="col-sm-3">
                                            <label class="form-control-label" for="field_referenceQuote">Valeur à neuf
                                            </label>
                                            <input type="number" class="form-control form-control-sm"
                                                name="valeurNeufQuote" id="field_referenceQuote"
                                                [(ngModel)]="quotation.priceNewVehicle"
                                                [required]="sinisterPec.modeId == 6 || sinisterPec.modeId == 10 || (sinisterPec.partnerId == 3 && sinisterPec.modeId == 5)" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label for="field_modeQuote">Valeur vénale</label>

                                            <input type="number" class="form-control form-control-sm"
                                                name="valeurVenaleQuote" id="field_modeQuote"
                                                [(ngModel)]="quotation.marketValue"
                                                [required]="sinisterPec.modeId == 8 ||  sinisterPec.modeId == 9" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label for="field_numeroContratQuote">Kilométrage
                                            </label>
                                            <input type="number" class="form-control form-control-sm" name="klmQuote"
                                                id="field_numeroContratQuote" [(ngModel)]="quotation.kilometer" />
                                        </div>

                                        <div class="col-sm-3">
                                            <label for="fieldestimateJourQuote">Délai estimatif des réparations en jours
                                            </label>
                                            <input type="number" class="form-control form-control-sm"
                                                name="estimateJourQuote" id="field_estimateJourQuote" disabled
                                                [(ngModel)]="quotation.estimateJour" min="0" pattern="\d+" />
                                        </div>

                                        <div class="col-sm-3">
                                            <label for="field_en_heure_moQuote">En heure MO
                                            </label>
                                            <input type="number" class="form-control form-control-sm"
                                                name="EnHeureMOQuote" id="field_EnHeureMOQuote"
                                                [(ngModel)]="quotation.heureMO" />
                                        </div>

                                        <div class="col-sm-3">
                                            <label for="field_totalMoQuote">Total MO en TND
                                            </label>
                                            <input type="number" class="form-control form-control-sm"
                                                name="totalMoQuote" id="field_totalMoQuote"
                                                [(ngModel)]="quotation.totalMo" />
                                        </div>
                                        </br>
                                        </br>
                                        </br>
                                        </br>
                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                Etat véhicule :<span style="color: #FA2F03">*</span> &nbsp; &nbsp;
                                                <input type="radio" name="conditionVehicleQuote" value="Bon"
                                                    [(ngModel)]="quotation.conditionVehicle">Bon &nbsp;&nbsp;
                                                <input type="radio" name="conditionVehicleQuote" value="Moyen"
                                                    [(ngModel)]="quotation.conditionVehicle">Moyen &nbsp;&nbsp;

                                                <input type="radio" name="conditionVehicleQuote" value="Mauvais"
                                                    [(ngModel)]="quotation.conditionVehicle">Mauvais
                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">

                                            <fieldset>
                                                Véhicule réparable
                                                <span style="color: #FA2F03">*</span> &nbsp;&nbsp;
                                                <input readonly type="radio" name="isVehiculeReparableQuote"
                                                    [(ngModel)]="quotation.repairableVehicle" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="isVehiculeReparableQuote"
                                                    [(ngModel)]="quotation.repairableVehicle" [value]="false" />Non
                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                Constat préliminaire <span style="color: #FA2F03">*</span>
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="isConstatPreQuote"
                                                    [(ngModel)]="quotation.preliminaryReport" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="isConstatPreQuote"
                                                    [(ngModel)]="quotation.preliminaryReport" [value]="false" />Non

                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                Véhicule immobilisé:
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="immobilizedVehicleQuote"
                                                    [(ngModel)]="quotation.immobilizedVehicle" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="immobilizedVehicleQuote"
                                                    [(ngModel)]="quotation.immobilizedVehicle" [value]="false" />Non
                                            </fieldset>
                                        </div>


                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                La concordance des circonstances de l'accidents avec les dégâts déclarés

                                                <span style="color: #FA2F03">*</span> &nbsp;&nbsp;
                                                <input readonly id="field_modeleLibelle" type="radio"
                                                    name="concordanceReportQuote"
                                                    [(ngModel)]="quotation.concordanceReport" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly id="field_modeleLibelle" type="radio"
                                                    name="concordanceReportQuote"
                                                    [(ngModel)]="quotation.concordanceReport" [value]="false" />Non
                                            </fieldset>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>-->

                    <!-- debut Avis Expert -->
                    <div class="row" *ngIf="AvisExpert">
                        <div class="col-lg-12">
                            <span class="anchor" id="formUserEdit"></span>
                            <div class="card">
                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#expertiseDetails">
                                    <strong>Avis Technique</strong>
                                </div>
                                <div id="expertiseDetails" class="card-body collapse">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <label class="form-control-label" for="field_dateAccident">Date
                                                d'expertise
                                            </label>
                                            <div class="input-group">
                                                <input id="field_dateExpertise" class="form-control form-control-sm"
                                                    name="dateExpertise"
                                                    value="{{detailsQuote.expertiseDate | date:'dd/MM/yyyy HH:mm:ss'}}"
                                                    readonly />
                                                <span class="input-group-btn">
                                                </span>&nbsp;&nbsp;
                                            </div>

                                        </div>

                                        <div class="col-sm-3">
                                            <label class="form-control-label" for="field_reference">Valeur à neuf
                                            </label>
                                            <input type="number" class="form-control form-control-sm" name="valeurNeuf"
                                                id="field_reference" [(ngModel)]="detailsQuote.priceNewVehicle"
                                                [required]="sinisterPec.modeId == 6 || sinisterPec.modeId == 10 || (sinisterPec.partnerId == 3 && sinisterPec.modeId == 5)" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label for="field_mode">Valeur vénale</label>

                                            <input type="number" class="form-control form-control-sm"
                                                name="valeurVenale" id="field_mode"
                                                [(ngModel)]="detailsQuote.marketValue"
                                                [required]="sinisterPec.modeId == 8 ||  sinisterPec.modeId == 9" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label for="field_numeroContrat">Kilométrage
                                            </label>
                                            <input type="number" class="form-control form-control-sm" name="klm"
                                                id="field_numeroContrat" [(ngModel)]="detailsQuote.kilometer" />
                                        </div>

                                        <div class="col-sm-3">
                                            <label for="fieldestimateJour">Délai estimatif des réparations en jours
                                            </label>
                                            <input type="number" class="form-control form-control-sm"
                                                name="estimateJour" id="field_estimateJour" disabled
                                                [(ngModel)]="detailsQuote.estimateJour" min="0" pattern="\d+" />
                                        </div>

                                        <div class="col-sm-3">
                                            <label for="field_en_heure_mo">En heure MO
                                            </label>
                                            <input type="number" class="form-control form-control-sm" name="EnHeureMO"
                                                id="field_EnHeureMO" [(ngModel)]="detailsQuote.heureMO" />
                                        </div>

                                        <div class="col-sm-3">
                                            <label for="field_totalMo">Total MO en TND
                                            </label>
                                            <input type="number" class="form-control form-control-sm" name="totalMo"
                                                id="field_totalMo" [(ngModel)]="detailsQuote.totalMo" />
                                        </div>
                                        </br>
                                        </br>
                                        </br>
                                        </br>
                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                Etat véhicule :<span style="color: #FA2F03">*</span> &nbsp; &nbsp;
                                                <input type="radio" name="conditionVehicle" value="Bon"
                                                    [(ngModel)]="detailsQuote.conditionVehicle">Bon &nbsp;&nbsp;
                                                <input type="radio" name="conditionVehicle" value="Moyen"
                                                    [(ngModel)]="detailsQuote.conditionVehicle">Moyen &nbsp;&nbsp;

                                                <input type="radio" name="conditionVehicle" value="Mauvais"
                                                    [(ngModel)]="detailsQuote.conditionVehicle">Mauvais
                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">

                                            <fieldset>
                                                Véhicule réparable
                                                <span style="color: #FA2F03">*</span> &nbsp;&nbsp;
                                                <input readonly type="radio" name="isVehiculeReparable"
                                                    [(ngModel)]="detailsQuote.repairableVehicle" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="isVehiculeReparable"
                                                    [(ngModel)]="detailsQuote.repairableVehicle" [value]="false" />Non
                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                Constat préliminaire <span style="color: #FA2F03">*</span>
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="isConstatPre"
                                                    [(ngModel)]="detailsQuote.preliminaryReport" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="isConstatPre"
                                                    [(ngModel)]="detailsQuote.preliminaryReport" [value]="false" />Non

                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                Véhicule immobilisé:
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="immobilizedVehicle"
                                                    [(ngModel)]="detailsQuote.immobilizedVehicle" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly type="radio" name="immobilizedVehicle"
                                                    [(ngModel)]="detailsQuote.immobilizedVehicle" [value]="false" />Non
                                            </fieldset>
                                        </div>


                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset>
                                                La concordance des circonstances de l'accidents avec les dégâts déclarés

                                                <span style="color: #FA2F03">*</span> &nbsp;&nbsp;
                                                <input readonly id="field_modeleLibelle" type="radio"
                                                    name="concordanceReport"
                                                    [(ngModel)]="detailsQuote.concordanceReport" [value]="true" />Oui
                                                &nbsp;&nbsp;
                                                <input readonly id="field_modeleLibelle" type="radio"
                                                    name="concordanceReport"
                                                    [(ngModel)]="detailsQuote.concordanceReport" [value]="false" />Non
                                            </fieldset>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>


                    <!-- decision Expert -->
                    <div class="row" *ngIf="AvisExpert">

                        <div class="col-lg-12">
                            <div class="card">

                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#Decision">
                                    <strong> Décision </strong>
                                </div>
                                <div id="Decision" class="card-body collapse">
                                    <div class="row">
                                        <!-- debut choc leger-->
                                        <div *ngIf="expertLandExpertOpinion">
                                            <div class="form-group col-sm-10" style="float: left;">
                                                <fieldset>

                                                    <div
                                                        *ngIf="obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                        <input type="radio" name="expertDecision"
                                                            value="Accord pour réparation"
                                                            [(ngModel)]="expertDecision">Accord pour
                                                        réparation
                                                    </div>
                                                    <div
                                                        *ngIf="!obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                        <input type="radio" name="expertDecision"
                                                            value="Accord pour réparation avec modification"
                                                            [(ngModel)]="expertDecision">Accord pour réparation
                                                        avec
                                                        modification
                                                    </div>
                                                    <div *ngIf="obserExpertQuoteCanceled && !editForm.form.invalid">
                                                        <input type="radio" name="expertDecision"
                                                            value="Devis Complementaire Annulé"
                                                            [(ngModel)]="expertDecision">Devis Complementaire Annulé
                                                    </div>
                                                    <input type="radio" name="expertDecision"
                                                        value="Circonstance à vérifier, Expertise terrain"
                                                        [(ngModel)]="expertDecision">Circonstance à
                                                    vérifier,
                                                    Expertise terrain

                                                </fieldset>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset *ngIf="avisExpertExpertiseTerrain || avisExpertReconstitution ">
                                                <div *ngIf="!obserExpert && !obserExpertQuoteCanceled">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Circonstance de l’accident non conforme"
                                                        [(ngModel)]="expertDecision">Circonstance de
                                                    l’accident
                                                    non conforme
                                                </div>

                                                <div *ngIf="sinisterPec.stepId != 19">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Reconstitution"
                                                        [(ngModel)]="expertDecision">Reconstitution

                                                </div>
                                                <div *ngIf="sinisterPec.stepId != 19 && !additionalQuote">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Épave technique" [(ngModel)]="expertDecision">Épave
                                                    technique

                                                </div>
                                                <div *ngIf="sinisterPec.stepId != 19 && !additionalQuote">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Épave économique" [(ngModel)]="expertDecision">Épave
                                                    économique

                                                </div>

                                                <div
                                                    *ngIf="obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Accord pour réparation"
                                                        [(ngModel)]="expertDecision">Accord
                                                    pour réparation
                                                </div>

                                                <div
                                                    *ngIf="!obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Accord pour réparation avec modification"
                                                        [(ngModel)]="expertDecision">Accord pour réparation avec
                                                    modification
                                                </div>

                                                <div *ngIf="obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="expertDecisionExpertiseTerrain"
                                                        value="Devis Complementaire Annulé"
                                                        [(ngModel)]="expertDecision">Devis Complementaire Annulé
                                                </div>


                                            </fieldset>
                                        </div>


                                        <!-- fin choc leger-->

                                        <!-- debut  choc  non leger-->

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset *ngIf="demantageExpertOpinion">

                                                <input type="radio" name="expertDecision1"
                                                    value="Circonstance conforme OK pour démontage"
                                                    [(ngModel)]="expertDecision">Circonstance conforme OK
                                                pour démontage <br>
                                                <input type="radio" name="expertDecision1"
                                                    value="Circonstance à vérifier, Expertise terrain"
                                                    [(ngModel)]="expertDecision">Circonstance à vérifier,
                                                Expertise terrain<br>

                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset *ngIf="avisExpertdevisDemantage ">


                                                <div
                                                    *ngIf="obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="expertDecision2"
                                                        value="Accord pour réparation"
                                                        [(ngModel)]="expertDecision">Accord pour
                                                    réparation
                                                </div>
                                                <div
                                                    *ngIf="!obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="expertDecision2"
                                                        value="Accord pour réparation avec modification"
                                                        [(ngModel)]="expertDecision">Accord pour réparation avec
                                                    modification
                                                </div>
                                                <div *ngIf="obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="expertDecision2"
                                                        value="Devis Complementaire Annulé"
                                                        [(ngModel)]="expertDecision">Devis Complementaire Annulé
                                                </div>

                                                <input type="radio" name="expertDecision2" value="Expertise terrain"
                                                    [(ngModel)]="expertDecision">
                                                Expertise terrain

                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset *ngIf="avisExpertExpertiseTerrainDemantage">

                                                <div
                                                    *ngIf="obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="demantageExpertiseTerrain3"
                                                        value="Accord pour réparation"
                                                        [(ngModel)]="expertDecision">Accord
                                                    pour réparation
                                                </div>
                                                <div
                                                    *ngIf="!obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="demantageExpertiseTerrain3"
                                                        value="Accord pour réparation avec modification"
                                                        [(ngModel)]="expertDecision">Accord pour réparation avec
                                                    modification
                                                </div>
                                                <div *ngIf="obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="demantageExpertiseTerrain3"
                                                        value="Devis Complementaire Annulé"
                                                        [(ngModel)]="expertDecision">Devis Complementaire Annulé
                                                </div>
                                                <div *ngIf="!expertAdviceReconstitution">
                                                    <input type="radio" name="demantageExpertiseTerrain3"
                                                        value="Reconstitution"
                                                        [(ngModel)]="expertDecision">Reconstitution
                                                </div>
                                                <div *ngIf="!expertAdviceReconstitution && !additionalQuote">
                                                    <input type="radio" name="demantageExpertiseTerrain3"
                                                        value="Épave technique" [(ngModel)]="expertDecision">Épave
                                                    technique

                                                </div>
                                                <div *ngIf="!expertAdviceReconstitution && !additionalQuote">
                                                    <input type="radio" name="demantageExpertiseTerrain3"
                                                        value="Épave économique" [(ngModel)]="expertDecision">Épave
                                                    économique

                                                </div>
                                            </fieldset>
                                        </div>


                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset *ngIf="reconstitutionAvisExpertDemantage">
                                                <div
                                                    *ngIf="obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid ">
                                                    <input type="radio" name="demantageExpertiseTerrain4"
                                                        value="Accord pour réparation"
                                                        [(ngModel)]="expertDecision">Accord
                                                    pour réparation
                                                </div>
                                                <div
                                                    *ngIf="!obserExpert && !obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="demantageExpertReconstitution4"
                                                        value="Accord pour réparation avec modification"
                                                        [(ngModel)]="expertDecision">Accord pour réparation avec
                                                    modification
                                                </div>
                                                <div *ngIf="obserExpertQuoteCanceled && !editForm.form.invalid">
                                                    <input type="radio" name="demantageExpertReconstitution4"
                                                        value="Devis Complementaire Annulé"
                                                        [(ngModel)]="expertDecision">Devis Complementaire Annulé
                                                </div>
                                            </fieldset>
                                        </div>

                                        <div class="form-group col-sm-10" style="float: left;">
                                            <fieldset *ngIf="demantageExpertCirconstanceVerifExpertiseTerrain">
                                                <input type="radio" name="expertDecision5"
                                                    value="Circonstance conforme OK pour démontage"
                                                    [(ngModel)]="expertDecision">Circonstance conforme OK
                                                pour démontage
                                                <input type="radio" name="expertDecision5"
                                                    value="Circonstance de l’accident non conforme"
                                                    [(ngModel)]="expertDecision">Circonstance de l’accident
                                                non conforme
                                                <div *ngIf="sinisterPec.expertDecision != 'Reconstitution'">
                                                    <input type="radio" name="expertDecision" value="Reconstitution"
                                                        [(ngModel)]="expertDecision">Reconstitution<br>
                                                </div>
                                                <div
                                                    *ngIf="sinisterPec.expertDecision != 'Reconstitution' && !additionalQuote">
                                                    <input type="radio" name="expertDecision" value="Épave technique"
                                                        [(ngModel)]="expertDecision">Épave technique

                                                </div>
                                                <div
                                                    *ngIf="sinisterPec.expertDecision != 'Reconstitution' && !additionalQuote">
                                                    <input type="radio" name="expertDecision" value="Épave économique"
                                                        [(ngModel)]="expertDecision">Épave économique

                                                </div>
                                            </fieldset>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- fin decision Expert -->

                    <!-- Motifs CONFIRMATION -->
                    <div class="row"
                        *ngIf="!quotation.confirmationDecisionQuote && (RevueValidationDevis || modeConfirmation) && !confirmationDevisComplementaire">
                        <div class="col-lg-12">
                            <div class="card">

                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#Motifs">
                                    <strong> Motifs </strong>
                                </div>
                                <div id="Motifs" class="card-body collapse">
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <br>
                                            <span style="font-weight:bold;">
                                                <label>Motifs</label></span>

                                        </div>
                                        <div class="col-sm-6">
                                            <br>
                                            <select class="form-control form-control-sm" id="field_mlr" name="mlr"
                                                [(ngModel)]="sinisterPec.motifNonConfirmeId" required>
                                                <option [ngValue]="rsRf.id"
                                                    *ngFor="let rsRf of motifs; trackBy: trackReasonById">
                                                    {{rsRf.label}}
                                                </option>
                                            </select>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row" *ngIf="confirmationDevisComplementaire">
                        <div class="col-lg-12">
                            <div class="card">

                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#Motifs">
                                    <strong> Motifs </strong>
                                </div>
                                <div id="Motifs" class="card-body collapse">
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <br>
                                            <span style="font-weight:bold;">
                                                <label>Motifs</label></span>

                                        </div>
                                        <div class="col-sm-6">
                                            <br>
                                            <select class="form-control form-control-sm" id="field_mlr" name="mlr"
                                                [(ngModel)]="sinisterPec.motifNonConfirmeId" required>
                                                <option [ngValue]="rsRf.id"
                                                    *ngFor="let rsRf of motifs; trackBy: trackReasonById">
                                                    {{rsRf.label}}
                                                </option>
                                            </select>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Motifs Confirmation Devis -->

                    <!-- Motifs Annulation -->

                    <div class="row" *ngIf="isMaJDevis && sinisterPec.motifNonConfirmeId != null">
                        <div class="col-lg-12">
                            <div class="card">

                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#Motifs">
                                    <strong> Motifs </strong>
                                </div>
                                <div id="Motifs" class="card-body collapse">
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <br>
                                            <span style="font-weight:bold;">
                                                <label>Motifs</label></span>

                                        </div>
                                        <div class="col-sm-6">
                                            <br>
                                            <select class="form-control form-control-sm" id="field_mlr" name="mlr"
                                                [(ngModel)]="sinisterPec.motifNonConfirmeId" disabled>
                                                <option [ngValue]="rsRf.id"
                                                    *ngFor="let rsRf of motifs; trackBy: trackReasonById">
                                                    {{rsRf.label}}
                                                </option>
                                            </select>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>



                    <!----------------------------------------------------------------------------------Observation---------------------------------------------------------------------------->


                    <div class="row">
                        <div class="col-lg-12">

                            <div class="card">
                                <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                    data-toggle="collapse" href="#collapseOb">
                                    <strong>Observations </strong>
                                </div>
                            </div>
                            <div id="collapseOb" class="card-body collapse">
                                <div class="row">
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control form-control-sm" name="observation"
                                            id="observationId" [(ngModel)]="observation.commentaire" />
                                        <div [hidden]="!isCommentError">
                                            <small class="form-text text-danger" [hidden]="!isCommentError"
                                                jhiTranslate="entity.validation.required">This
                                                field is required.</small>
                                        </div>
                                    </div>
                                    <div class="col-sm-2">
                                        <button *ngIf="!isObsModeEdit" class="btn btn-sm btn-primary addnew"
                                            (click)="addObservation();">
                                            <span class="fa fa-plus"></span>
                                            <span jhiTranslate="auxiliumApp.observation.home.createLabel">Create new
                                                Observation
                                            </span>
                                        </button>
                                        <button *ngIf="isObsModeEdit" class="btn btn-sm btn-primary addnew"
                                            (click)="editObservation();">
                                            <span class="fa fa-pencil"></span>
                                            <span jhiTranslate="auxiliumApp.observation.home.editLabel">Edit
                                                Observation
                                            </span>
                                        </button>

                                    </div>
                                </div>
                                <div class="row" style="margin-top: 15px;">
                                    <div class="col-sm-12">
                                        <div class="table-responsive" *ngIf="observationss && observationss.length > 0">
                                            <table class="table table-sm table-hover table-bordered"
                                                style="width: 100%">
                                                <thead>
                                                    <tr jhiSort style="color: white; background-color: #167F92">
                                                        <th jhiSortBy="date"><span
                                                                jhiTranslate="auxiliumApp.observation.date">Date</span>
                                                            <span class="fa fa-sort"></span></th>
                                                        <th><span
                                                                jhiTranslate="auxiliumApp.observation.commentaire">Commentaire</span>
                                                            <span class="fa fa-sort"></span></th>
                                                        <th jhiSortBy="userLogin"><span
                                                                jhiTranslate="auxiliumApp.observation.user">Utilisateur</span>
                                                            <span class="fa fa-sort"></span></th>
                                                        <!--<th></th>-->
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <ng-container *ngFor="let observation of observationss">
                                                        <tr *ngIf="!observation.deleted">
                                                            <td>{{observation.date  | date:'dd/MM/yy'}}</td>
                                                            <td>{{observation.commentaire}}</td>
                                                            <td>{{observation.firstName}}
                                                                {{observation.lastName}}</td>
                                                            <!--<td class="text-right">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button"
                                                                        (click)="prepareEditObservation(observation)"
                                                                        class="btn btn-primary btn-sm">
                                                                        <span class="fa fa-pencil"></span>
                                                                    </button>
                                                                    <button type="button"
                                                                        (click)="deleteObservation(observation)"
                                                                        class="btn btn-danger btn-sm">
                                                                        <span class="fa fa-trash"></span>
                                                                    </button>
                                                                </div>
                                                            </td>-->
                                                        </tr>
                                                    </ng-container>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <!------------------------------------------------------- fin observation ----------------------------------------------------------->
                </form>
            </div>
        </body>
    </section>






    <div class="row">
        <div class="col-sm-6">
            <div class="alert alert-danger" *ngIf="rectfyQuotsWithssucced"
                jhiTranslate="auxiliumApp.sinisterPec.home.RectfyQuotsWithssucced">
                <strong>rectfyQuotsWithssucced</strong>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6">
            <div class="alert alert-danger" *ngIf="showAlert" jhiTranslate="auxiliumApp.sinisterPec.schowDesignation">
                <strong>designation disponible</strong>
            </div>
        </div>
    </div>

    <!-- Bouton Save et Soumettre  et Confirmation et Valider et Rectifier -->

    <div class="modal-footer">
        <div
            *ngIf="viewGaDigits && !DevisComplementary && !quoteValidation && !RevueValidationDevis &&!quoteRectify &&!modeConfirmation && !AvisExpert && !isConfirmationModificationPrix && conditionTest && conditionDemontage">
            <button type="submit"
                [disabled]="(enableSaveSoumettre == false && (sinisterPec.lightShock != null || sinisterPec.lightShock != undefined)) || oneClickForButton16 == false || (!sinisterPec.receptionVehicule && sinisterPec.lightShock == null) || (editForm.form.invalid && (sinisterPec.lightShock != null || sinisterPec.lightShock != undefined)) "
                class="btn btn-primary" (click)="save()">
                <span class="fa fa-save"></span> <span jhiTranslate="entity.action.save">Save</span>
            </button>
        </div>

        <div
            *ngIf="viewGaDigits && !quoteValidation && !quoteRectify && !isConfirmationModificationPrix && !RevueValidationDevis &&!modeConfirmation && !expertMissionary && !cancelExpertMissionary && !AvisExpert && conditionTest && conditionDemontage">
            <button type="submit"
                [disabled]="enableSaveSoumettre == false || oneClickForButton16 == false || editForm.form.invalid || isSaving || sinisterPec.lightShock == null || sinisterPec.lightShock == undefined || (sinisterPec.lightShock && quotation.ttcAmount <= 0.6) || (sinisterPec.lightShock && quotation.ttcAmount == undefined) || (!sinisterPec.lightShock && isDemontageVehicule && quotation.ttcAmount <= 0.6) || (!sinisterPec.lightShock && isDemontageVehicule && quotation.ttcAmount == undefined)"
                class="btn btn-primary" (click)="soumettre()">
                <span jhiTranslate="entity.action.soumettre">Soumettre</span>
            </button>
        </div>


        <div
            *ngIf="((viewGaDigits && modeConfirmation && !isConfirmationModificationPrix)  || RevueValidationDevis && viewGaDigits) && (buttonConfirm || buttonValid ) ">
            <label class="btn btn-sm btn-primary" for="ppsured" (click)="confirmationQuots(true);">
                <input type="radio" name="natureConfirmation" id="confirme"
                    [(ngModel)]="quotation.confirmationDecisionQuote" [value]="true" />
                  Confirmé
            </label>
        </div>

        <div
            *ngIf="((viewGaDigits && modeConfirmation && !isConfirmationModificationPrix) ||  viewGaDigits && RevueValidationDevis) && (buttonConfirm || buttonValid ) ">
            <label class="btn btn-sm btn-primary" for="ppsured" (click)="confirmationQuots(false);">
                <input type="radio" name="natureConfirmation" id="nonconfirme"
                    [(ngModel)]="sinisterPec.confirmationDecisionQuote" [value]="false" />
                Non Confirmé
            </label>
        </div>
        <div
            *ngIf="((viewGaDigits && modeConfirmation)  || (viewGaDigits && RevueValidationDevis)) && (buttonConfirm || buttonValid )">
            <button type="submit"
                [disabled]="editForm.form.invalid || (quotation.confirmationDecisionQuote == false  && sinisterPec.motifNonConfirmeId == undefined)"
                class="btn btn-primary" (click)="confirmationDevis()">
                <span class="fa fa-save"></span> <span jhiTranslate="entity.action.save">Save</span>
            </button>
        </div>

        <div *ngIf="quoteValidation && viewGaDigits && buttonVerif">
            <button type="submit" (click)="validationQuote()">
                <span class="fa fa-save"></span> <span jhiTranslate="entity.action.valider">Valider</span>
            </button>
        </div>

        <div *ngIf="viewGaDigits &&  quoteRectify && buttonVerif ">
            <button type="submit" (click)="rectifyquote()">
                <span jhiTranslate="entity.action.rectifier">Rectifier</span>
            </button>
        </div>
        <!-- Avis Expert-->
        <div *ngIf="viewGaDigits && AvisExpert && !isConfirmationModificationPrix && buttonExpert ">
            <button type="submit"
                [disabled]="(sinisterPec.stepId == 18 && enableSaveExpertise == false) || !AvisExpert  || expertDecision == undefined || ((editForm.form.invalid || (detailsQuote.marketValue == undefined && (sinisterPec.modeId == 8 ||  sinisterPec.modeId == 9)) || (detailsQuote.priceNewVehicle == undefined && (sinisterPec.modeId == 6 || sinisterPec.modeId == 10 || (sinisterPec.partnerId == 3 && sinisterPec.modeId == 5))) || detailsQuote.conditionVehicle == undefined  || detailsQuote.repairableVehicle == undefined || detailsQuote.preliminaryReport == undefined || detailsQuote.concordanceReport == undefined) && (expertDecision == 'Accord pour réparation' || expertDecision == 'Accord pour réparation avec modification'))"
                class="btn btn-primary" (click)="saveAvisExpert()">
                <span class="fa fa-save"></span> <span jhiTranslate="entity.action.save">Save</span>
            </button>
        </div>


        <div *ngIf="viewGaDigits && isConfirmationModificationPrix && buttonConfirmModifPrix">
            <button type="submit" [disabled]="editForm.form.invalid || isSaving" class="btn btn-primary"
                (click)="confirmer()">
                <span jhiTranslate="entity.action.Confirmer">Confirmer</span>
            </button>
        </div>
        <div *ngIf="viewGaDigits && isConfirmationModificationPrix  && buttonConfirmModifPrix">
            <button type="submit" [disabled]="editForm.form.invalid || isSaving" class="btn btn-primary"
                (click)="nonConfirmer()">
                 <span jhiTranslate="entity.action.nonConfirmer">Ne pas Confirmer</span>
            </button>
        </div>

    </div>


</form>
</section>
<form name="editForm" role="form" novalidate #editForm="ngForm">
    <!-- Breadcrumb-->
    <div class="breadcrumb-holder">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-10">
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a routerLink="/"><span class="fa fa-home"></span>&nbsp;&nbsp;<span
                                    jhiTranslate="global.menu.home">Home</span></a></li>
                        <li class="breadcrumb-item" active><span
                                jhiTranslate="auxiliumApp.devis.home.createOrEditLabel">Create
                                or edit a Devis</span></li>
                    </ul>
                </div>

            </div>
        </div>
    </div>
    <div class="col-lg-11">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img
            class="imageGauche hipster img-fluid img-rounded" src="../../../content/images/search.png"
            style="width:50px;" (click)="historyApec()">
        </br>
        &nbsp;&nbsp;&nbsp;&nbsp; <span class="imageGauche" style="margin-bottom: 5px">Historique &nbsp; </span>
        <style type="text/css">
            .imageGauche {
                float: right;
            }
        </style>
    </div>
    <section class="forms">
        <div class="container-fluid">
            <!-- Page Header-->
            <header>
                <h1 class="h3 display">
                    <jhi-alert-error></jhi-alert-error>
                </h1>
            </header>

            <body>
                <form name="editForm" role="form" novalidate #editForm="ngForm">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="row">
                                <!-- ---------------------------------------------------------détails assuré-------------------------------------------------------------------------------------------------------->

                                <div class="col-sm-6">
                                    <div class="card">

                                        <span class="anchor" id="formUserEdit"></span>
                                        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                            data-toggle="collapse" href="#AssurDetails">
                                            <strong jhiTranslate="auxiliumApp.contratAssurance.assure">Détails
                                                assure</strong>
                                        </div>
                                        <br />
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="form-group col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.assure.assure"
                                                        for="field_assurePrenom">Assure</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="assurePrenom" id="field_assurePrenom"
                                                        [(ngModel)]="insured.fullName" readonly />
                                                </div>
                                                <div class="form-group col-sm-3">
                                                    <label
                                                        jhiTranslate="auxiliumApp.vehiculeAssure.immatriculationVehicule"
                                                        for="field_immatriculationVehicule"> Immatriculation

                                                    </label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="immatriculationVehicule"
                                                        id="field_immatriculationVehicule"
                                                        [(ngModel)]="vehicule.immatriculationVehicule" readonly />
                                                </div>
                                                <div class="col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.usage"
                                                        for="field_usage"> Usage
                                                    </label>
                                                    <select class="form-control form-control-sm" id="field_usage"
                                                        name="usage" [(ngModel)]="vehicule.usageId" disabled>
                                                        <option [ngValue]="refUsageContratOption.id"
                                                            *ngFor="let refUsageContratOption of refusagecontrats;">
                                                            {{refUsageContratOption.label}}</option>
                                                    </select>
                                                </div>
                                                <div class="form-group col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.vehiculeAssure.numeroChassis"
                                                        for="field_numeroChassis">Numero
                                                        Chassis
                                                    </label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="numeroChassis" id="field_numeroChassis"
                                                        [(ngModel)]="vehicule.numeroChassis" readonly />
                                                </div>

                                            </div>

                                        </div>

                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="form-group col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.energie"
                                                        for="field_energie">Energie</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="energie" id="field_energie"
                                                        [(ngModel)]="vehicule.puissance" readonly />
                                                </div>
                                                <div class="form-group col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.marque"
                                                        for="field_marqueLibelle">Marque</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="marqueLibelle" id="field_marqueLibelle"
                                                        [(ngModel)]="vehicule.marqueLibelle" readonly />
                                                </div>
                                                <div class="form-group col-sm-3">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.modele"
                                                        for="field_modeleLibelle">Modele</label>
                                                    <input id="field_modeleLibelle" type="text"
                                                        class="form-control form-control-sm" name="modeleLibelle"
                                                        [(ngModel)]="vehicule.modeleLibelle" readonly />
                                                </div>
                                                <div class="col-sm-3">
                                                    <div *ngIf="AvisExpert">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.reparateur.raisonSociale"
                                                            for="field_raisonSociale">Raison Sociale</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            name="raisonSociale" id="field_raisonSocial"
                                                            [(ngModel)]="reparateur.raisonSociale" readonly disabled />

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-12">
                                            <div class="row">

                                                <div class="col-sm-3">
                                                    <div *ngIf="AvisExpert &&  contratAssurance.marketValue ">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.contratAssurance.valeurAssure"
                                                            for="field_raisonSociale">Raison Sociale</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            name="raisonSociale" id="field_raisonSocial"
                                                            [(ngModel)]=" contratAssurance.marketValue" readonly
                                                            disabled />

                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div *ngIf="AvisExpert && contratAssurance.newValueVehicle">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.contratAssurance.valeurAssure"
                                                            for="field_raisonSociale">Raison Sociale</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            name="raisonSociale" id="field_raisonSocial"
                                                            [(ngModel)]="contratAssurance.newValueVehicle" readonly
                                                            disabled />

                                                    </div>
                                                </div>


                                            </div>
                                        </div>
                                    </div>
                                </div>



                                <!---------------------------------------------------------------------------Réception véhicule---------------------------------------------------------------------------------------------------->
                                <div class="col-sm-6">
                                    <div *ngIf="expert != true">
                                        <div class="card">
                                            <span class="anchor" id="formUserEdit"></span>
                                            <div
                                                class=" collapsible-card card-header align-items-center collapsed notice notice-info">
                                                <strong> Réception Véhicule</strong>
                                            </div>
                                            <br />
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.sinisterPec.receptionVehicule"
                                                            for="field_receptionVehicule">Réception Véhicule</label>
                                                        <input type="checkbox" class="check-input"
                                                            name="receptionVehicule" id="field_receptionVehicule"
                                                            [(ngModel)]="sinisterPec.receptionVehicule" disabled />
                                                    </div>
                                                    <div class="col-sm-6" *ngIf="sinisterPec.receptionVehicule">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.sinisterPec.dateReceptionVehicule"
                                                            for="field_dateReceptionVehicule">dateReceptionVehicule</label>
                                                        <div class="input-group">
                                                            <input id="field_myDateReceptionVehicule"
                                                                class="form-control form-control-sm"
                                                                name="myDateReceptionVehicule" [(ngModel)]="myDate"
                                                                required disabled />
                                                            <span class="input-group-btn">
                                                            </span>&nbsp;&nbsp;
                                                        </div>
                                                    </div>

                                                    <!--<div class="col-sm-6" *ngIf="!sinisterPec.receptionVehicule">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.sinisterPec.dateReceptionVehicule"
                                                            for="field_dateReceptionVehicule">dateReceptionVehicule</label>
                                                        <div class="input-group">
                                                            <input id="field_dateReceptionVehicule" type="text"
                                                                class="form-control form-control-sm"
                                                                name="dateReceptionVehicule" ngbDatepicker
                                                                #dateReceptionVehiculeDp="ngbDatepicker"
                                                                [(ngModel)]="sinisterPec.vehicleReceiptDate" disabled
                                                                 />
                                                            <span class="input-group-btn">
                                                                <button type="button" class="btn btn-sm btn-default"
                                                                    (click)="dateReceptionVehiculeDp.toggle()"><i
                                                                        class="fa fa-calendar"></i></button>
                                                            </span>
                                                        </div>
                                                    </div>-->

                                                </div>
                                            </div>
                                            <br />
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.sinisterPec.etatDuChoc"
                                                            for="field_etatduchoc">etat
                                                            du choc</label>
                                                        <div class="input-group" data-toggle="buttons">
                                                            <label class="btn btn-sm btn-primary" for="ppInsured">
                                                                <input type="radio"
                                                                    [disabled]="receiveVehicule == false"
                                                                    name="natureReparation" id="leger"
                                                                    autocomplete="off" [value]="true"
                                                                    [(ngModel)]="sinisterPec.lightShock" disabled> Choc
                                                                Léger
                                                            </label> &nbsp;
                                                            <label class="btn btn-sm btn-primary" for="pmInsured">
                                                                <input type="radio" name="natureReparation"
                                                                    id="nonLeger" autocomplete="off" [value]="false"
                                                                    [(ngModel)]="sinisterPec.lightShock" disabled> Choc
                                                                non léger
                                                            </label>
                                                        </div>
                                                    </div>

                                                    <div class="col-sm-6">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.sinisterPec.demandeDeDemantage"
                                                            for="field_demandededemantage">demande
                                                            de demontage</label>
                                                        <div class="input-group" data-toggle="buttons">
                                                            <label class="btn btn-sm btn-primary" for="ppInsured">
                                                                <input type="radio" name="demontage" id="demontage"
                                                                    autocomplete="off" [value]="true"
                                                                    [(ngModel)]="sinisterPec.disassemblyRequest"
                                                                    disabled> Oui
                                                            </label> &nbsp;
                                                            <label class="btn btn-sm btn-primary" for="pmInsured">
                                                                <input type="radio" name="demontage" id="nonDemontage"
                                                                    autocomplete="off" [value]="false"
                                                                    [(ngModel)]="sinisterPec.disassemblyRequest"
                                                                    disabled>
                                                                Non
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-------------------------------------------------------------------------Photos aprés réparation------------------------------------------------------------------------------------->

                    <div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="card">
                                    <span class="anchor" id="formUserEdit"></span>
                                    <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                        data-toggle="collapse" href="#collapsePhotos">
                                        <strong>Photos aprés réparation</strong>
                                    </div>
                                    <br />
                                    <div id="collapsePhotos" class="card-body collapse" [ngbCollapse]="isCollapsed">
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_facture"
                                                                    jhiTranslate="auxiliumApp.reparateur.facture"
                                                                    for="field_facture">facture
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showFactureAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_facture" required type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="facture"
                                                                        [(ngModel)]="factureAttachment.label"
                                                                        (change)="onFactureFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="facturePreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadFactureFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="facturePreview">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deleteFactureFile()"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>


                                                        </div>
                                                    </div>
                                                    <br />

                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-sm-3">
                                                                <label class="field_PhotoReparation"
                                                                    jhiTranslate="auxiliumApp.reparateur.photoReparation"
                                                                    for="field_PhotoReparation">photoReparation
                                                                </label>
                                                            </div>
                                                            <div class="col-lg-4" *ngIf="showPhotoReparationAttachment">
                                                                <div class="form-group">
                                                                    <input id="field_PhotoReparation" type="file"
                                                                        class="form-control form-control-sm"
                                                                        name="photoReparation"
                                                                        [(ngModel)]="photoReparationAttachment.label"
                                                                        (change)="onPhotoReparationFileChange($event)"
                                                                        accept=".jpg,.jpeg,.png" required />
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-5">
                                                                <div class="form-group">
                                                                    <span class="input-group-btn"
                                                                        *ngIf="photoReparationPreview">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadPhotoReparationFile()"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </span>
                                                                    <span class="input-group-btn"
                                                                        *ngIf="photoReparationPreview">
                                                                        <button type="button"
                                                                            class="btn btn-danger btn-sm"
                                                                            (click)="deletePhotoReparationFile()"><i
                                                                                class="fa fa-sm fa-remove"></i></label>
                                                                    </span>
                                                                </div>
                                                            </div>


                                                        </div>
                                                    </div>
                                                    <br />


                                                    <br />

                                                    <br />

                                                    <br />


                                                </div>

                                            </div>
                                        </div>
                                        <br />
                                        <div class="col-sm-2" *ngIf="(6 > piecesJointes.length)  ">
                                            <button type="button" class="btn btn-primary btn-sm pull-right"
                                                (click)="ajoutNouvelpieceJointe();" style="margin-top:15px">
                                                <span class="fa fa-edit"></span> <span>Ajouter Nouvelle Piéce Jointe
                                                </span>
                                            </button>
                                        </div>
                                        <br /><br />

                                        <div>
                                            <div class="col-sm-12" *ngIf="ajoutNouvelpieceform">
                                                <div class="row">
                                                    <div class="col-sm-3">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.pieceJointe.libelle"
                                                            for="field_libelle">Libelle</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            name="libelle" id="libelle"
                                                            [(ngModel)]="pieceAttachment1.label" />
                                                        <div [hidden]="!isError">
                                                            <small class="form-text text-danger"
                                                                [hidden]="!islibelleError"
                                                                jhiTranslate="entity.validation.required">This
                                                                field is required.</small>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.pieceJointe.file"
                                                            for="field_chemin">Fichier</label>
                                                        <input id="field_chemin" type="file"
                                                            class="form-control form-control-sm" name="field_chemin"
                                                            (change)="onPieceFileChange1($event)"
                                                            accept=".jpg,.jpeg,.png" [(ngModel)]="pieceAttachment1.type"
                                                            required />



                                                        <span class="input-group-btn" *ngIf="piecePreview1">
                                                            <button type="button" class="btn btn-sm btn-default"
                                                                (click)="downloadPieceFile1()"><i
                                                                    class="fa fa-sm fa-download"></i></button>
                                                        </span>



                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label style="width: 100%">&nbsp;</label>
                                                        <!-- <button *ngIf="!isPcsModeEdit"-->
                                                        <button
                                                            [disabled]="pieceAttachment1.label  == null ||  pieceAttachment1.type == undefined"
                                                            class="btn btn-sm btn-primary addnew"
                                                            (click)="ajoutPiece1();">
                                                            <span class="fa fa-plus"></span>
                                                            <span
                                                                jhiTranslate="auxiliumApp.observation.home.createLabel">Create
                                                                new Description
                                                            </span>
                                                        </button>
                                                        <!-- <button *ngIf="isPcsModeEdit"
                                                        [disabled]="pieceJ.typeLibelle  == null || pieceJ.libelle == undefined "
                                                        class="btn btn-sm btn-primary addnew" (click)="editPieceJ();">
                                                        <span class="fa fa-pencil"></span>
                                                        <span jhiTranslate="auxiliumApp.observation.home.editLabel">Edit
                                                        </span>
                                                    </button> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <br /><br />
                                            <div class="col-sm-12">
                                                <div class="table-responsive"
                                                    *ngIf="piecesAttachments && piecesAttachments.length > 0">
                                                    <table class="table table-sm table-hover table-bordered"
                                                        style="width: 100%">
                                                        <thead>
                                                            <tr jhiSort style="color: white; background-color: #167F92">
                                                                <th jhiSortBy="date"><span
                                                                        jhiTranslate="auxiliumApp.pieceJointe.libelle">Libelle</span>
                                                                    <span class="fa fa-sort"></span></th>
                                                                <th jhiSortBy="date"><span
                                                                        jhiTranslate="auxiliumApp.pieceJointe.dateCreation">Date
                                                                        Creation</span>
                                                                    <span class="fa fa-sort"></span></th>

                                                                <th><span
                                                                        jhiTranslate="auxiliumApp.pieceJointe.file">Fichier</span>
                                                                    <span class="fa fa-sort"></span></th>
                                                                <th><span></span>
                                                                    <span class="fa fa-sort"></span></th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr *ngFor="let piecesjointe of piecesAttachments">
                                                                <td>{{piecesjointe.label}}</td>
                                                                <td>{{piecesjointe.creationDate | date:'dd/MM/yyyy HH:mm:ss'}}
                                                                </td>

                                                                <td class="text-right">
                                                                    <div class="btn-group flex-btn-group-container">
                                                                        <button type="button"
                                                                            class="btn btn-sm btn-default"
                                                                            (click)="downloadPieceFile(piecesjointe.pieceFile)"><i
                                                                                class="fa fa-sm fa-download"></i></button>
                                                                    </div>
                                                                </td>
                                                                <td class="text-right">
                                                                    <div class="btn-group flex-btn-group-container">
                                                                        <!--<button type="button"
                                                                            (click)="prepareEditPieceJ(piecesjointe)"
                                                                            class="btn btn-primary btn-sm">
                                                                            <span class="fa fa-pencil"></span>
                                                                        </button>-->
                                                                        <button type="button"
                                                                            (click)="deletePieceJ(piecesjointe)"
                                                                            class="btn btn-danger btn-sm">
                                                                            <span class="fa fa-sm fa-remove"></span>
                                                                        </button>
                                                                    </div>
                                                                </td>

                                                                </ng-container>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!----------------------------------------------------------------devis------------------------------------------------------------->


                        <div class="row">
                            <div class="col-lg-12">

                                <div class="card">
                                    <span class="anchor" id="formUserEdit"></span>

                                    <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                        data-toggle="collapse" href="#collapsedevis">
                                        <strong>Devis</strong>
                                    </div>
                                    <div id="collapsedevis" class="card-body collapse" [ngbCollapse]="isCollapsed">
                                        <div class="card-body">
                                            <div class="row">
                                                <!-- MO details list -->
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class=" collapsible-card card-header align-items-center collapsed"
                                                            data-toggle="collapse" href="#collapseDetailsMo">
                                                            <h4 jhiTranslate="auxiliumApp.detailsMo.home.title">Details
                                                                mo
                                                            </h4>
                                                        </div>
                                                        <div id="collapseDetailsMo" class="card-body collapse">
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <label *ngIf="!moPieces || moPieces.length == 0"
                                                                        style="color: red">Vous
                                                                        devez paramètrer des types de pièce !</label>

                                                                </div>
                                                                <div class="col-sm-12">
                                                                    <div class="table-responsive"
                                                                        *ngIf="detailsPiecesMO && detailsPiecesMO.length > 0">
                                                                        <table class="table table-striped">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span>Observation Expert</span>
                                                                                    </th>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span> Nombre MO estimé
                                                                                        </span>
                                                                                    </th>

                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.designation">Designation</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.typeIntervention">Type
                                                                                            Intervention
                                                                                        </span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.th">th</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.nombreHeures">Nombre
                                                                                            Heures
                                                                                        </span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                    </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr
                                                                                    *ngFor="let detailsPieceMo of detailsPiecesMO; let i=index">
                                                                                    <td *ngIf="AvisExpert == true">

                                                                                        <select
                                                                                            class="form-control form-control-sm"
                                                                                            name="moObservation[{{i}}]"
                                                                                            [(ngModel)]="detailsPieceMo.observationExpert"
                                                                                            disabled readonly required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>

                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <input type="text"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="detailsPieceMo.nombreMOEstime"
                                                                                            disabled readonly
                                                                                            name="nombreMOEstime[{{i}}]"
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                            required />
                                                                                    </td>



                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="reparateurEtat == true || isGestionnaireTechnique == true">
                                                                                        <input type="text"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="detailsPieceMo.observation"
                                                                                            disabled readonly
                                                                                            name="moObservation[{{i}}]"
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation" />
                                                                                    </td>

                                                                                    <td>
                                                                                        <input
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="moDesignation[{{i}}]"
                                                                                            [(ngModel)]="detailsPieceMo.designation"
                                                                                            disabled>

                                                                                    </td>
                                                                                    <td>
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            [(ngModel)]="detailsPieceMo.typeInterventionId"
                                                                                            disabled readonly
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                            name="interventionMo[{{i}}]">
                                                                                            <option
                                                                                                [ngValue]="reftypeinterventionOption.id"
                                                                                                *ngFor="let reftypeinterventionOption of refOperationTypesMo">
                                                                                                {{reftypeinterventionOption.libelle}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <td><input type="number"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="detailsPieceMo.prixUnit"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                            name="pu[{{i}}]"
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1" />
                                                                                    </td>
                                                                                    <td><input type="text"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="detailsPieceMo.nombreHeures"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                            name="nombreHeures[{{i}}]"
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation" />
                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.totalHt"
                                                                                        disabled readonly
                                                                                        name="moTht[{{i}}]" readonly />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.discount"
                                                                                        disabled readonly
                                                                                        (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                        name="discount[{{i}}]"
                                                                                        [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation" />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.amountDiscount"
                                                                                        disabled readonly
                                                                                        name="totalDiscount[{{i}}]"
                                                                                        [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                        readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.amountAfterDiscount"
                                                                                        disabled readonly
                                                                                        name="amountAfterDiscountMo[{{i}}]"
                                                                                        [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                        readonly>
                                                                                </td>-->
                                                                                    <td>
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="vatMo[{{i}}]"
                                                                                            [(ngModel)]="detailsPieceMo.tva"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeMo(detailsPieceMo)"
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation">
                                                                                            <option
                                                                                                [ngValue]="vat.vatRate"
                                                                                                *ngFor="let vat of listVat;">
                                                                                                {{vat.vatRate}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="detailsPieceMo.amountVat"
                                                                                        disabled readonly
                                                                                        name="amountTvaMo[{{i}}]"
                                                                                        [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                        readonly />
                                                                                </td>-->
                                                                                    <td><input type="number"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="detailsPieceMo.totalTtc"
                                                                                            disabled readonly
                                                                                            name="moTtc[{{i}}]"
                                                                                            [disabled]="detailsPieceMo.observationExpert == 1 || modeConfirmation"
                                                                                            readonly />
                                                                                    </td>
                                                                                    <td>
                                                                                        <div></div>


                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="detailsPieceMo.observationExpert !== 1 && modeConfirmation">

                                                                                        <div
                                                                                            class="btn-group flex-btn-group-container">
                                                                                            <a
                                                                                                class="btn btn-sm btn-default"><span
                                                                                                    class="fa fa-check-square"
                                                                                                    style="color:chartreuse "></span></a>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td *ngIf="detailsPieceMo.modified">
                                                                                        <div
                                                                                            class="btn-group flex-btn-group-container">
                                                                                            <a
                                                                                                class="btn btn-sm btn-default"><span
                                                                                                    class="fa fa-history"
                                                                                                    style="color:currentColor "></span></a>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <!-- <td>{{ getSum4() }}</td>-->
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <!--<td>{{ getSum7() }}</td>-->
                                                                                    <td></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        <div class="row justify-content-center"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- home peinture list -->
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class=" collapsible-card card-header align-items-center collapsed"
                                                            data-toggle="collapse" href="#collapseHomePaint">
                                                            <h4 jhiTranslate="auxiliumApp.detailsPieces.homePeinture">
                                                                Home
                                                                Peinture
                                                            </h4>
                                                        </div>
                                                        <div id="collapseHomePaint" class="card-body collapse">
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <label
                                                                        *ngIf="!ingredientPieces || ingredientPieces.length == 0"
                                                                        style="color: red">Vous
                                                                        devez paramètrer des types de pièce !</label>

                                                                </div>
                                                                <div class="col-sm-12">
                                                                    <div class="table-responsive"
                                                                        *ngIf="detailsPiecesIngredient && detailsPiecesIngredient.length > 0">
                                                                        <table class="table table-striped">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th *ngIf="AvisExpert ">
                                                                                        <span>Observation Expert</span>
                                                                                    </th>

                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.designation">Designation</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.typeIntervention">Type
                                                                                            Intervention
                                                                                        </span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.th">th</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.nombreHeures">Nombre
                                                                                            Heures
                                                                                        </span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                    </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr
                                                                                    *ngFor="let dpIngredient of detailsPiecesIngredient ; let i=index">
                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <select
                                                                                            class="form-control form-control-sm"
                                                                                            name="dpObservation[{{i}}]"
                                                                                            [(ngModel)]="dpIngredient.observationExpert"
                                                                                            disabled readonly required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>



                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="reparateurEtat == true || isGestionnaire == true || isResponsable == true">
                                                                                        <input type="text"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="dpIngredient.observation"
                                                                                            disabled readonly
                                                                                            name="dpIngredientObservation[{{i}}]"
                                                                                            readonly />
                                                                                    </td>
                                                                                    <td>
                                                                                        <input
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="ingrDesignation[{{i}}]"
                                                                                            [(ngModel)]="dpIngredient.designation"
                                                                                            disabled
                                                                                            style="width: 100px">


                                                                                    </td>
                                                                                    <td>

                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            [(ngModel)]="dpIngredient.typeInterventionId"
                                                                                            disabled readonly
                                                                                            [disabled]="dpIngredient.observationExpert == 1 || modeConfirmation"
                                                                                            name="interventionIng[{{i}}]">
                                                                                            <option
                                                                                                [ngValue]="reftypeinterventionOption.id"
                                                                                                *ngFor="let reftypeinterventionOption of refOperationTypesPeinture">
                                                                                                {{reftypeinterventionOption.libelle}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <td>

                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="dpIngredient.prixUnit"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                            name="pu[{{i}}]"
                                                                                            [disabled]="dpIngredient.observationExpert == 1 " />
                                                                                    </td>
                                                                                    <td>

                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="dpIngredient.quantite"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                            name="quantite[{{i}}]"
                                                                                            style="width: 100px"
                                                                                            [disabled]="dpIngredient.observationExpert == 1" />
                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [value]="dpIngredient.totalHt"
                                                                                        name="ingrTht[{{i}}]" readonly
                                                                                        style="width: 100px"
                                                                                        [disabled]="dpIngredient.observationExpert == 1 " />
                                                                                </td>
                                                                                <td><input type="text"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="dpIngredient.discount"
                                                                                        disabled readonly
                                                                                        [disabled]="modeConfirmation"
                                                                                        (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                        name="discountIng[{{i}}]"
                                                                                        style="width: 100px"
                                                                                        [disabled]="dpIngredient.observationExpert == 1" />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.amountDiscount"
                                                                                        disabled readonly
                                                                                        name="totalDiscountIng[{{i}}]"
                                                                                        readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.amountAfterDiscount"
                                                                                        disabled readonly
                                                                                        name="amountAfterDiscountIng[{{i}}]"
                                                                                        readonly>
                                                                                </td>-->
                                                                                    <td>

                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="vatIng[{{i}}]"
                                                                                            [(ngModel)]="dpIngredient.tva"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeIngredient(dpIngredient)"
                                                                                            [disabled]="dpIngredient.observationExpert == 1 || modeConfirmation">
                                                                                            <option
                                                                                                [ngValue]="vat.vatRate"
                                                                                                *ngFor="let vat of listVat;">
                                                                                                {{vat.vatRate}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="dpIngredient.amountVat"
                                                                                        disabled readonly
                                                                                        name="amountTvaIng[{{i}}]"
                                                                                        [disabled]="modeConfirmation"
                                                                                        readonly>
                                                                                </td>-->
                                                                                    <td><input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="dpIngredient.totalTtc"
                                                                                            disabled readonly
                                                                                            [disabled]="modeConfirmation"
                                                                                            name="ingrTtc[{{i}}]"
                                                                                            readonly
                                                                                            style="width: 100px" />
                                                                                    </td>
                                                                                    <td>
                                                                                        <div>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="dpIngredient.observationExpert !== 1 && modeConfirmation">

                                                                                        <div
                                                                                            class="btn-group flex-btn-group-container">
                                                                                            <a
                                                                                                class="btn btn-sm btn-default"><span
                                                                                                    class="fa fa-check-square"
                                                                                                    style="color:chartreuse "></span></a>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td *ngIf="detailsPieceMo.modified">
                                                                                        <div
                                                                                            class="btn-group flex-btn-group-container">
                                                                                            <a
                                                                                                class="btn btn-sm btn-default"><span
                                                                                                    class="fa fa-history"
                                                                                                    style="color:currentColor "></span></a>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        <div class="row justify-content-center"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            </br>
                                                            <!-- Fourniture-->
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <label
                                                                        *ngIf="!fourniturePieces || fourniturePieces.length == 0"
                                                                        style="color: red">Vous
                                                                        devez paramètrer des types de pièce !</label>

                                                                </div>
                                                                <div class="col-sm-12">
                                                                    <div class="table-responsive"
                                                                        *ngIf="detailsPiecesFourniture && detailsPiecesFourniture.length > 0">
                                                                        <table class="table table-striped">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span>Observation Expert</span>
                                                                                    </th>
                                                                                    <th
                                                                                        *ngIf="reparateurEtat == true || isGestionnaire == true || isResponsable == true">
                                                                                        <span>Observation</span></th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.designation">Designation</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.typeIntervention">Type
                                                                                            Intervention
                                                                                        </span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.th">th</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.nombreHeures">Nombre
                                                                                            Heures
                                                                                        </span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                    </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr
                                                                                    *ngFor="let fourniture of detailsPiecesFourniture ; let i=index">
                                                                                    <td *ngIf="AvisExpert == true">

                                                                                        <select
                                                                                            class="form-control form-control-sm"
                                                                                            name="fournObservation[{{i}}]"
                                                                                            [(ngModel)]="fourniture.observationExpert"
                                                                                            disabled readonly required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>



                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="reparateur == true || isGestionnaireTechnique == true">
                                                                                        <input type="text"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="fourniture.observation"
                                                                                            disabled readonly
                                                                                            [disabled]="fourniture.observationExpert == 1 || modeConfirmation"
                                                                                            name="fournObservation[{{i}}]"
                                                                                            readonly />
                                                                                    </td>
                                                                                    <td>
                                                                                        <input
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="fournDesignation[{{i}}]"
                                                                                            [(ngModel)]="fourniture.designation"
                                                                                            disabled
                                                                                            style="width: 100px">


                                                                                    </td>
                                                                                    <td>

                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            [(ngModel)]="fourniture.typeInterventionId"
                                                                                            disabled readonly
                                                                                            [disabled]="modeConfirmation"
                                                                                            [disabled]="fourniture.observationExpert == 1 || modeConfirmation"
                                                                                            name="interventionFourn[{{i}}]">
                                                                                            <option
                                                                                                [ngValue]="reftypeinterventionOption.id"
                                                                                                *ngFor="let reftypeinterventionOption of refOperationTypesFourniture">
                                                                                                {{reftypeinterventionOption.libelle}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <td>

                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="fourniture.prixUnit"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeFourniture(fourniture)"
                                                                                            name="puFour[{{i}}]"
                                                                                            [disabled]="fourniture.observationExpert == 1" />

                                                                                    </td>
                                                                                    <td>

                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="fourniture.quantite"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeFourniture(fourniture)"
                                                                                            name="quantiteFourn[{{i}}]"
                                                                                            style="width: 100px"
                                                                                            [disabled]="fourniture.observationExpert == 1" />
                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [value]="fourniture.totalHt"
                                                                                        name="fournTht[{{i}}]" readonly
                                                                                        style="width: 100px" />
                                                                                </td>

                                                                                <td>
                                                                                    <input type="text"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="fourniture.discount"
                                                                                        disabled readonly
                                                                                        [disabled]="modeConfirmation"
                                                                                        (ngModelChange)="changeFourniture(fourniture)"
                                                                                        name="discountFourn[{{i}}]"
                                                                                        style="width: 100px"
                                                                                        [disabled]="fourniture.observationExpert == 1" />
                                                                                </td>

                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.amountDiscount"
                                                                                        disabled readonly
                                                                                        name="totalDiscountFourn[{{i}}]"
                                                                                        readonly>
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.amountAfterDiscount"
                                                                                        disabled readonly
                                                                                        name="amountAfterDiscountFourn[{{i}}]"
                                                                                        readonly>
                                                                                </td>-->
                                                                                    <td>

                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="vatFourn[{{i}}]"
                                                                                            [(ngModel)]="fourniture.tva"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changeFourniture(fourniture)"
                                                                                            [disabled]="fourniture.observationExpert == 1">
                                                                                            <option
                                                                                                [ngValue]="vat.vatRate"
                                                                                                *ngFor="let vat of listVat;">
                                                                                                {{vat.vatRate}}
                                                                                            </option>
                                                                                        </select>

                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="fourniture.amountVat"
                                                                                        disabled readonly
                                                                                        name="amountTvaFourn[{{i}}]"
                                                                                        [disabled]="modeConfirmation"
                                                                                        readonly>
                                                                                </td>-->
                                                                                    <td><input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="fourniture.totalTtc"
                                                                                            disabled readonly
                                                                                            name="fournTtc[{{i}}]"
                                                                                            readonly
                                                                                            style="width: 100px"
                                                                                            [disabled]="fourniture.observationExpert == 1" />
                                                                                    </td>
                                                                                    <td>
                                                                                        <div>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="fourniture.observationExpert !== 1 && modeConfirmation">
                                                                                        <div
                                                                                            class="btn-group flex-btn-group-container">
                                                                                            <a
                                                                                                class="btn btn-sm btn-default"><span
                                                                                                    class="fa fa-check-square"
                                                                                                    style="color:chartreuse "></span></a>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td
                                                                                        *ngIf="detailsPieceMo.modified ">
                                                                                        <div
                                                                                            class="btn-group flex-btn-group-container">
                                                                                            <a
                                                                                                class="btn btn-sm btn-default"><span
                                                                                                    class="fa fa-history"
                                                                                                    style="color:currentColor "></span></a>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        <div class="row justify-content-center"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- End Fourniture-->
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- pieces de rechange -->
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class=" collapsible-card card-header align-items-center collapsed"
                                                            data-toggle="collapse" href="#collapseHomePieces">
                                                            <h4 jhiTranslate="auxiliumApp.detailsPieces.homeRechange">
                                                                Home
                                                                pieces
                                                            </h4>
                                                        </div>

                                                        <div id="collapseHomePieces" class="card-body collapse">
                                                            <div class="row">

                                                                <div class="col-sm-12">
                                                                    <div class="table-responsive"
                                                                        *ngIf="detailsPieces && detailsPieces.length > 0">
                                                                        <table class="table table-striped">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span>Observation Expert</span>
                                                                                    </th>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span>Vétusté</span>
                                                                                    </th>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span>% de participation
                                                                                            d’assuré </span>
                                                                                    </th>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span>Vétusté HT </span>
                                                                                    </th>
                                                                                    <th *ngIf="AvisExpert == true">
                                                                                        <span> Vétusté TTC</span>
                                                                                    </th>
                                                                                    <th><span>Observation</span></th>
                                                                                    <th><span>Référence</span></th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsPieces.designation">Designation</span>
                                                                                    </th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsPieces.prixUnit">Prix
                                                                                            Unit
                                                                                        </span></th>
                                                                                    <th><span>Nature Pièce</span></th>
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsPieces.quantite">Quantite</span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.detailsMo.totalHt">totalHt</span>
                                                                                </th>

                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.remise">remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalRemise">total
                                                                                        remise</span>
                                                                                </th>
                                                                                <th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalApresRemise">total
                                                                                        aprés remise</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.grille.tva">tva</span>
                                                                                    </th>
                                                                                    <!--<th><span
                                                                                        jhiTranslate="auxiliumApp.grille.totalTva">total
                                                                                        tva</span>
                                                                                </th>-->
                                                                                    <th><span
                                                                                            jhiTranslate="auxiliumApp.detailsMo.totalTtc">totalttc</span>
                                                                                    </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <tr
                                                                                    *ngFor="let pieces of detailsPieces ; let i=index">
                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <select
                                                                                            class="form-control form-control-sm"
                                                                                            name="piecesObservation[{{i}}]"
                                                                                            [(ngModel)]="pieces.observationExpert"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="observationExpert()"
                                                                                            disabled required>
                                                                                            <option
                                                                                                [ngValue]="expertObservation.id"
                                                                                                *ngFor="let expertObservation of expertObservations">
                                                                                                {{expertObservation.label}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>

                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="pieces.vetuste"
                                                                                            readonly name="vetuste"
                                                                                            style="width: 100px"
                                                                                            (ngModelChange)="calculateVetuste(pieces)"
                                                                                            required
                                                                                            [disabled]="pieces.observationExpert == 1" />
                                                                                    </td>
                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="pieces.insuredParticipation"
                                                                                            disabled readonly
                                                                                            name="insuredParticipation"
                                                                                            style="width: 100px"
                                                                                            [disabled]="pieces.observationExpert == 1" />
                                                                                    </td>

                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [value]="pieces.HTVetuste"
                                                                                            name="piecThtVetuste[{{i}}]"
                                                                                            disabled readonly
                                                                                            style="width: 100px"
                                                                                            [disabled]="pieces.observationExpert == 1" />
                                                                                    </td>
                                                                                    <td *ngIf="AvisExpert == true">
                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [value]="pieces.TTCVetuste"
                                                                                            name="TTCVetuste[{{i}}]"
                                                                                            readonly
                                                                                            style="width: 100px"
                                                                                            [disabled]="pieces.observationExpert == 1" />
                                                                                    </td>

                                                                                    <td
                                                                                        *ngIf="reparateurEtat == true || isGestionnaire == true || isResponsable == true">
                                                                                        <input type="text"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="pieces.observation"
                                                                                            disabled readonly
                                                                                            name="piecesObservation[{{i}}]"
                                                                                            [disabled]="pieces.observationExpert == 1" />
                                                                                    </td>


                                                                                    <td>

                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            [(ngModel)]="pieces.observationRepairer"
                                                                                            name="observation[{{i}}]"
                                                                                            id="field_observation"
                                                                                            style="width: 100px"
                                                                                            style="background-color: white"
                                                                                            disabled readonly required>
                                                                                            <option
                                                                                                value="PIECE_DISPONIBLE">
                                                                                                PIECE_DISPONIBLE
                                                                                            </option>
                                                                                            <option
                                                                                                value="COMMANDE_FERME">
                                                                                                COMMANDE_FERME
                                                                                            </option>
                                                                                            <option
                                                                                                value="PIECE_NON_DISPONIBLE">
                                                                                                PIECE_NON_DISPONIBLE
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>

                                                                                    <td>

                                                                                        <input
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="piecReference[{{i}}]"
                                                                                            [(ngModel)]="pieces.designationReference"
                                                                                            disabled
                                                                                            style="width: 100px">

                                                                                    </td>
                                                                                    <td>
                                                                                        <input
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="piecDesignation[{{i}}]"
                                                                                            [(ngModel)]="pieces.designation"
                                                                                            disabled
                                                                                            style="width: 100px">


                                                                                    </td>


                                                                                    <td>
                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            style="width: 100px"
                                                                                            [(ngModel)]="pieces.prixUnit"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changePieceRechange(pieces)"
                                                                                            disabled
                                                                                            name="piecPrixUnit[{{i}}]"
                                                                                            [disabled]="pieces.observationExpert == 1" />


                                                                                    </td>
                                                                                    <td>
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="naturePiece[{{i}}]"
                                                                                            [(ngModel)]="pieces.naturePiece"
                                                                                            disabled readonly
                                                                                            id="field_naturePiece"
                                                                                            style="width: 100px"
                                                                                            [disabled]="pieces.observationExpert == 1">
                                                                                            <option value="ORIGINE">
                                                                                                Origine
                                                                                            </option>
                                                                                            <option value="GENERIQUE">
                                                                                                Générique</option>
                                                                                            <option value="CASSE">Casse
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <td>

                                                                                        <input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="pieces.quantite"
                                                                                            readonly
                                                                                            (ngModelChange)="changePieceRechange(pieces)"
                                                                                            disabled
                                                                                            name="piecQuantite[{{i}}]"
                                                                                            style="width: 100px"
                                                                                            [disabled]="pieces.observationExpert == 1" />

                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        [value]="pieces.totalHt"
                                                                                        name="piecTht[{{i}}]" readonly
                                                                                        style="width: 100px"
                                                                                        [disabled]="pieces.observationExpert == 1" />
                                                                                </td>
                                                                                <td><input type="text"
                                                                                        class="input input-sm"
                                                                                        [(ngModel)]="pieces.discount"
                                                                                        disabled readonly
                                                                                        name="discountPiece[{{i}}]"
                                                                                        style="width: 100px" readonly />
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.amountDiscount"
                                                                                        disabled readonly
                                                                                        name="totalDiscountPiece[{{i}}]"
                                                                                        readonly
                                                                                        [disabled]="pieces.observationExpert == 1">
                                                                                </td>
                                                                                <td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.amountAfterDiscount"
                                                                                        disabled readonly
                                                                                        name="amountAfterDiscountPiece[{{i}}]"
                                                                                        readonly
                                                                                        [disabled]="pieces.observationExpert == 1">
                                                                                </td>-->
                                                                                    <td>
                                                                                        <select
                                                                                            class="btn-default btn-sm"
                                                                                            style="background-color: white"
                                                                                            name="piecTva[{{i}}]"
                                                                                            [(ngModel)]="pieces.tva"
                                                                                            disabled readonly
                                                                                            (ngModelChange)="changePieceRechange(pieces)"
                                                                                            disabled
                                                                                            [disabled]="pieces.observationExpert == 1">
                                                                                            <option
                                                                                                [ngValue]="vat.vatRate"
                                                                                                *ngFor="let vat of listVat;">
                                                                                                {{vat.vatRate}}
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <!--<td><input type="number"
                                                                                        class="input input-sm"
                                                                                        style="width: 100px"
                                                                                        [(ngModel)]="pieces.amountVat"
                                                                                        disabled readonly
                                                                                        name="amountTvaPiec[{{i}}]"
                                                                                        readonly
                                                                                        [disabled]="pieces.observationExpert == 1">
                                                                                </td>-->

                                                                                    <td><input type="number"
                                                                                            class="input input-sm"
                                                                                            [(ngModel)]="pieces.totalTtc"
                                                                                            disabled readonly
                                                                                            name="piecTtc[{{i}}]"
                                                                                            readonly
                                                                                            style="width: 100px"
                                                                                            [disabled]="pieces.observationExpert == 1" />
                                                                                    </td>
                                                                                    <td>

                                                                                    </td>
                                                                                    <td>

                                                                                    </td>

                                                                                    <td
                                                                                        *ngIf="detailsPieceMo.modified ">

                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        <div class="row justify-content-center"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row top-buffer"></div>
                                                <br />
                                                <div class="col-lg-2">

                                                </div>
                                                <div class="col-lg-8">
                                                    <span class="anchor" id="formUserEdit"></span>
                                                    <div class="card">
                                                        <div class="card-header align-items-center notice-info">
                                                            <strong>Total Réparation</strong>
                                                        </div>

                                                        <div class="card-body">
                                                            <div class="row">

                                                                <div class="form-group col-sm-3">
                                                                    <label
                                                                        jhiTranslate="auxiliumApp.devis.droitTimbre">droitTimbre</label>

                                                                    <input id="field_droitTimbre" type="number"
                                                                        class="form-control input input-sm"
                                                                        name="droitTimbre"
                                                                        [(ngModel)]="quotation.stampDuty" disabled
                                                                        readonly />
                                                                </div>
                                                                <div class="form-group col-sm-3">
                                                                    <label
                                                                        jhiTranslate="auxiliumApp.devis.totalTtc">totalTtc</label>
                                                                    <input id="field_totalTtc" type="text"
                                                                        class="form-control input input-sm"
                                                                        name="totalTtc"
                                                                        [(ngModel)]="quotation.ttcAmount" disabled
                                                                        readonly />
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>












                        <!----------------------------------------------------------------------------------Observation---------------------------------------------------------------------------->

                        <div>
                            <div class="row">
                                <div class="col-lg-12">

                                    <div class="card">
                                        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                            data-toggle="collapse" href="#collapseOb">
                                            <strong>Observations </strong>
                                        </div>
                                    </div>
                                    <div id="collapseOb" class="card-body collapse">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <input type="text" class="form-control form-control-sm"
                                                    name="observation" id="observationId"
                                                    [(ngModel)]="observation.commentaire" />
                                                <div [hidden]="!isCommentError">
                                                    <small class="form-text text-danger" [hidden]="!isCommentError"
                                                        jhiTranslate="entity.validation.required">This
                                                        field is required.</small>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <button *ngIf="!isObsModeEdit" class="btn btn-sm btn-primary addnew"
                                                    (click)="addObservation();">
                                                    <span class="fa fa-plus"></span>
                                                    <span jhiTranslate="auxiliumApp.observation.home.createLabel">Create
                                                        new
                                                        Observation
                                                    </span>
                                                </button>
                                                <button *ngIf="isObsModeEdit" class="btn btn-sm btn-primary addnew"
                                                    (click)="editObservation();">
                                                    <span class="fa fa-pencil"></span>
                                                    <span jhiTranslate="auxiliumApp.observation.home.editLabel">Edit
                                                        Observation
                                                    </span>
                                                </button>

                                            </div>
                                        </div>
                                        <div class="row" style="margin-top: 15px;">
                                            <div class="col-sm-12">
                                                <div class="table-responsive"
                                                    *ngIf="observationss && observationss.length > 0">
                                                    <table class="table table-sm table-hover table-bordered"
                                                        style="width: 100%">
                                                        <thead>
                                                            <tr jhiSort style="color: white; background-color: #167F92">
                                                                <th jhiSortBy="date"><span
                                                                        jhiTranslate="auxiliumApp.observation.date">Date</span>
                                                                    <span class="fa fa-sort"></span></th>
                                                                <th><span
                                                                        jhiTranslate="auxiliumApp.observation.commentaire">Commentaire</span>
                                                                    <span class="fa fa-sort"></span></th>
                                                                <th jhiSortBy="userLogin"><span
                                                                        jhiTranslate="auxiliumApp.observation.user">Utilisateur</span>
                                                                    <span class="fa fa-sort"></span></th>
                                                                <!--<th></th>-->
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <ng-container *ngFor="let observation of observationss">
                                                                <tr *ngIf="!observation.deleted">
                                                                    <td>{{observation.date  | date:'dd/MM/yy'}}</td>
                                                                    <td>{{observation.commentaire}}</td>
                                                                    <td>{{observation.firstName}}
                                                                        {{observation.lastName}}</td>
                                                                    <!--<td class="text-right">
                                                                    <div class="btn-group flex-btn-group-container">
                                                                        <button type="button"
                                                                            (click)="prepareEditObservation(observation)"
                                                                            class="btn btn-primary btn-sm">
                                                                            <span class="fa fa-pencil"></span>
                                                                        </button>
                                                                        <button type="button"
                                                                            (click)="deleteObservation(observation)"
                                                                            class="btn btn-danger btn-sm">
                                                                            <span class="fa fa-trash"></span>
                                                                        </button>
                                                                    </div>
                                                                </td>-->
                                                                </tr>
                                                            </ng-container>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <!------------------------------------------------------- fin observation ----------------------------------------------------------->

                </form>
        </div>
        </body>
    </section>
</form>
</div>
</div>






<!-- Bouton Save -->
<div class="modal-footer">
    <div *ngIf="!quoteValidation && !quoteRectify &&!modeConfirmation && !AvisExpert">
        <button type="submit" [disabled]="editForm.form.invalid || isSaving " class="btn btn-primary" (click)="save()">
            <span class="fa fa-save"></span> <span jhiTranslate="entity.action.save">Save</span>
        </button>
    </div>

</div>
</div>
</div>
</div>
</form>
</section>
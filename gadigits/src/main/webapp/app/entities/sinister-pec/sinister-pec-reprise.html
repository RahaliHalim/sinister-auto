<!-- Breadcrumb-->
<div class="breadcrumb-holder">
    <div class="container-fluid">
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="#"><span class="fa fa-home"></span>&nbsp;&nbsp;<span
                        jhiTranslate="global.menu.home">Home</span></a></li>
            <li class="breadcrumb-item"><a routerLink="/dossier"><span
                        jhiTranslate="auxiliumApp.dossier.home.title">Dossiers</span></a></li>
            <li class="breadcrumb-item"><span jhiTranslate="auxiliumApp.sinister.home.details">détails PECS</span></li>

        </ul>
        <div class="col-lg-12"
            *ngIf="isSinPecBonSortie || isSinPecVerifOrgPrinted || isApprouved || isAcceptedWithReserve || isCancPec || isRefusPec">
            <i class="fa fa-history" aria-hidden="true" (click)="historyPec()" style="font-size: 35px;
                        position: absolute; right: 16px; top: 11px;"></i>

        </div>
    </div>
</div>
<section class="forms">
    <div class="container-fluid">
        <!-- Page Header-->
        <header>
            <h1 class="h3 display">
                <jhi-alert-error></jhi-alert-error>
                <jhi-alert></jhi-alert>
            </h1>
        </header>
        <div class="row">
            <div class="col-lg-12">
                <form name="editForm" role="form" novalidate #editForm="ngForm">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header d-flex align-items-center no-padding">
                                    <div class="notice notice-info">
                                        <span class="fa fa-folder-open" style="color: #45ABCD"></span>&nbsp;&nbsp;
                                        <strong jhiTranslate="auxiliumApp.dossier.home.details">Détails du
                                            dossier</strong>
                                        {{sinister.reference}}
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label jhiTranslate="auxiliumApp.sinister.immatriculation"
                                                    for="currentSearch">Immatriculation</label>
                                                <div class="input-group">
                                                    <input type="text" [(ngModel)]="sinister.vehicleRegistration"
                                                        (blur)="trimRegistrationNumber();"
                                                        class="form-control form-control-sm" name="currentSearch"
                                                        id="currentSearch" [readonly]="sinister.id" required />
                                                    <span class="input-group-btn">
                                                        <button class="input-group-addon btn btn-sm btn-info"
                                                            [hidden]="sinister.id">
                                                            <span class="fa fa-search"></span>
                                                        </button>
                                                        <button class="input-group-addon btn btn-sm btn-info"
                                                            [hidden]="sinister.id"
                                                            [disabled]="contratAssurance !== null"
                                                            [routerLink]="['../contrat-assurance-new', sinister.vehicleRegistration ]">
                                                            <span class="fa fa-plus"></span>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label jhiTranslate="auxiliumApp.dossier.natureIncident"
                                                    for="field_natureIncident">Nature de l'incident
                                                </label>
                                                <select class="form-control form-control-sm" name="natureIncident"
                                                    [(ngModel)]="sinister.nature" id="field_natureIncident" disabled>
                                                    <option value="PANNE"
                                                        jhiTranslate="auxiliumApp.NatureIncident.PANNE">Panne</option>
                                                    <option value="ACCIDENT"
                                                        jhiTranslate="auxiliumApp.NatureIncident.ACCIDENT">Accident
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <label class="form-control-label"
                                                jhiTranslate="auxiliumApp.dossier.dateAccident"
                                                for="field_dateAccident">Date de l'accident</label>
                                            <div class="input-group">
                                                <input id="field_dateAccident" type="text"
                                                    class="form-control form-control-sm" name="dateAccident"
                                                    ngbDatepicker #dateAccidentDp="ngbDatepicker"
                                                    [(ngModel)]="sinister.incidentDate" [disabled]="!enableField"
                                                    required />
                                                <span class="input-group-btn">
                                                    <button type="button" class="btn btn-sm btn-default"
                                                        (click)="dateAccidentDp.toggle()"
                                                        [disabled]="!isContractLoaded"><i
                                                            class="fa fa-calendar"></i></button>
                                                </span>
                                            </div>
                                            <div [hidden]="!(frm.dateAccident?.dirty && frm.dateAccident?.invalid)">
                                                <small class="form-text text-danger"
                                                    [hidden]="!frm.dateAccident?.errors?.required"
                                                    jhiTranslate="entity.validation.required">This field is
                                                    required.</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label class="form-control-label"
                                                    jhiTranslate="auxiliumApp.dossier.nbrPassagers"
                                                    for="field_nbrPassagers">Nbre de passagers</label>
                                                <input type="number" class="form-control form-control-sm"
                                                    name="nbrPassagers" id="field_nbrPassagers"
                                                    [(ngModel)]="sinister.passengerCount" [pattern]="nbrPassgrPattern"
                                                    min="{{minPssgrNumber}}" [disabled]="!enableField" />
                                                <div
                                                    [hidden]="!(editForm.controls.nbrPassagers?.dirty && editForm.controls.nbrPassagers?.invalid)">
                                                    <small class="form-text text-danger"
                                                        [hidden]="!editForm.controls.nbrPassagers?.errors?.max"
                                                        jhiTranslate="entity.validation.max"
                                                        translateValues="{ max: 99999999 }">This
                                                        field cannot be more
                                                        than 99999999.</small>
                                                    <small class="form-text text-danger"
                                                        [hidden]="!editForm.controls.nbrPassagers?.errors?.number"
                                                        jhiTranslate="entity.validation.number">This field should be a
                                                        number.</small>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label class="form-control-label"
                                                    jhiTranslate="auxiliumApp.dossier.telephone"
                                                    for="field_telephone">Telephone</label>
                                                <input type="text" class="form-control form-control-sm" name="telephone"
                                                    id="field_telephone" [(ngModel)]="sinister.phone"
                                                    [disabled]="!enableField" pattern="([0-9]{1,50})" />
                                                <div
                                                    [hidden]="!(editForm.controls.telephone?.dirty && editForm.controls.telephone?.invalid)">
                                                    <small class="form-text text-danger"
                                                        [hidden]="!editForm.controls.telephone?.errors?.pattern"
                                                        jhiTranslate="entity.validation.pattern"
                                                        translateValues="{ pattern: 'Telephone' }">This
                                                        field should
                                                        follow pattern for "Telephone".</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row" *ngIf="isContractLoaded">
                                        <div class="col-sm-3">
                                            <br>
                                            <label class="form-control-label" jhiTranslate="auxiliumApp.sinister.assure"
                                                for="field_isAssure">isAssure</label>
                                            <input type="checkbox" class="check-input" name="field_isAssure"
                                                id="field_isAssure" [value]="sinister.isAssure"
                                                [(ngModel)]="sinister.isAssure" [disabled]="!enableField" />
                                        </div>
                                        <div class="col-sm-3" *ngIf="!sinister.isAssure">
                                            <div>
                                                <label class="form-control-label"
                                                    jhiTranslate="auxiliumApp.sinister.conducteur" for="field_nomCond">
                                                    nom du conducteur </label>
                                                <input type="text" class="form-control form-control-sm" name="nomCond"
                                                    id="field_nomCond" [(ngModel)]="sinister.conductorFirstName"
                                                    [required]="!sinister.isAssure" [disabled]="!enableField" />
                                            </div>
                                        </div>
                                        <div class="col-sm-4" *ngIf="sinister.isAssure">
                                            <label class="form-control-label"
                                                jhiTranslate="auxiliumApp.contratAssurance.assure"
                                                for="field_prenomAssure"> nom/prénom de l'assuré </label>
                                            <input type="text" class="form-control form-control-sm" name="nomAssure"
                                                id="field_prenomAssure" [(ngModel)]="assure" readonly
                                                [disabled]="!enableField" />
                                        </div>
                                        <div class="col-sm-3">
                                            <label jhiTranslate="auxiliumApp.sinisterPec.driverLicenseNumber"
                                                for="currentSearch1">driver
                                                License Number</label>
                                            <input type="text" [(ngModel)]="sinisterPec.driverLicenseNumber"
                                                class="form-control form-control-sm" name="currentSearch1"
                                                id="currentSearch1" [disabled]="!enableField" />
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-5">
                                            <div class="form-group">
                                                <label
                                                    jhiTranslate="auxiliumApp.refTypeService.detail.title">Servicetype</label>
                                                <select class="form-control form-control-sm" id="field_lieu" name="lieu"
                                                    disabled [(ngModel)]="typeServiceId">
                                                    <option [ngValue]="serviceType.id"
                                                        *ngFor="let serviceType of serviceTypes">
                                                        {{serviceType.nom}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header d-flex align-items-center no-padding">
                                    <div class="notice notice-info">
                                        <span class="fa fa-file-text-o" style="color: #45ABCD"></span>&nbsp;&nbsp;
                                        <strong jhiTranslate="auxiliumApp.contratAssurance.home.details">Détails du
                                            contrat</strong>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-danger" *ngIf="contratAssurance == null"
                                        jhiTranslate="auxiliumApp.sinister.contrat">
                                        <strong>Matricule inéxistante</strong>
                                    </div>
                                    <!-- Begin sinister and contract -->
                                    <form name="editForm" role="form" *ngIf="contratAssurance !== null">
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.numeroContrat"
                                                        for="field_numeroContrat">numéro de contrat</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="numeroContrat" id="field_numeroContrat"
                                                        [(ngModel)]="contratAssurance.numeroContrat" readonly />
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.refCompagnie.detail.title"
                                                        for="field_compagnie">Compagnie</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="compagnie" id="field_compagnie" [(ngModel)]="compagnie"
                                                        readonly />
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.refAgence.detail.title"
                                                        for="field_compagnie">Agence</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="agence" id="field_agence" [(ngModel)]="agence" readonly />
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.assure"
                                                        for="field_assurePrenom">Assuré</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="assurePrenom" id="field_assurePrenom" [(ngModel)]="assure"
                                                        maxlength="100" readonly />
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.debutValidite"
                                                        for="field_debutValidite_ctr">Début de validité</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="debutValiditeCtr" id="field_debutValidite_ctr"
                                                        value="{{contratAssurance.debutValidite | date:'dd/MM/yyyy'}}"
                                                        readonly />
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.finValidite"
                                                        for="field_finValidite_ctr">Fin de validité</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="finValiditeCtr" id="field_finValidite_ctr"
                                                        value="{{contratAssurance.finValidite | date:'dd/MM/yyyy'}}"
                                                        readonly />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.marque"
                                                        for="field_marqueLibelle">Marque</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="marqueLibelle" id="field_marqueLibelle"
                                                        [(ngModel)]="vehicule.marqueLibelle" readonly />
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.vehiculeAssure.datePCirculation"
                                                        for="field_debutCirculation">Date de la première mise en
                                                        circulation</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="debutCirculation" id="field_debutCirculation"
                                                        [(ngModel)]="datePCirculation" readonly />
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.ville"
                                                        for="field_ville">Ville</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="villeLibelle" id="field_ville"
                                                        [(ngModel)]="contratAssurance.villeLibelle || contratAssurance.villeMoraleLibelle"
                                                        readonly />
                                                </div>
                                            </div>
                                            <div class="col-sm-4">
                                                <br>
                                                <input type="checkbox" class="check-input" name="isAssujettieTva"
                                                    id="field_isAssujettieTva" [(ngModel)]="assureur.isAssujettieTva"
                                                    disabled />
                                                <label class="form-control-label"
                                                    jhiTranslate="auxiliumApp.personneMorale.isAssujettieTva"
                                                    for="field_isAssujettieTva">isAssujettieTva</label>
                                            </div>

                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.pack"
                                                        for="field_pack">Pack</label>
                                                    <input type="text" class="form-control form-control-sm" name="pack"
                                                        id="field_pack" [(ngModel)]="vehicule.packLabel" readonly />
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <!-- End contract details -->
                                </div>
                            </div>
                        </div>
                        <!-- End sinister and contract details -->
                    </div>
                </form>
            </div>
        </div>

        <form name="frm" #frm="ngForm">
            <div class="card">
                <div class="card-header d-flex align-items-center no-padding">
                    <div class="notice notice-info">
                        <strong jhiTranslate="auxiliumApp.sinisterPec.home.detail">sinistre Pec</strong>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">

                        <div class="col-sm-2">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.sinisterPec.companyReference"
                                for="field_reference">Référence</label>
                            <input type="text" class="form-control form-control-sm" name="field_reference"
                                id="field_reference" [(ngModel)]="sinisterPec.companyReference"
                                [disabled]="!enableField" (ngModelChange)="testRefernceSinister()" />
                            <div [hidden]="!(frm.field_reference?.dirty && frm.field_reference?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.field_reference?.errors?.required"
                                    jhiTranslate="entity.validation.required">This field is required.</small>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.dossier.dateDeclaration"
                                for="field_dateDeclaration">Date de
                                déclaration</label>
                            <div class="input-group">
                                <input id="field_dateDeclaration" class="form-control form-control-sm"
                                    name="dateDeclaration"
                                    value="{{sinisterPec.declarationDate | date:'dd/MM/yyyy HH:mm:ss'}}" required
                                    disabled />

                            </div>
                            <div [hidden]="!(frm.dateDeclaration?.dirty && frm.dateDeclaration?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.dateDeclaration?.errors?.required"
                                    jhiTranslate="entity.validation.required">This field is required.</small>
                            </div>
                        </div>

                        <div class="col-sm-2">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.sinisterPrestation.mode" for="field_garanties">
                                    mode de gestion
                                    (Ex garantie)</label>
                                <select class="form-control form-control-sm" id="field_garanties" name="garanties"
                                    [(ngModel)]="sinisterPec.modeId" (ngModelChange)="changeMode(sinisterPec.modeId)"
                                    required [disabled]="!enableField || isAcceptedWithChangeStatus">
                                    <option [ngValue]="modeGestionByPack.id"
                                        *ngFor="let modeGestionByPack of listModeByCnvByUser; trackBy: trackGrantiesId">
                                        {{modeGestionByPack.libelle}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-sm-2"
                            *ngIf="(isApprouved && showModeToModif) || isAcceptedWithChangeStatus || isSinPecChangeStatus">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.sinisterPec.mode_to_modif" for="mode_to_modif">
                                    mode de gestion
                                    (Ex garantie)</label>
                                <select class="form-control form-control-sm" id="mode_to_modif" name="modeModif"
                                    [(ngModel)]="sinisterPec.modeModifId" required
                                    (ngModelChange)="changeMode(sinisterPec.modeModifId)"
                                    [disabled]="!enableField || sinisterPec.oldStep == 20">
                                    <option [ngValue]="modeGestionByPack.id"
                                        *ngFor="let modeGestionByPack of listModeByCnvByUser; trackBy: trackGrantiesId">
                                        {{modeGestionByPack.libelle}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-sm-2" *ngIf="sinisterPec.fromDemandeOuverture == false">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.sinisterPec.posGa" for="field_pos_ga">
                                    pos ga</label>
                                <select class="form-control form-control-sm" id="field_pos_ga" name="pos_ga"
                                    [(ngModel)]="sinisterPec.posGaId" required [disabled]="!enableField">
                                    <option [ngValue]="posGa.id"
                                        *ngFor="let posGa of listPositionGa; trackBy: trackPositionGaId">
                                        {{posGa.libelle}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-sm-1">
                            <div class="form-group">
                                <label class="form-control-label" jhiTranslate="auxiliumApp.sinisterPec.vehicleNumber"
                                    for="field_nbrevehicule">Nbr Vehicules</label>
                                <input type="number" id="field_nbrevehicule" class="form-control form-control-sm"
                                    name="nbreVehicule" [(ngModel)]="sinisterPec.vehicleNumber"
                                    (ngModelChange)="verifTiers()" [pattern]="nbrVehPattern" min="{{minVinNumber}}"
                                    required [disabled]="!enableField" [readonly]="vehNmbrIda" />
                                <div [hidden]="!(frm.nbreVehicule?.dirty && frm.nbreVehicule?.invalid)">
                                    <small class="form-text text-danger" [hidden]="!frm.nbreVehicule?.errors?.required"
                                        jhiTranslate="entity.validation.required">This field is required.</small>
                                </div>

                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-sm-3" *ngIf="garantieDommageVehicule || garantieTierce">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.valeurNeuf"
                                for="field_valeurNeuf"> Valeur Neuf </label>
                            <input type="number" class="form-control form-control-sm" name="valeurNeuf"
                                id="field_valeurNeuf" [(ngModel)]="vehicule.newValueVehicle" min="0"
                                max="100000000000000000" required [disabled]="!enableField" />
                            <div [hidden]="!(frm.controls.valeurNeuf?.dirty && frm.controls.valeurNeuf?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.controls.valeurNeuf?.errors?.max"
                                    jhiTranslate="entity.validation.max"
                                    translateValues="{ max: 100000000000000000 }">This
                                    field cannot be more than
                                    100000000000000000. </small>
                                <small class="form-text text-danger" [hidden]="!frm.controls.valeurNeuf?.errors?.number"
                                    jhiTranslate="entity.validation.number"> This field should be a number. </small>
                            </div>
                        </div>

                        <div class="col-sm-3" *ngIf="garantieDommageCollision || garantieTierceCollision">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.capitalDc"
                                for="field_capitalDc">Capital
                                Dc</label>
                            <input type="number" class="form-control form-control-sm" name="capitalDc"
                                id="field_capitalDc" [(ngModel)]="vehicule.dcCapital" min="0" max="100000000000000000"
                                (ngModelChange)="diffCapDcCapR()" required [disabled]="!enableField" />
                            <div [hidden]="!(frm.controls.capitalDc?.dirty && frm.controls.capitalDc?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.controls.capitalDc?.errors?.max"
                                    jhiTranslate="entity.validation.max"
                                    translateValues="{ max: 100000000000000000 }">This
                                    field cannot be more than
                                    100000000000000000. </small>
                                <small class="form-text text-danger" [hidden]="!frm.controls.capitalDc?.errors?.number"
                                    jhiTranslate="entity.validation.number"> This field should be a number. </small>
                            </div>
                        </div>
                        <div class="col-sm-3" *ngIf="garantieVolIncendiePartiel">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.valeurVenale"
                                for="field_valeurVenale"> Valeur Venale </label>
                            <input type="number" class="form-control form-control-sm" name="valeurVenale"
                                id="field_valeurVenale" [(ngModel)]="vehicule.marketValue" min="0"
                                max="100000000000000000" required [disabled]="!enableField" />
                            <div [hidden]="!(frm.controls.valeurVenale?.dirty && frm.controls.valeurVenale?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.controls.valeurVenale?.errors?.max"
                                    jhiTranslate="entity.validation.max"
                                    translateValues="{ max: 100000000000000000 }">This
                                    field cannot be more than
                                    100000000000000000. </small>
                                <small class="form-text text-danger"
                                    [hidden]="!frm.controls.valeurVenale?.errors?.number"
                                    jhiTranslate="entity.validation.number"> This field should be a number. </small>
                            </div>
                        </div>
                        <div class="col-sm-3" *ngIf="garantieBrisGlace">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.capitalBG"
                                for="field_bgCapital">
                                capital BG </label>
                            <input type="number" class="form-control form-control-sm" name="bgCapital"
                                id="field_bgCapital" [(ngModel)]="vehicule.bgCapital" min="0" max="100000000000000000"
                                required [disabled]="!enableField" />
                            <div [hidden]="!(frm.controls.bgCapital?.dirty && frm.controls.bgCapital?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.controls.bgCapital?.errors?.max"
                                    jhiTranslate="entity.validation.max"
                                    translateValues="{ max: 100000000000000000 }">This
                                    field cannot be more than
                                    100000000000000000. </small>
                                <small class="form-text text-danger" [hidden]="!frm.controls.bgCapital?.errors?.number"
                                    jhiTranslate="entity.validation.number"> This field should be a number. </small>
                            </div>
                        </div>
                        <div class="col-sm-3"
                            *ngIf="garantieDommageCollision || garantieBrisGlace || garantieTierceCollision">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.sinisterPec.capitalRestant"
                                for="field_capitalRestant">
                                capital restant </label>
                            <input type="number" class="form-control form-control-sm" name="capitalRestant"
                                id="field_capitalRestant" [(ngModel)]="sinisterPec.remainingCapital" min="0"
                                max="100000000000000000" (ngModelChange)="diffCapDcCapR()" required
                                [disabled]="!enableField" />
                            <div
                                [hidden]="!(frm.controls.capitalRestant?.dirty && frm.controls.capitalRestant?.invalid)">
                                <small class="form-text text-danger"
                                    [hidden]="!frm.controls.capitalRestant?.errors?.max"
                                    jhiTranslate="entity.validation.max"
                                    translateValues="{ max: 100000000000000000 }">This
                                    field cannot be more than
                                    100000000000000000. </small>
                                <small class="form-text text-danger"
                                    [hidden]="!frm.controls.capitalRestant?.errors?.number"
                                    jhiTranslate="entity.validation.number"> This field should be a number. </small>
                            </div>
                        </div>

                        <div class="col-sm-3" *ngIf="garantieDommageCollision && contratAssurance.clientId == 3">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.sinisterPec.valeurAss"
                                for="field_valeurAss"> valeur Assure </label>
                            <input type="number" class="form-control form-control-sm" name="valeurAss"
                                id="field_valeurAss" [(ngModel)]="sinisterPec.valeurAssure" min="0"
                                max="100000000000000000" [disabled]="!enableField" required />
                            <div [hidden]="!(frm.controls.valeurAss?.dirty && frm.controls.valeurAss?.invalid)">
                                <small class="form-text text-danger" [hidden]="!frm.controls.valeurAss?.errors?.max"
                                    jhiTranslate="entity.validation.max"
                                    translateValues="{ max: 100000000000000000 }">This
                                    field cannot be more than
                                    100000000000000000. </small>
                                <small class="form-text text-danger" [hidden]="!frm.controls.valeurAss?.errors?.number"
                                    jhiTranslate="entity.validation.number"> This field should be a number. </small>
                            </div>
                        </div>

                        <div class="col-sm-1" *ngIf="garantieDommageVehicule || garantieTierce">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.franchise"
                                for="field_newValueVehicleFarnchise">Franchise</label>
                            <input type="number" class="form-control form-control-sm" name="newValueVehicleFarnchise"
                                id="field_newValueVehicleFarnchise" [(ngModel)]="vehicule.newValueVehicleFarnchise"
                                [pattern]="amountPattern" [disabled]="!enableField" required />
                        </div>
                        <div class="col-sm-2" *ngIf="garantieDommageVehicule || garantieTierce">
                            <label for="field_type"> Type de franchise </label>
                            <select class="form-control form-control-sm" id="field_typenewvalue" name="typenewvalue"
                                [(ngModel)]="vehicule.franchiseTypeNewValue" [disabled]="!enableField" required>
                                <option value="Montant">Montant</option>
                                <option value="Pourcentage">Pourcentage</option>
                            </select>
                        </div>
                        <div class="col-sm-1" *ngIf="garantieDommageCollision || garantieTierceCollision">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.franchise"
                                for="field_dcCapitalFranchise">Franchise</label>
                            <input type="number" class="form-control form-control-sm" name="dcCapitalFranchise"
                                id="field_dcCapitalFranchise" [(ngModel)]="vehicule.dcCapitalFranchise"
                                [disabled]="!enableField" [pattern]="amountPattern" required />
                        </div>
                        <div class="col-sm-2" *ngIf="garantieDommageCollision || garantieTierceCollision">
                            <label for="field_type"> Type de franchise </label>
                            <select class="form-control form-control-sm" id="field_typedccapital" name="typedccapital"
                                [(ngModel)]="vehicule.franchiseTypeDcCapital" [disabled]="!enableField" required>
                                <option value="Montant">Montant</option>
                                <option value="Pourcentage">Pourcentage</option>
                            </select>
                        </div>
                        <div class="col-sm-1" *ngIf="garantieVolIncendiePartiel">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.franchise"
                                for="field_franchise">Franchise</label>
                            <input type="number" class="form-control form-control-sm" name="marketValueFranchise"
                                id="field_marketValueFranchise" [(ngModel)]="vehicule.marketValueFranchise"
                                [disabled]="!enableField" [pattern]="amountPattern" required />
                        </div>
                        <div class="col-sm-2" *ngIf="garantieVolIncendiePartiel">
                            <label for="field_type"> Type de franchise </label>
                            <select class="form-control form-control-sm" id="field_typemarketvalue"
                                name="typemarketvalue" [(ngModel)]="vehicule.franchiseTypeMarketValue"
                                [disabled]="!enableField" required>
                                <option value="Montant">Montant</option>
                                <option value="Pourcentage">Pourcentage</option>
                            </select>
                        </div>
                        <div class="col-sm-1" *ngIf="garantieBrisGlace">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.contratAssurance.franchise"
                                for="field_bgCapitalFranchise">Franchise</label>
                            <input type="number" class="form-control form-control-sm" name="bgCapitalFranchise"
                                id="field_bgCapitalFranchise" [(ngModel)]="vehicule.bgCapitalFranchise"
                                [disabled]="!enableField" [pattern]="amountPattern" required />
                        </div>
                        <div class="col-sm-2" *ngIf="garantieBrisGlace">
                            <label for="field_type"> Type de fanchise </label>
                            <select class="form-control form-control-sm" id="field_typebgcapital" name="typebgcapital"
                                [(ngModel)]="vehicule.franchiseTypeBgCapital" [disabled]="!enableField" required>
                                <option value="Montant">Montant</option>
                                <option value="Pourcentage">Pourcentage</option>
                            </select>
                        </div>
                        <div class="col-sm-2">
                            <label class="form-control-label" jhiTranslate="auxiliumApp.sinisterPec.assujettie"></label>
                            <span style="color: #FA2F03">*</span>
                            <br />
                            <label class="btn btn-sm btn-primary" for="assujettie1" >
                                <input type="radio" name="assujettie" id="assujettie1" required
                                disabled autocomplete="off" [value]="true"
                                    [(ngModel)]="vehicule.assujettieTVA"> Oui
                            </label> &nbsp;
                            <label class="btn btn-sm btn-primary" for="assujettie2" >
                                <input type="radio" name="assujettie" id="assujettie2" required
                                disabled autocomplete="off" [value]="false"
                                    [(ngModel)]="vehicule.assujettieTVA">
                                Non
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3"
                            *ngIf="(sinisterPec.modeModifId == 6 && showValeurANeufExpert && sinisterPec.oldStepModifSinPec !== null && !preliminaryReport && (isApprouved || isAcceptedWithChangeStatus || isSinPecChangeStatus)) || (sinisterPec.modeModifId == 10 && showValeurANeufExpert && sinisterPec.oldStepModifSinPec !== null && !preliminaryReport && (isApprouved || isAcceptedWithChangeStatus || isSinPecChangeStatus)) || (sinisterPec.partnerId == 3 && showValeurANeufExpert && sinisterPec.modeModifId == 5 && sinisterPec.oldStepModifSinPec !== null && !preliminaryReport && (isApprouved || isAcceptedWithChangeStatus || isSinPecChangeStatus))">
                            <label class="form-control-label" for="VA">Valeur à neuf
                            </label>
                            <input type="number" class="form-control form-control-sm" name="VA" id="VA"
                                [(ngModel)]="sinisterPec.valeurANeufExpert" required />
                        </div>
                        <div class="col-sm-3"
                            *ngIf="(sinisterPec.modeModifId == 8 && showValeurANeufExpert && sinisterPec.oldStepModifSinPec !== null && !preliminaryReport && (isApprouved || isAcceptedWithChangeStatus || isSinPecChangeStatus) ) ||  (sinisterPec.modeModifId == 9 && showValeurANeufExpert && sinisterPec.oldStepModifSinPec !== null && !preliminaryReport && (isApprouved || isAcceptedWithChangeStatus || isSinPecChangeStatus))">
                            <label for="VV">Valeur vénale</label>

                            <input type="number" class="form-control form-control-sm" name="VV" id="VV"
                                [(ngModel)]="sinisterPec.valeurVenaleExpert" required />
                        </div>
                    </div>
                    <br>

                    <div class="row">

                        <div class="col-sm-1">
                            <br>
                            <span style="font-weight:bold;"><label
                                    jhiTranslate="auxiliumApp.sinisterPec.home.LieuDuSinister">Lieu
                                    du sinister</label></span>
                        </div>

                        <div class="col-sm-2">
                            <label jhiTranslate="auxiliumApp.reparateur.gouvernorat">gouvernorat</label>
                            <select class="form-control form-control-sm" id="field_lieu" name="lieu"
                                [(ngModel)]="sinisterPec.governorateId"
                                (ngModelChange)="fetchDelegationsByGovernorate(sinisterPec.governorateId)" required
                                [disabled]="!enableField">
                                <option [ngValue]="governorate.id"
                                    *ngFor="let governorate of governorates; trackBy: trackGouvernoratById">
                                    {{governorate.label}}
                                </option>
                            </select>
                        </div>

                        <div class="col-sm-2">
                            <label jhiTranslate="auxiliumApp.sinisterPec.ville" for="field_ville">Ville</label>
                            <select class="form-control form-control-sm" id="field_ville" name="ville"
                                [(ngModel)]="sinisterPec.delegationId" [disabled]="!enableField" required>
                                <option [ngValue]="sysville.id"
                                    *ngFor="let sysville of sysvilles; trackBy: trackSysVilleById">
                                    {{sysville.label}}</option>
                            </select>
                        </div>
                    </div>

                    <br>
                    <div class="row" *ngIf="isContractLoaded">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.sinisterPec.casBareme" for="field_bareme">cas De
                                    Bareme</label>
                                <span style="color: #FA2F03">*</span>
                                <div [hidden]="!(frm.bareme?.dirty && frm.bareme?.invalid)">
                                    <small class="form-text text-danger" [hidden]="!frm.bareme?.errors?.required"
                                        jhiTranslate="entity.validation.required">This field is required.</small>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-1" *ngIf="enableField">
                            <div class="form-group">
                                <button class="input-group-addon btn btn-sm btn-info"
                                    [routerLink]="['/', { outlets: { popup: ['ref-bareme-pop'] } }]">
                                    <span class="fa fa-search"></span>
                                    <span class="hidden-sm-down" jhiTranslate="auxiliumApp.refBareme.home.loop">loop
                                        ref.Bareme</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="row" *ngIf="isContractLoaded && CasBareme.id">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.refBareme.code" for="field_codeBareme">code
                                    barème</label>
                                <input type="text" class="form-control form-control-sm" name="codeBareme"
                                    id="field_codeBareme" [(ngModel)]="CasBareme.code" readonly />
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.refBareme.tauxR"
                                    for="field_tauxDeResponsabilite">tauxDeResponsabilité
                                    bareme</label>
                                <input type="text" class="form-control form-control-sm" name="tauxDeResponsabilite"
                                    id="field_tauxDeResponsabilite" [(ngModel)]="CasBareme.responsabiliteX" readonly />
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <div class="form-group">
                                <label jhiTranslate="auxiliumApp.refBareme.description"
                                    for="field_descriptionBareme">desciption
                                    bareme</label>
                                <textarea type="text" class="form-control form-control-sm" name="descriptionBareme"
                                    id="field_descriptionBareme" [(ngModel)]="CasBareme.description" readonly rows="5"
                                    cols="33">
                                </div>
                            </div>
                            <div> 
                                <img *ngIf="CasBareme.attachment64" [src]="getImage(CasBareme)" height="100" width="350">
                            </div>
                        </div>
                        
                        </div>
                          </div>
    
                <!-- Tier list -->
                <div class="row" *ngIf="!isSinPecBonSortie && !isSinPecVerifOrgPrinted">
                        <div class="col-lg-12">
                        <div class="card">
                            <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#collapseTier">
                                <strong jhiTranslate="auxiliumApp.tiers.home.title">Tiers</strong>
                            </div>
                            <div id="collapseTier" class="card-body collapse">
                        <div *ngIf="enableField">         
                <form name="editFormgrantieImplique" role="form" novalidate  #editFormgrantieImplique="ngForm">
                                <div class="row">
                                    <div class="col-sm-12">
                                            <div class="row" *ngIf="!showFrmTiers">
                                                    <div class="col-sm-12">
                                                            <div class="row">
                                                                    <div class="col-sm-11" ></div>
                                                                    <div class="col-sm-1" >
                    
                                                                            <button  
                                                                            
                                                                            class="btn btn-sm btn-primary addnew" (click)="addForm();" [disabled]="consultation">
                                                                                <span class="fa fa-plus"></span>
                                                                                <span  jhiTranslate="auxiliumApp.observation.home.createLabel">Creer nouveau tier</span>
                                                                            </button>
                                                                        
                                                                    </div>
                                                            </div>

                                                            <div class="row">
                                                                    <div class="col-sm-10" >
                                                                <div class="alert alert-danger" *ngIf="showAlertTiers" jhiTranslate="auxiliumApp.sinisterPec.verifTiers">
                                                                    <strong>Merci de vérifier le nombre de véhicule</strong>
                                                                </div>
                                                                 </div>
                                                            </div>
                    
                                                    </div>
                                                </div>
                                        <div class="row" *ngIf="newFormTiers == true && showFrmTiers">
          
                              <!--Immatriculation-->
                              <div class="col-sm-2">
                                <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.immatriculation" for="field_immatriculation">Immatriculation</label>
                                <input type="text" [(ngModel)]="tier.immatriculation"
                                        class="form-control form-control-sm" name="immatriculation" id="field_immatriculation" (blur)="trimRegistrationNumberTiers();"required/>
                        </div> 
                        <div class="col-sm-2">
                            <div class="form-group">
                                <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.compagnie" for="field_compagnieAssuranceImmatriculation">Compagnie Assurance immatriculation</label>
                                <div class="input-group">
                                    <select class="form-control form-control-sm" id="field_compagnieAssuranceImmatriculation" name="compagnieAssuranceImmat" [(ngModel)]="companyId">
                                    <option [ngValue]="compagnieOption.id" *ngFor="let compagnieOption of compagnies">
                                    {{compagnieOption.companyName}} </option>
                                </select>
                                    <span class="input-group-btn">
                                        <button class="input-group-addon btn btn-sm btn-info"
                                            (click)="searchTiers(tier.immatriculation, companyId)">
                                            <span class="fa fa-search"></span>
                                        </button>
                                    </span>
                                </div>
                            </div>
                        </div>   
    
                                 <div class="col-sm-2">
                                        <div class="form-group">
                                            <label jhiTranslate="auxiliumApp.tiers.numeroContrat" for="field_tiersNumeroContratTier">numéro de contrat Tiers</label>
                                            <input type="text" class="form-control form-control-sm" name="numeroContratTier" id="field_tiersNumeroContratTier" [disabled]="agentCompanyRO " [(ngModel)]="tier.numeroContrat" [readonly]="old"/>
                                        </div>
                                    </div> 
    
                                    <div class="col-sm-2" >
                                            <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.compagnieAssurance" for="field_compagnieAssuranceTier">Compagnie Assurance New Tier</label>
                                            <select class="form-control form-control-sm" id="field_compagnieAssuranceTier" name="compagnieAssuranceTier" [(ngModel)]="tier.compagnieId" [disabled]="agentCompanyRO "
                                            (ngModelChange)="listAgenceByCompagnie(tier.compagnieId)"required>
                                                <option [ngValue]="compagnieOption.id" *ngFor="let compagnieOption of compagnies">
                                                {{compagnieOption.companyName}} </option>
                                            </select>
                                        </div>
                                        <div class="col-sm-2" *ngIf="this.otherField == false">
                                                <label jhiTranslate="auxiliumApp.contratAssurance.agence" for="field_agenceNewTier"> Agence New Tier
                                                </label> <select class="form-control form-control-sm" id="field_agenceNewTier" name="agenceNewTier" [(ngModel)]="tier.agenceId" [disabled]="agentCompanyRO">
                                                    <option [ngValue]="refAgenceOption.id" *ngFor="let refAgenceOption of refagences" >
                                                        {{refAgenceOption.code}}_{{refAgenceOption.name}}</option>
                                                </select>
                                            </div>
                                        <div class="col-sm-2"   *ngIf="this.otherField == true">
                                                    <label jhiTranslate="auxiliumApp.contratAssurance.agence" for="field_agenceNew"> Agence New Tier
                                                    </label> 
                                                    <select class="form-control form-control-sm" id="field_agenceNew"  name="agenceNew"  [(ngModel)]="tier.optionalAgencyName" (ngModelChange)="newfield(tier.optionalAgencyName)">
                                                            <option value="Autre">Autre</option>
                                                    </select>
                                        </div>
                                        <div class="col-sm-2"*ngIf="nameAgence">
                                                <label class="form-control-label"
                                                jhiTranslate="auxiliumApp.tiers.agence"
                                                    for="field_prenom">prénom</label>
                                                <input type="text" class="form-control form-control-sm" name="agencyName"
                                                    id="field_agencyName" [(ngModel)]="tier.agenceTier"
                                                    pattern="[A-Za-z0-9 ]{1,50}"  maxlength="100"  [readonly]="old" required  />
                                                <small class="form-text text-danger"
                                                    [hidden]="!editFormgrantieImplique.controls.agencyName?.errors?.pattern"
                                                    jhiTranslate="entity.validation.pattern"
                                                    translateValues="{ pattern: 'agencyName' }">
                                                    This field should follow pattern for "Mail".
                                                </small>
                                                <div
                                                    [hidden]="!(editFormgrantieImplique.controls.agencyName?.dirty && editFormgrantieImplique.controls.agencyName?.invalid)">
                                                    <small class="form-text text-danger"
                                                        [hidden]="!editFormgrantieImplique.controls.agencyName?.errors?.required"
                                                        jhiTranslate="entity.validation.required">
                                                        This field is required.
                                                    </small>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.fullName" for="field_raisonSocial">Raison sociale</label>
                                                <input type="text" class="form-control form-control-sm" name="raisonSocialTier" id="field_raisonSocial" [(ngModel)]="tier.fullName" [readonly]="old" maxlength="100"  [disabled]="consultation || agentCompanyRO" required />
                                            </div>

                                            <div class="col-sm-1">
                                            </div>
                                            <div class="col-sm-1">

                                                    <button *ngIf="newFormTiers == false"
                                                    
                                                    class="btn btn-sm btn-primary addnew" (click)="addForm();" [disabled]="consultation">
                                                        <span class="fa fa-plus"></span>
                                                        <span  jhiTranslate="auxiliumApp.observation.home.createLabel">Créer nouveau tier</span>
                                                    </button>
                                                
                                            </div>
                                    
    
                                            
                                            </div>
                                        </div>
        
                                        <div class="col-sm-12">
                                                <div class="row" *ngIf="newFormTiers == true && showFrmTiers">
                                                
                                        
                                
                        
    
                                                <div class="col-sm-2" >
                                                <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.debutValidite" for="field_debutValidite">Début de validité</label>
                                                <div class="input-group">
                                                    <input id="field_debutValidite" type="text" class="form-control form-control-sm" [disabled]="agentCompanyRO " name="debutValidite" ngbDatepicker  #debutValiditeDp="ngbDatepicker" 
                                                    [(ngModel)]="tier.debutValidite" [maxDate]="tier.finValidite" [readonly]="old" required/>
                                                    <span class="input-group-btn">
                                                <button type="button" class="btn btn-sm btn-default" [disabled]="agentCompanyRO " (click)="debutValiditeDp.toggle()"><i class="fa fa-calendar"></i></button>
                                            </span>
                                                </div>
                                            </div>
    
    
    
                                            <div class="col-sm-2" >
                                                <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.finValidite" for="field_finValidite">Fin de validité</label>
                                                <div class="input-group">
                                                    <input id="field_finValidite" type="text" class="form-control form-control-sm" name="finValidite" ngbDatepicker  #finValiditeDp="ngbDatepicker" 
                                                    [(ngModel)]="tier.finValidite" [minDate]="tier.debutValidite" [disabled]="agentCompanyRO " [readonly]="old" required/>
                                                    <span class="input-group-btn">
                                                    <button type="button" class="btn btn-sm btn-default" [disabled]="agentCompanyRO " (click)="finValiditeDp.toggle()"><i class="fa fa-calendar"></i></button>
                                                    </span>
                                                    <br>
                                                    <small class="form-text text-danger" *ngIf="isvalideDate == true"> Date expiré. </small>
                                                </div>
                                            </div>

                                            <div class="col-sm-2" *ngIf="showResponsible">
                                                <br>
                                                    <input type="checkbox" class="check-input" name="responsable" id="field_responsable" [(ngModel)]="tier.responsible" />
                                                    <label class="form-control-label" jhiTranslate="auxiliumApp.tiers.afficherTiers" for="field_responsable">Responsable</label>
                                                </div>

                
    
    
    
                                        </div>
                                    </div>
                                    <div class="col-sm-2" *ngIf="newFormTiers == true && showFrmTiers">
                                        <label class="form-control-label" style="width: 100%">&nbsp;</label>
                                        <button *ngIf="!isTierModeEdit" 
                                        [disabled]="editFormgrantieImplique.form.invalid "
                                        class="btn btn-sm btn-primary addnew" (click)="addTier();">
                                            <span class="fa fa-plus"></span>
                                            <span  jhiTranslate="auxiliumApp.tiers.creerTiers">Créer nouveau tier</span>
                                        </button>
                                        <button *ngIf="isTierModeEdit" 
                                        [disabled]="editFormgrantieImplique.form.invalid && !enableField " 
                                        class="btn btn-sm btn-primary addnew" (click)="editTier();">
                                            <span class="fa fa-pencil"></span>
                                            <span  jhiTranslate="auxiliumApp.observation.home.editLabel">Modifier tier</span>
                                        </button>
                                    </div>
                
                                </div>
                                <br>
                            <div class="row">
                                <div class="col-sm-6" >
                            <div class="alert alert-danger" *ngIf="!tierResponsableVerif" jhiTranslate="auxiliumApp.sinisterPec.verifTiersResponsable">
                                <strong>Merci de vérifier le nombre de véhicules</strong>
                            </div>
                             </div>
                        </div>
                            </form>
                        </div>
    
                                <div class="row" style="margin-top: 15px;">
                                    <div class="col-sm-12">
                                        <div class="table-responsive" *ngIf="tiers && tiers.length > 0">
                                            <table datatable [dtOptions]="dtOptions"  [dtTrigger]="dtTrigger"
                                            class="table table-sm table-hover table-bordered" >
                                                <thead>
                                                <tr jhiSort  style="color: white; background-color: #167F92">
                                                    <th><span jhiTranslate="auxiliumApp.tiers.fullName">fullName</span></th>
                                                    <th><span jhiTranslate="auxiliumApp.contratAssurance.numeroContrat">numeroContrat</span></th>
                                                    <th><span jhiTranslate="auxiliumApp.tiers.debutValidite">Début de validite</span></th>
                                                    <th><span jhiTranslate="auxiliumApp.tiers.finValidite">Fin de validite</span></th>
                                                    <th><span jhiTranslate="auxiliumApp.tiers.compagnieAssurance">Compagnie d'assurance</span></th>
                                                    <th><span jhiTranslate="auxiliumApp.tiers.immatriculation">Immatriculation</span></th>
                                                    <th></th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <ng-container *ngFor="let tierr of tiers">
                                                    <tr *ngIf="!tierr.deleted">
                                                        <td>{{tierr.fullName}}</td>
                                                        <td>{{tierr.numeroContrat}}</td>
                                                        <td>{{parseHtmlDate(tierr.debutValidite)}}</td>
                                                        <td>{{parseHtmlDate(tierr.finValidite)}}</td>
                                                        <td>{{tierr.compagnieNom}}</td>
                                                        <td>{{tierr.immatriculation}}</td>
                                                        <td class="text-right">
                                                            <div class="btn-group flex-btn-group-container">
                                                                <button type="button" (click)="prepareEditTier(tierr)" class="btn btn-primary btn-sm" [disabled] = "!enableField">
                                                                    <span class="fa fa-pencil"></span>
                                                                </button>
                                                                <button type="button" (click)="deleteTier(tierr)" class="btn btn-danger btn-sm" [disabled] = "!enableField">
                                                                    <span class="fa fa-sm fa-remove"></span>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </ng-container>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Tiers list -->
    
                <!-- Piéces Jointes -->
                <div class="row" *ngIf="!isSinPecBonSortie && !isSinPecVerifOrgPrinted">
                        <div class="col-lg-12">
                        <div class="card">
                            <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#pjDetails">
                                <strong jhiTranslate="auxiliumApp.pieceJointe.home.title">Pièces jointes</strong>
                            </div>
                            <div id="pjDetails" class="card-body collapse">
                                <div class="row">
                                            <div class="col-sm-3">
                                                <label jhiTranslate="auxiliumApp.pieceJointe.constat" for="attachmentConstat">Constat</label>
                                            </div> 
                                            <div class="col-sm-3" *ngIf="showConstatAttachment">
                                                    <div class="form-text text-danger clearfix">
                                                        <input type="text" class="form-control" name="attachmentConstat" id="attachmentConstat"
                                                            [(ngModel)]="constatAttachment.label" hidden  [disabled] = "!enableField"/>     
                                                        <input id="field_nameFCart" type="file"
                                                        class="form-control form-control-sm"
                                                        name="nameFCons"
                                                        (change)="onConstatFileChange($event)"
                                                        [(ngModel)]="constatAttachment.label"
                                                        accept=".jpg,.jpeg,.png" required [disabled] = "!enableField" />
                                                    </div> 
                                                </div>
                                                <div class="col-sm-3">     
                                                        <span class="input-group-btn" *ngIf="constatPreview">
                                                            <button type="button"  class="btn btn-sm btn-default" 
                                                                (click)="downloadConstatFile()"><i
                                                                    class="fa fa-sm fa-download"></i></label>
                                                        </span> 
                                                        <span class="input-group-btn" *ngIf="showConstat">
                                                            <button type="button"  class="btn btn-sm btn-default" 
                                                                (click)="getPieceNew('prestationPEC', sinisterPec.id, 'Constat')"><i
                                                                    class="fa fa-sm fa-download"></i></label>
                                                        </span> 
                                                        <span class="input-group-btn" *ngIf="showConstat">
                                                            <button type="button" class="btn btn-danger btn-sm" 
                                                                (click)="deleteConstatFile()" [disabled]="!enableField"><i
                                                                class="fa fa-sm fa-remove"></i></label>
                                                        </span>    
                                            </div>
                                        </div>
                                        <br />
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <label jhiTranslate="auxiliumApp.pieceJointe.carteGrise" for="attachmentCarteGrise">Carte grise</label>
                                            </div> 
                                            <div class="col-sm-3" *ngIf="showCarteGriseAttachment">
                                                    <div class="form-text text-danger clearfix">
                                                        <input type="text" class="form-control" name="attachmentCarteGrise" id="attachmentCarteGrise"
                                                            [(ngModel)]="carteGriseAttachment.label" hidden [disabled] = "!enableField" />
                                                        <input id="field_nameFCart" type="file"
                                                        class="form-control form-control-sm"
                                                        name="nameFCart"
                                                        [(ngModel)]="carteGriseAttachment.label"
                                                        (change)="onCarteGrisFileChange($event)"
                                                        accept=".jpg,.jpeg,.png" required  [disabled] = "!enableField"/>
                                                        <div *ngIf="!carteGrisePreview">
                                                            <span class="help-block error" [hidden]="!carteGrisePreview"> 
                                                              File is Required 
                                                            </span>
                                                           </div>
                                                    </div>
                                                </div>
                                                    <div class="col-sm-3">
                                                        <span class="input-group-btn" *ngIf="carteGrisePreview">
                                                            <button type="button"  class="btn btn-sm btn-default" 
                                                                (click)="downloadCarteGriseFile()"><i
                                                                    class="fa fa-sm fa-download"></i></label>
                                                        </span>
                                                        <span class="input-group-btn" *ngIf="showCarteGrise">
                                                            <button type="button"  class="btn btn-sm btn-default" 
                                                                (click)="getPieceNew('prestationPEC', sinisterPec.id, 'Carte Grise')"><i
                                                                    class="fa fa-sm fa-download"></i></label>
                                                        </span>
                                                        <span class="input-group-btn" *ngIf="showCarteGrise">
                                                            <button type="button" class="btn btn-danger btn-sm" 
                                                                (click)="deleteCarteGriseFile()" [disabled]="!enableField"><i
                                                                class="fa fa-sm fa-remove"></i></label>
                                                        </span>
                                                    </div>
                                           
                                        </div>
                                        <br /> 
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <label jhiTranslate="auxiliumApp.pieceJointe.acteDeCession" for="attachmentActeDeCession">acteDeCession</label>
                                            </div> 
                                            <div class="col-sm-3" *ngIf="showActeDeCessionAttachment">
                                                    <div class="form-text text-danger clearfix">
                                                        <input type="text" class="form-control" name="attachmentActeDeCession" id="attachmentActeDeCession"
                                                            [(ngModel)]="acteCessionAttachment.label" hidden [disabled] = "!enableField" />
                                                
                                                            <input id="field_nameFacte" type="file"
                                                            class="form-control form-control-sm"
                                                            name="nameFacte"
                                                            [(ngModel)]="acteCessionAttachment.label"
                                                            (change)="onActeCessionFileChange($event)"
                                                            accept=".jpg,.jpeg,.png" required [disabled] = "!enableField" />
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <span class="input-group-btn" *ngIf="acteCessionPreview">
                                                            <button type="button"  class="btn btn-sm btn-default" 
                                                                (click)="downloadActeCessionFile()"><i
                                                                    class="fa fa-sm fa-download"></i></label>
                                                        </span>
                                                        <span class="input-group-btn" *ngIf="showActeDeCession">
                                                            <button type="button"  class="btn btn-sm btn-default" 
                                                                (click)="getPieceNew('prestationPEC', sinisterPec.id, 'Acte de cession')"><i
                                                                    class="fa fa-sm fa-download"></i></label>
                                                        </span>
                                                        <span class="input-group-btn" *ngIf="showActeDeCession">
                                                            <button type="button" class="btn btn-danger btn-sm" 
                                                                (click)="deleteActeDeCessionFile()" [disabled]="!enableField"><i
                                                                class="fa fa-sm fa-remove"></i></label>
                                                        </span>
                                            </div>
                                      </div>
                                      <br *ngIf="enableField">
                                      <div class="row" *ngIf="enableField">
                                        <div class="col-sm-2">
                                        <button type="button" class="btn btn-primary btn-sm pull-right"
                                            (click)="ajoutNouvelpieceJointe();" style="margin-top:15px">
                                            <span class="fa fa-edit"></span> <span>Ajouter Nouvelle Piéce Jointe
                                            </span>
                                        </button>
                                    </div>
                                      </div>
                                      <br>
                                      <div *ngIf="ajoutNouvelpieceform">
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.pieceJointe.libelle"
                                                        for="field_libelle">Libelle</label>
                                                    <input type="text" class="form-control form-control-sm"
                                                        name="libelle" id="libelle"
                                                        [(ngModel)]="pieceAttachment1.label" />
                                                    <div [hidden]="!isError">
                                                        <small class="form-text text-danger"
                                                            [hidden]="!islibelleError"
                                                            jhiTranslate="entity.validation.required">This
                                                            field is required.</small>
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <label class="form-control-label"
                                                        jhiTranslate="auxiliumApp.pieceJointe.file"
                                                        for="field_chemin">Fichier</label>
                                                    <input id="field_chemin" type="file"
                                                        class="form-control form-control-sm" name="field_chemin"
                                                        (change)="onPieceFileChange1($event)"
                                                        accept=".jpg,.jpeg,.png" [(ngModel)]="pieceAttachment1.type"
                                                        required />



                                                    <span class="input-group-btn" *ngIf="piecePreview1">
                                                        <button type="button" class="btn btn-sm btn-default"
                                                            (click)="downloadPieceFile1()"><i
                                                                class="fa fa-sm fa-download"></i></button>
                                                    </span>



                                                </div>
                                                <div class="col-sm-3">
                                                    <label style="width: 100%">&nbsp;</label>
                                                    <button
                                                        [disabled]="pieceAttachment1.label  == null ||  pieceAttachment1.type == undefined"
                                                        class="btn btn-sm btn-primary addnew"
                                                        (click)="ajoutPiece1();">
                                                        <span class="fa fa-plus"></span>
                                                        <span
                                                            jhiTranslate="auxiliumApp.observation.home.createLabel">Create
                                                            new Description
                                                        </span>
                                                    </button>
                                                </div>
                                                <br />
                                            </div>
                                        </div>

                                    </div>
                                    <br>
                                    <br>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="table-responsive"
                                                *ngIf="piecesAttachments && piecesAttachments.length > 0">
                                                <table class="table table-sm table-hover table-bordered">
                                                    <thead>
                                                        <tr jhiSort style="color: white; background-color: #167F92">
                                                            <th jhiSortBy="date"><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.libelle">Libelle</span>
                                                                <span class="fa fa-sort"></span></th>
                                                            <th jhiSortBy="date"><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.dateCreation">Date
                                                                    Creation</span>
                                                                <span class="fa fa-sort"></span></th>

                                                            <th><span
                                                                    jhiTranslate="auxiliumApp.pieceJointe.file">Fichier</span>
                                                                <span class="fa fa-sort"></span></th>
                                                            <th><span></span>
                                                                <span class="fa fa-sort"></span></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let piecesjointe of piecesAttachments">
                                                            <td>{{piecesjointe.label}}</td>
                                                            <td>{{piecesjointe.creationDate | date:'dd/MM/yyyy HH:mm:ss'}}</td>

                                                            <td class="text-right" *ngIf="!piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button" class="btn btn-sm btn-default"
                                                                        (click)="downloadPieceFile(piecesjointe.pieceFile)"><i
                                                                            class="fa fa-sm fa-download"></i></button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right" *ngIf="piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <button type="button" class="btn btn-sm btn-default"
                                                                        (click)="getPieceForAttachment('PLUSPHOTOPEC', piecesjointe.id, piecesjointe.originalName)"><i
                                                                            class="fa fa-sm fa-download"></i></button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right" *ngIf="!piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">
                                                                    <!--<button type="button"
                                                                                    (click)="prepareEditPieceJ(piecesjointe)"
                                                                                    class="btn btn-primary btn-sm">
                                                                                    <span class="fa fa-pencil"></span>
                                                                                </button>-->
                                                                    <button type="button"
                                                                        (click)="deletePieceJ(piecesjointe)" [disabled] = "!enableField"
                                                                        class="btn btn-danger btn-sm">
                                                                        <span class="fa fa-sm fa-remove"></span>
                                                                    </button>
                                                                </div>
                                                            </td>
                                                            <td class="text-right"
                                                                *ngIf="piecesjointe.id">
                                                                <div class="btn-group flex-btn-group-container">

                                                                    <button type="button"
                                                                        (click)="deletePieceJointesPH(piecesjointe)" [disabled] = "!enableField"
                                                                        class="btn btn-danger btn-sm"><i
                                                                            class="fa fa-sm fa-remove"></i></button>
                                                                </div>
                                                            </td>

                                                            </ng-container>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>     
                    
                <!-- End Piéces Jointes --> 
                
                <!-- Autres Piéces Jointes -->
                <div class="row" *ngIf="isFromInProgress && piecesJointesAttachments.length > 0">
    <div class="col-lg-12">
    <div class="card">

        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#aup">
            <strong > Autres Pièces jointes</strong>
        </div>
        <div id="aup" class="card-body collapse">
            <div class="row">
                    
                    <div class="col-lg-12">
                <div class="card-body">
                    <div class="table-responsive">
                        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-sm table-hover table-bordered" style="width: 100%">
                            <thead style="color:white;background-color:#11859b">
                                <tr>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.typePiece">type de pièce</span></th>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.nameUserCreate">création user</span></th>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.dateCreation">date création</span></th>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.description">note</span></th>
                                    <th><!--<span jhiTranslate="auxiliumApp.sinisterPec.piece">lien</span>--></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let pieceAttch of piecesJointesAttachments ;">
                                    <td>{{pieceAttch.label}}</td>
                                    <td>{{pieceAttch.firstNameUser}} {{pieceAttch.lastNameUser}}</td>
                                    <td>{{pieceAttch.creationDate | date:'dd/MM/yyyy HH:mm:ss'}}</td>
                                    <td>{{pieceAttch.note}}</td>
                                    <td class="text-right">
                                        <div class="btn-group flex-btn-group-container">
                                            <button type="button" (click)="getPieceForAttachment('autresPiecesJointes', pieceAttch.id, pieceAttch.originalName)" class="btn btn-sm btn-default"><i
                                                    class="fa fa-sm fa-download"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            </div>
              
        </div>
    </div>
</div>
</div>
                <!-- End Autres Piéces Jointes -->

               <!-- Lieu de Réparation / Expert -->
        
               <div class="row" *ngIf="!isSinPecBonSortie && !isSinPecVerifOrgPrinted && !affectReparateur && !cancelExpertMissionary && !expertMissionary && !annulerAffectReparateur">
                    <div class="col-lg-12">
                    <div class="card">
              
                        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#LieuReparation">
                            <strong > Lieu de réparation / Expert</strong>
                        </div>
                        <div id="LieuReparation" class="card-body collapse">
                            <div class="row">
                                <div class="col-sm-2">
                                    <br>
                                    <span style="font-weight:bold;">
                                    <label jhiTranslate="auxiliumApp.reparateur.home.LieuDuReparation">Lieu de réparation</label></span>
                                            
                                    </div>
                            <div class="col-sm-3">
                                <label jhiTranslate="auxiliumApp.reparateur.gouvernorat">gouvernorat réparateur</label>
                                <select  class="form-control form-control-sm" id="field_lieuRep" name="lieuRep"
                                    [(ngModel)]="sinisterPec.gouvernoratRepId"
                                    (ngModelChange)="fetchDelegationsByGovernorateRep(sinisterPec.gouvernoratRepId)" [disabled] = "!enableField">
                                    <option [ngValue]="governorateRep.id" *ngFor="let governorateRep of governorates; trackBy: trackGouvernoratRepById">
                                        {{governorateRep.label}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-sm-3">
                                <label jhiTranslate="auxiliumApp.sinisterPec.ville" for="field_villeRep">Ville</label>
                                <select  class="form-control form-control-sm" id="field_villeRep" name="villeRep"
                                    [(ngModel)]="sinisterPec.villeRepId" [disabled]="!enableField">
                                    <option [ngValue]="sysvilleRep.id"
                                        *ngFor="let sysvilleRep of sysvillesRep; trackBy: trackSysVilleRepById">
                                        {{sysvilleRep.label}}</option>
                                </select>
                            </div>
                        </div>
                            <div class="row" *ngIf="isCentreExpertise">
                            <div class="col-sm-3">
                                    <label jhiTranslate="auxiliumApp.sinisterPec.expert">expert</label>
                                    <select  class="form-control form-control-sm" id="field_expert" name="expert"
                                        [(ngModel)]="sinisterPec.expertId"  [disabled] = "!enableField" >
                                        <option [ngValue]="expert.id" *ngFor="let expert of expertsAffectation">
                                            {{expert.raisonSociale}}
                                        </option>
                                    </select>
                                </div>
                        </div>   
                        </div>
                    </div>
                </div>
        
        </div>
            <!-- Lieu de Réparation / Expert -->


             <!-- Points choc -->
             <div class="row" *ngIf="!isSinPecBonSortie && !isSinPecVerifOrgPrinted && sinisterPec.fromDemandeOuverture == false">
                <div class="col-lg-12">
<!--<span class="anchor" id="formUserEdit"></span>-->
<div class="card">
<div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#pcDetails">
    <strong >Point de choc</strong>
</div>
<div id="pcDetails" class="card-body collapse"> 

  <div class="container-fluid   bg-Point-choc " style="height: 800px; position:relative">
   
  </div>

      <div class="row top-buffer">
              

              <div class="col-sm-3">
                      <input type="checkbox" class="check-input" style="position: absolute;top: -800px;left: 173%;" name="avant"
                      id="field_isavant" [(ngModel)]="pointChoc.avant" [disabled] = "!enableField"  (ngModelChange)="pointChocObligatoire()" />
              </div>  
           </div>  
        


           <div class="row top-buffer">

                  
                  <div class="col-sm-1 input-group-prepend">
                          <input type="checkbox" class="check-input" style="    position: absolute;
                          top: -594px;
                          left: 130%;" name="lateraleGaucheAvant"
                          id="field_islatéraleGaucheAvant"  [(ngModel)]="pointChoc.lateraleGaucheAvant" [disabled] = "!enableField"   (ngModelChange)="pointChocObligatoire()"   />

                  </div> 
               
                  <div class="col-sm-7">
                      
                  <input type="checkbox" class="check-input" name="avantGauche" style="position: absolute;
                  top: -573px;
                  left: 12%;"
                  id="field_isAvantGauche"  [(ngModel)]="pointChoc.avantGauche"  [disabled] = "!enableField" (ngModelChange)="pointChocObligatoire()"  />

                  </div>
                
                  <div class="col-sm-1">
                          <input type="checkbox" class="check-input" name="avantDroite" style="position: absolute;
                          top: -625px;
                          left: 67%;"
                          id="field_isavantDroite"  [(ngModel)]="pointChoc.avantDroite"  [disabled] = "!enableField" (ngModelChange)="pointChocObligatoire()"  />
                  </div>
                

               </div>

               <div class="row top-buffer">
                      <div class="col-sm-1">
                              <input type="checkbox" class="check-input" name="lateraleGauche" style="position: absolute;
                              top: -363px;
                              left: 50%;"
                              id="field_islateraleGauche"  [(ngModel)]="pointChoc.lateraleGauche" [disabled] = "!enableField" (ngModelChange)="pointChocObligatoire()"   /> 
                      </div> 
                      <div class="col-sm-3"> 
                              <input type="checkbox" class="check-input" name="retroviseurGauche"style="position: absolute;
                              left: 25%;
                              top: -507px;"
                              id="field_isretroviseurGauche"  [(ngModel)]="pointChoc.retroviseurGauche" [disabled] = "!enableField" (ngModelChange)="pointChocObligatoire()"  /> 
                      </div>  
                      <div class="col-sm-3">
                           
                              <input type="checkbox" class="check-input" name="pareBriseAvant" style="position: absolute;
                              top: -523px;
                              left: 36%;"
                              id="field_ispareBriseAvant"  [(ngModel)]="pointChoc.pareBriseAvant"  [disabled] = "!enableField" (ngModelChange)="pointChocObligatoire()"  />
                      </div>

                    
                      <div class="col-sm-1">
                              <input type="checkbox" class="check-input" name="retroviseurDroite" [disabled] = "!enableField"
                              style="position: absolute;
                              top: -511px;
                              left: 98%;" id="field_isretroviseurDroite"  [(ngModel)]="pointChoc.retroviseurDroite"  (ngModelChange)="pointChocObligatoire()" />
                      </div>
                   
                      <div class="col-sm-1">
                              <input type="checkbox" class="check-input" name="lateraleDroiteAvant" [disabled] = "!enableField"
                              style="position: absolute;
                              top: -508px;
                              left: 165%;"  id="field_islateraleDroiteAvant"  [(ngModel)]="pointChoc.lateraleDroiteAvant"  (ngModelChange)="pointChocObligatoire()"   />
                      </div>
                      <div class="col-sm-1">
                              <input type="checkbox" class="check-input" name="lateraleDroite" [disabled] = "!enableField"
                              id="field_islateraleDroite" style="position: absolute;
                              top: -465px;
                              left: 155%;"  [(ngModel)]="pointChoc.lateraledroite"  (ngModelChange)="pointChocObligatoire()"   />
                          </div>
                   </div>  
                
                   <div class="row top-buffer">
                          <div class="col-sm-1">
                          </div>  
                         
                          <div class="col-sm-7">     ;
                                  <input type="checkbox" class="check-input" name="vitreAvantGauche" [disabled] = "!enableField"
                                  id="field_isvitreAvantGauche" style="position: absolute;
                                  top: -494px;
                                  left: 12%;" [(ngModel)]="pointChoc.vitreAvantGauche"  (ngModelChange)="pointChocObligatoire()"  />
                          </div> 
                         
                          <div class="col-sm-3">
                                  <input type="checkbox" class="check-input" name="vitreAvantDroit" [disabled] = "!enableField"
                                  id="field_isvitreAvantDroit"  style="position: absolute;
                                  top: -487px;
                                  left: 36%;" [(ngModel)]="pointChoc.vitreAvantDroit"  (ngModelChange)="pointChocObligatoire()"  />

                              </div> 
                       </div>  
                    
                       <div class="row top-buffer">
                              <div class="col-sm-5">
                              </div> 
                              <div class="col-sm-3">
                                      <input type="checkbox" class="check-input" name="toit" [disabled] = "!enableField"
                                      id="field_istoit" style="position: absolute;
                                      top: -492px;
                                      left: 6%;" [(ngModel)]="pointChoc.toit"  (ngModelChange)="pointChocObligatoire()"  />

                              </div>  
                           </div> 


                          </br>
                           <div class="row top-buffer">
                                  <div class="col-sm-1">
                                  </div>  
                                  <div class="col-sm-7">
                                          <input type="checkbox" class="check-input" name="vitreArriereGauche" [disabled] = "!enableField"
                                          id="field_isvitreArriereGauche"  style="position: absolute;
                                          top: -475px;
                                          left: 13%;" [(ngModel)]="pointChoc.vitreArriereGauche"  (ngModelChange)="pointChocObligatoire()" />
                                  </div>  
                                  <div class="col-sm-3">
                                          <input type="checkbox" class="check-input" name="vitreArriereDroit" [disabled] = "!enableField"
                                          id="field_isvitreArrieredroit"  style="position: absolute;
                                          top: -476px;
                                          left: 13%;"  [(ngModel)]="pointChoc.vitreArriereDroit"  (ngModelChange)="pointChocObligatoire()"  />
                                      </div>  
                               </div>  

                                   </br>
                               <div class="row top-buffer">
                                    
                                      <div class="col-sm-1">
                                 </div> 
                                      &nbsp;
                                      <div class="col-sm-7">
                                              <input type="checkbox" class="check-input" name="triangleArriereGauche" [disabled] = "!enableField"
                                              id="field_istriangleArriereGauche" style="position: absolute;
                                              top: -447px;
                                              left: 9%;"  [(ngModel)]="pointChoc.triangleArriereGauche"   (ngModelChange)="pointChocObligatoire()" /> 
                                      </div>
                                    
                                      <div class="col-sm-1">
                                              <input type="checkbox" class="check-input" name="triangleArriereDroit" [disabled] = "!enableField"
                                              id="field_istriangleArriereDroit" style="position: absolute;
                                              top: -452px;
                                              left: 17%;"  [(ngModel)]="pointChoc.triangleArriereDroit" (ngModelChange)="pointChocObligatoire()"  /> 
                                      </div>
                                   
                                   </div>


                                   <div class="row top-buffer">
                                          <div class="col-sm-5">
                                          </div> 
                                          
                                          <div class="col-sm-3">
                                                  <input type="checkbox" class="check-input" name="lunetteArriere" [disabled] = "!enableField"
                                                  id="field_islunetteArriere" style="position: absolute;
                                                  top: -440px;
                                                  left: 8%;" [(ngModel)]="pointChoc.lunetteArriere"  (ngModelChange)="pointChocObligatoire()"  /> 
                                          </div>  
                                       </div>


                               <div class="row top-buffer">
                                      <div class="col-sm-1">
                                              <input type="checkbox" class="check-input" name="lateraleGaucheArriere" [disabled] = "!enableField"
                                              id="field_islateraleGaucheArriere"  style="position: absolute;
                                              top: -444px;
                                              left: 100%;" [(ngModel)]="pointChoc.lateraleGauchearriere"  (ngModelChange)="pointChocObligatoire()" />
                                      </div>  
                                              <div class="col-sm-7">
                                                      <input type="checkbox" class="check-input" name="arriereGauche" [disabled] = "!enableField"
                                                      id="field_isarriereGauche" style="position: absolute;
                                                      top: -382px;
                                                      left: 14%;"  [(ngModel)]="pointChoc.arriereGauche"  (ngModelChange)="pointChocObligatoire()"  /> 
                                              </div>
                                              <div class="col-sm-1">
                                                      <input type="checkbox" class="check-input" name="arriereDroite" [disabled] = "!enableField"
                                                      id="field_isarriereDroite" style="position: absolute;
                                                      top: -356px;
                                                      left: 36%;" [(ngModel)]="pointChoc.arriereDroite"  (ngModelChange)="pointChocObligatoire()"  /> 
                                              </div>
                                              <div class="col-sm-1">
                                                      <input type="checkbox" class="check-input" name="lateraleDroiteArriere" [disabled] = "!enableField"
                                                      id="field_islateraleDroiteArriere" style="position: absolute;
                                                      top: -481px;
                                                      left: 55%;" [(ngModel)]="pointChoc.lateraleDroiteArriere"  (ngModelChange)="pointChocObligatoire()"  /> 
                                              </div>
                                              <div class="col-sm-1">
                                              </div>
                              </div> 

 
                          <div class="row top-buffer">
                                  <div class="col-sm-3">
                                      </div>  
                                      <div class="col-sm-2">
                                          </div>  
                                  <div class="col-sm-3">
                                          <input type="checkbox" class="check-input" name="arriere" [disabled] = "!enableField"
                                          id="field_isarriere" style="position: absolute;
                                          top: -263px;
                                          left: 32%;" [(ngModel)]="pointChoc.arriere"  (ngModelChange)="pointChocObligatoire()"  /> 
                                  </div>  
                               </div>                             
  

  <div class="row top-buffer">
    &nbsp;   <span > &nbsp;     Description du point de choc  :  &nbsp; </span>
  <span *ngIf="pointChoc.toit">Toit &nbsp;</span>
  <span *ngIf="pointChoc.avant">Avant &nbsp;</span>
  <span *ngIf="pointChoc.arriere" >Arrière &nbsp;</span>
  <span *ngIf="pointChoc.arriereGauche" >Arrière gauche &nbsp;</span>
  <span *ngIf="pointChoc.lateraleGauche" >Latérale gauche &nbsp;</span>
  <span *ngIf="pointChoc.lateraleGauchearriere">Latérale arrière gauche &nbsp;</span>
  <span *ngIf="pointChoc.lateraleGaucheAvant">Latérale avant gauche &nbsp;</span>
  <span *ngIf="pointChoc.arriereDroite" >Arrière droite &nbsp;</span>
  <span *ngIf="pointChoc.lateraledroite" >Latérale droite &nbsp;</span>
  <span *ngIf="pointChoc.lateraleDroiteAvant" >Latérale  avant droite &nbsp;</span>

  <span *ngIf="pointChoc.lateraleDroiteArriere"> Latérale arrière  droite &nbsp;</span>
  <span *ngIf="pointChoc.avantGauche"> Avant gauche &nbsp;</span>
  <span *ngIf="pointChoc.avantDroite" > Avant droite &nbsp;</span>
  <span *ngIf="pointChoc.retroviseurGauche" > Retroviseur gauche &nbsp;</span>
  <span *ngIf="pointChoc.retroviseurDroite" > Retroviseur droite  &nbsp;</span>

  <span *ngIf="pointChoc.lunetteArriere"> Lunette arrière &nbsp;</span>
  <span *ngIf="pointChoc.pareBriseAvant"> Pare brise avant &nbsp;</span>
  <span *ngIf="pointChoc.triangleArriereGauche" > Triangle arrière gauche &nbsp;</span>
  <span *ngIf="pointChoc.triangleArriereDroit" > Triangle arrière droit &nbsp;</span>
  <span *ngIf="pointChoc.vitreAvantDroit" > Vitre avant droite &nbsp;</span>

  <span *ngIf="pointChoc.vitreAvantGauche"> Vitre avant gauche  &nbsp;</span>
  <span *ngIf="pointChoc.vitreArriereDroit"> Vitre arrière droit  &nbsp;</span>
  <span *ngIf="pointChoc.vitreArriereGauche"> Vitre arrière gauche  &nbsp;</span>

</div>
</div>
</div>

</div>
</div>


          
    <!-- End Points Choc -->

      

      <!-- Motifs Reouverture -->
      <div class="row" *ngIf="isSave && motfReopened">
        <div class="col-lg-12">
        <div class="card">
  
            <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#Motifs">
                <strong > Motifs</strong>
            </div>
            <div id="Motifs" class="card-body collapse">
                <div class="row">
                    <div class="col-sm-5">
                        <div class="row">
                            <div class="col-lg-10">
                                <div class="form-group" >
                                    <label jhiTranslate="auxiliumApp.sinisterPec.MotifsDeReprise" for="field_reopenMotifs">Motif Reopen</label>
                                    <select class="form-control form-control-sm" id="field_reopenMotifs" name="reopenMotifs"
                                    [(ngModel)]="sinisterPec.motifsReopenedId" required>
                                        <option [ngValue]="option.id" *ngFor="let option of motifsReopened">
                                                {{option.label}}
                                        </option>
                                    </select>
                                </div>

                            </div>
                        </div>
                    </div>
            </div>  
            </div>
        </div>
    </div>
</div>
<!-- Motifs Reouverture -->
<!-- Motifs RESERVE -->
<div class="row" *ngIf="showMotifAction && sinisterPec.motifsDecisionId !== null && sinisterPec.decision !== 'ACCEPTED'">
    <div class="col-lg-12">
    <div class="card">

        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#Motifs">
            <strong > Motifs </strong>
        </div>
        <div id="Motifs" class="card-body collapse">
            <div class="row">
                <div class="col-sm-2">
                    <br>
                    <span style="font-weight:bold;">
                    <label jhiTranslate="auxiliumApp.sinisterPec.listMotifs">Motifs</label></span>
                            
                    </div>
            <div class="col-sm-6">
                <br>
                <select  class="form-control form-control-sm" id="field_mlr" name="mlr"
                    [(ngModel)]="sinisterPec.motifsDecisionId" disabled>
                    <option [ngValue]="rsRf.id" *ngFor="let rsRf of raisonLevesReserves; trackBy: trackReasonById">
                        {{rsRf.label}}
                    </option>
                </select>
            </div>
            
        </div>
               
        </div>
    </div>
</div>
</div>
<!-- Motifs RESERVE -->

      <!-- Motifs Annulation -->
      <div class="row" *ngIf="confirmPrest">
        <div class="col-lg-12">
        <div class="card">
  
            <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#Motifs">
                <strong > Motifs</strong>
            </div>
            <div id="Motifs" class="card-body collapse">
                <div class="row">
                    <div class="col-sm-2">
                        <br>
                        <span style="font-weight:bold;">
                        <label jhiTranslate="auxiliumApp.sinisterPec.listMotifs">Motifs</label></span>
                                
                        </div>
                <div class="col-sm-3" *ngIf="isConfirmRefusPec || isRefusPec">
                    <br>
                    <select required class="form-control form-control-sm" id="field_rfs" name="rsRf"
                        [(ngModel)]="sinisterPec.reasonRefusedId">
                        <option [ngValue]="rsRf.id" *ngFor="let rsRf of reasonsRefused; trackBy: trackReasonById">
                            {{rsRf.label}}
                        </option>
                    </select>
                </div>
                <div class="col-sm-3" *ngIf="isConfirmCancPec || isCancPec">
                    <br>
                    <select required class="form-control form-control-sm" id="field_rsCc" name="rsCc"
                        [(ngModel)]="sinisterPec.reasonCanceledId"  
                        [disabled]="disabledMotif">
                        <option [ngValue]="rsCanc.id" *ngFor="let rsCanc of reasonsCanceled; trackBy: trackReasonById">
                            {{rsCanc.label}}
                        </option>
                    </select>
                </div>
                
            </div>
                   
            </div>
        </div>
    </div>
</div>
<!-- Motifs Annulation -->

<!-- BonSORTIE -->
<div class="row" *ngIf="isSinPecBonSortie">
    <div class="col-lg-12">
    <div class="card">

        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#BonSortie">
            <strong > Bon de sortie</strong>
        </div>
        <div id="BonSortie" class="card-body collapse">
            <div class="row">

                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.participationGa">Participation GA</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_ga" id="field_ga"
                                [(ngModel)]="apecTotale.participationGa" disabled  />
                </div>
                <div class="col-sm-2"></div>
                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.droitDeTimbre">Droit de timbre</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_Timbre" id="field_Timbre"
                                [(ngModel)]="apecTotale.droitDeTimbre" disabled  />
                </div>
            </div>
            <br>
            <div class="row">

                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.participationAssure">Participation assuré</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_assure" id="field_assure"
                                [(ngModel)]="apecTotale.participationAssure" disabled  />
                </div>
                <div class="col-sm-2"></div>
                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.participationVetuste">Participation vétusté</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_vetuste" id="field_vetuste"
                                [(ngModel)]="apecTotale.participationVetuste" disabled  />
                </div>
            </div>
            <br>
            <div class="row">

                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.participationTva">Participation TVA</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_TVA" id="field_TVA"
                                [(ngModel)]="apecTotale.participationTva" disabled  />
                </div>
                <div class="col-sm-2"></div>
                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.participationRpc">Participation responsabilité</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_responsability" id="field_responsability"
                                [(ngModel)]="apecTotale.participationRpc" disabled  />
                </div>
            </div>
            <br>
            <div class="row">

                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.fraisDossier">Frais de dossier</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_frais" id="field_frais"
                                [(ngModel)]="apecTotale.fraisDossier" disabled  />
                </div>
                <div class="col-sm-2"></div>
                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.avanceFacture">Avance sur facture</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_avance" id="field_avance"
                                [(ngModel)]="apecTotale.avanceFacture" disabled  />
                </div>
            </div>
            <br>
            <div class="row">

                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.depacementPlafond">Déplacement plafond</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_plafond" id="field_plafond"
                                [(ngModel)]="apecTotale.depacementPlafond" disabled  />
                </div>
                <div class="col-sm-2"></div>
                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.estimationFranchise">Franchise</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_franchise" id="field_franchise"
                                [(ngModel)]="apecTotale.estimationFranchise" disabled  />
                </div>
            </div>
            <br>
            <div class="row">

                <div class="col-sm-2">
                    <label jhiTranslate="auxiliumApp.apec.regleProportionnel">Règle Proportionelle</label>
                </div>
                <div class="col-sm-2">
                    <input type="number" class="form-control form-control-sm" name="field_regle_proportionelle" id="field_regle_proportionelle"
                                [(ngModel)]="apecTotale.regleProportionnel" disabled  />
                </div>
            </div>
               
        </div>
    </div>
</div>
</div>

<!-- BonSORTIE -->


<!-- Imprimé -->
<div class="row" *ngIf="isSinPecVerifOrgPrinted && imprimesAttachments.length > 0">
    <div class="col-lg-12">
    <div class="card">

        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info" data-toggle="collapse" href="#Imprime">
            <strong > Pièces jointes</strong>
        </div>
        <div id="Imprime" class="card-body collapse">
            <div class="row">
                    
                    <div class="col-lg-12">
                <div class="card-body">
                    <div class="table-responsive">
                        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-sm table-hover table-bordered" style="width: 100%">
                            <thead style="color:white;background-color:#11859b">
                                <tr>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.typePiece">type de pièce</span></th>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.nameUserCreate">création user</span></th>
                                    <th><span jhiTranslate="auxiliumApp.sinisterPec.dateCreation">date création</span></th>
                                    <th><!--<span jhiTranslate="auxiliumApp.sinisterPec.piece">lien</span>--></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let pieceAttch of imprimesAttachments ;">
                                    <td>{{pieceAttch.label}}</td>
                                    <td>{{pieceAttch.firstNameUser}} {{pieceAttch.lastNameUser}}</td>
                                    <td>{{pieceAttch.creationDate | date:'dd/MM/yyyy'}}</td>
                                    <td class="text-right">
                                        <div class="btn-group flex-btn-group-container">
                                            <button type="button" (click)="getPieceForAttachment('imprimePec', pieceAttch.id, pieceAttch.originalName)" class="btn btn-sm btn-default"><i
                                                    class="fa fa-sm fa-download"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            </div>
              
        </div>
    </div>
</div>
</div>
<!-- Imprimé -->

<!-- Début Affectation Reparateur -->
                            <div class="row" *ngIf="affectReparateur &&!isSinPecBonSortie && !isSinPecVerifOrgPrinted ">
                            
                                <div class="col-lg-12">
                                    <div class="card">
                                        <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                                            data-toggle="collapse" href="#reparateursDetails">
                                            <strong jhiTranslate="entity.affectReparateur.title">Affectation
                                                réparateur</strong>
                                        </div>
                                        <div id="reparateursDetails" class="card-body collapse">
                                            <div class="col-sm-12">
                                                    <div class="row">
                                                        <div class="col-sm-3">
                                                            <label
                                                                jhiTranslate="auxiliumApp.prestationPEC.gouvernorat">Gouvernorat</label>
                                                            <select class="form-control form-control-sm"
                                                                style="background-color: white" id="field_gouvernorat"
                                                                name="field_gouvernorat"
                                                                [(ngModel)]="selectedGouvernorat"   
                                                                (ngModelChange)="listReparateursByGouvernorat(selectedGouvernorat);" [disabled] = "annulerAffectReparateur" required>
                                                                <option [ngValue]="gouvernoratsOption.id"
                                                                    *ngFor="let gouvernoratsOption of sysgouvernorats; ">
                                                                    {{gouvernoratsOption?.label}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-sm-6">
                                                            <label
                                                                jhiTranslate="auxiliumApp.reparateur.home.title">Réparateurs</label>
                                                            <select class="form-control form-control-sm"
                                                                style="background-color: white" id="field_reparateur"
                                                                name="field_reparateur" [(ngModel)]="sinisterPec.reparateurId" required 
                                                                (ngModelChange)="nbreMissionByReparateur(sinisterPec.reparateurId)" [disabled] = "annulerAffectReparateur">
                                                                <option [ngValue]="reparateur.id"
                                                                    *ngFor="let reparateur of reparateursAffecte;">
                                                                    {{reparateur.info}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                
                                            </div>


                                            <div class="col-sm-12">
                                                <div class="row">
                                                        <div class="col-sm-3">
                                                                <label jhiTranslate="auxiliumApp.reparateur.capacite"
                                                                    for="field_nbmissionreparateur"> Capacité réparateur
                                                                    affectés</label>
                                                                <div class="input-group">
                                                                    <input id="field_capacite_reparateur" type="text"
                                                                        class="form-control form-control-sm"
                                                                        name="capacitereparateur"
                                                                        [(ngModel)]="capacite" required readonly />
        
                                                                </div>
                                                            </div>
                                                    <div class="col-sm-3">
                                                         <label jhiTranslate="auxiliumApp.reparateur.nbmissions"
                                                            for="field_nbmissionreparateur">Nombres de missions
                                                            affectées</label>
                                                        <div class="input-group">
                                                            <input id="field_nbmissionreparateur" type="text"
                                                                class="form-control form-control-sm"
                                                                name="nbmissionreparateur"
                                                                [(ngModel)]="nbmissionreparateur" required readonly />

                                                        </div>
                                                    </div>

                                                    <div class="col-lg-4">
                                                        <div class="form-group">
                                                            <label class="form-control-label" jhiTranslate="auxiliumApp.sinisterPec.dateRdvReparateur"
                                                                for="field_dateRdvReparateur">date Rdv Réparateur</label>
                                                            <div class="input-group">
                                                                <input id="field_dateRdvReparateur" type="text" class="form-control form-control-sm" name="dateRdvReparateur" ngbDatepicker #insuredArrivalDate="ngbDatepicker" [minDate]="myDate"
                                                                    [(ngModel)]="sinisterPec.dateRDVReparation"  [minDate]="myDate" required [disabled] = "annulerAffectReparateur"/>
                                                                <span class="input-group-btn">
                                                                    <button type="button" class="btn btn-sm btn-default" (click)="insuredArrivalDate.toggle()"><i class="fa fa-sm fa-calendar"></i></button>
                                                                </span>&nbsp;&nbsp;
                                                                <ngb-timepicker  size="small" [(ngModel)]="reparateurArrivalTime" [spinners]="false" name="insuredArrivalTime"  min="9:00" max="18:00" [disabled] = "annulerAffectReparateur" required>    <span class="note">Les heures de bureau sont de 9h à
                                                                    18h</span></ngb-timepicker>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>

   
                                                <div class="col-sm-6">
                                                    <div *ngIf="annulerAffectReparateur">
                                                        <label class="form-control-label"
                                                            jhiTranslate="auxiliumApp.refRemorqueur.motifs">Sélectionnez
                                                            un motif</label>
                                                        <select class="form-control form-control-sm"
                                                            id="motifReparateur" name="motifReparateur"
                                                            [(ngModel)]="sinisterPec.reasonCancelAffectedRepId" required>
                                                            <option [ngValue]="refMotifOption.id"
                                                                *ngFor="let refMotifOption of motifs; trackBy: trackMotifsById">
                                                                {{refMotifOption.label}}</option>
                                                        </select>
                                                    </div>
                                                </div>





                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Fin Affectation Reparateur -->




        <!-- Début Affectation Expert -->
        <div class="row" *ngIf="expertMissionary || (expertMissionary && !cancelExpertMissionary)">
            <div class="col-lg-12">
                <div class="card">
                    <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                        data-toggle="collapse" href="#reparateursDetails">
                        <strong>Missionner expert</strong>
                    </div>
                    <div id="reparateursDetails" class="card-body collapse">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-3" *ngIf="!cancelExpertMissionary">
                                    <label jhiTranslate="auxiliumApp.sinisterPec.gouvernorat">Gouvernorat</label>
                                    <select class="form-control form-control-sm" style="background-color: white"
                                        id="field_gouvernorat" name="field_gouvernorat"
                                        [(ngModel)]="selectedGouvernorat"
                                        (ngModelChange)="listExpertsByGouvernorat(selectedGouvernorat);"
                                        [disabled]="cancelExpertMissionary" required>
                                        <option [ngValue]="gouvernoratsOption.id"
                                            *ngFor="let gouvernoratsOption of sysgouvernorats; ">
                                            {{gouvernoratsOption?.label}}</option>
                                    </select>
                                </div>
                                <div class="col-sm-3">
                                    <label jhiTranslate="auxiliumApp.expert.home.title">Experts</label>
                                    <select class="form-control form-control-sm" style="background-color: white"
                                        id="field_expert" name="field_expert" [(ngModel)]="sinisterPec.expertId"
                                        (ngModelChange)="nbreMissionByExpert(sinisterPec.expertId)"
                                        [disabled]="cancelExpertMissionary" required>
                                        <option [ngValue]="expert.id" *ngFor="let expert of expertsAffectation;">
                                            {{expert.raisonSociale}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-3">
                                    <label jhiTranslate="auxiliumApp.sinisterPec.nbrMissions"
                                        for="field_nbmissionexpert">Nombres de missions
                                        affectées</label>
                                    <div class="input-group">
                                        <input id="field_nbmissionexpert" type="text"
                                            class="form-control form-control-sm" name="nbmissionExpert"
                                            [(ngModel)]="nbmissionExpert" readonly required />

                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="col-sm-12">
                            <div class="row" *ngIf="cancelExpertMissionary">
                                <label for="reasonExpert"> Motifs </label>

                                <select required class="form-control" id="reasonExpert" name="reasonExpert"
                                    [(ngModel)]="sinisterPec.reasonCancelExpertId" required>

                                    <option [ngValue]="reasonOption.id"
                                        *ngFor="let reasonOption of reasons; trackBy: trackReasonById">
                                        {{reasonOption.label}}</option>
                                </select>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <!-- Fin Affectation Expert -->


        <!--Listes Observation-->
<div class="row">
    <div class="col-lg-12">

        <div class="card">
            <div class=" collapsible-card card-header align-items-center collapsed notice notice-info"
                data-toggle="collapse" href="#collapseObservation">
                <strong>Observations </strong>
            </div>
        </div>
        <div id="collapseObservation" class="card-body collapse">
            <div class="row">
                <div class="col-sm-6">
                    <input type="text" class="form-control form-control-sm" name="observation"
                        id="observationId" [(ngModel)]="observation.commentaire" />
                    <div [hidden]="!isCommentError">
                        <small class="form-text text-danger" [hidden]="!isCommentError"
                            jhiTranslate="entity.validation.required">This
                            field is required.</small>
                    </div>
                </div>
                <div class="col-sm-2">
                    <button *ngIf="!isObsModeEdit" class="btn btn-sm btn-primary addnew"
                        (click)="addObservation();">
                        <span class="fa fa-plus"></span>
                        <span jhiTranslate="auxiliumApp.observation.home.createLabel">Create new
                            Observation
                        </span>
                    </button>
                    <button *ngIf="isObsModeEdit" class="btn btn-sm btn-primary addnew"
                        (click)="editObservation();">
                        <span class="fa fa-pencil"></span>
                        <span jhiTranslate="auxiliumApp.observation.home.editLabel">Edit
                            Observation
                        </span>
                    </button>
                   
                </div>
            </div>
            <div class="row" style="margin-top: 15px;">
                <div class="col-sm-12">
                    <div class="table-responsive"
                        *ngIf="observationss && observationss.length > 0">
                        <table class="table table-sm table-hover table-bordered" style="width: 100%">
                            <thead>
                                <tr jhiSort style="color: white; background-color: #167F92">
                                    <th jhiSortBy="date"><span
                                            jhiTranslate="auxiliumApp.observation.date">Date</span>
                                        <span class="fa fa-sort"></span></th>
                                    <th><span
                                            jhiTranslate="auxiliumApp.observation.commentaire">Commentaire</span>
                                        <span class="fa fa-sort"></span></th>
                                    <th jhiSortBy="userLogin"><span
                                            jhiTranslate="auxiliumApp.observation.user">Utilisateur</span>
                                        <span class="fa fa-sort"></span></th>
                                    <!--<th></th>-->
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let observation of observationss">
                                    <tr *ngIf="!observation.deleted">
                                        <td>{{observation.date  | date:'dd/MM/yy'}}</td>
                                        <td>{{observation.commentaire}}</td>
                                        <td>{{observation.firstName}}
                                            {{observation.lastName}}</td>
                                        <!--<td class="text-right">
                                            <div class="btn-group flex-btn-group-container">
                                                <button type="button"
                                                    (click)="prepareEditObservation(observation)"
                                                    class="btn btn-primary btn-sm">
                                                    <span class="fa fa-pencil"></span>
                                                </button>
                                                <button type="button"
                                                    (click)="deleteObservation(observation)"
                                                    class="btn btn-danger btn-sm">
                                                    <span class="fa fa-trash"></span>
                                                </button>
                                            </div>
                                        </td>-->
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>

</div>
<!--Listes Observations-->


                            <div class="row">
                                <div class="col-sm-4" >
                            <div class="alert alert-danger" *ngIf="!showMsgMotifRqrdCancel" jhiTranslate="auxiliumApp.sinisterPec.motifCanceled">
                                <strong>Merci d'ajouter un motif</strong>
                            </div>
                             </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-4" >
                        <div class="alert alert-danger" *ngIf="!showMsgMotifRqrdRefus" jhiTranslate="auxiliumApp.sinisterPec.motifCanceled">
                            <strong>Merci d'ajouter un motif</strong>
                        </div>
                         </div>
                    </div>

                <!-- Bouton Save et Envoyer-->
                <div class="row">
                        <div class="col-sm-6">
                                <div class="alert alert-danger" *ngIf="affectReparateurWithCapacity" jhiTranslate="auxiliumApp.sinisterPec.home.affectationWithCapacity">
                                        <strong>affectReparateurWithCapacity</strong>
                                    </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6">
                                <div class="alert alert-danger" *ngIf="!tierRespMin" jhiTranslate="auxiliumApp.sinisterPec.minTiersResponsable">
                                        <strong>Merci d'ajouter un tiers à afficher</strong>
                                    </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6">
                                <div class="alert alert-danger" *ngIf="!canCancelMissionementExpert" jhiTranslate="auxiliumApp.sinisterPec.annuleMissionExpert">
                                        <strong>Vous n'avez pas le droit d'annuler un expert</strong>
                                    </div>
                        </div>
                    </div>

                <div class="modal-footer">
                    <button *ngIf="!isSave && !affectReparateur && !isSinPecChangeStatus && !cancelExpertMissionary && !expertMissionary  && !isSinPecRefusedCanceled && !isSinPecVerifOrgPrinted && !isSinPecBonSortie && !isCancPec && !isConfirmCancPec && !isRefusPec && !isConfirmRefusPec && !isAcceptedWithChangeStatus "  type="submit" class="btn btn-sm btn-primary" (click)="reopen()">
                        <span>Reprise prestation</span>
                    </button>
                    <button  *ngIf="isSave && !isCanceled && !isRefused && !isSinPecRefusedCanceled " [disabled]="frm.invalid  ||   editForm.invalid  ||  !tiersLength || !PointChocRequired || !refBar" type="submit" class="btn btn-sm btn-primary" (click)="reprise()">
                        <span class="fa fa-save"></span>&nbsp;
                        <span>Sauvegarder</span>
                </button>
                    <button  *ngIf="isSave && (isCanceled || isRefused || isSinPecRefusedCanceled)" [disabled]="!sinisterPec.motifsReopenedId" type="submit" class="btn btn-sm btn-primary" (click)="reprise()">
                            <span class="fa fa-save"></span>&nbsp;
                            <span>Sauvegarder</span>
                    </button>
                    <button *ngIf="sinisterPec.prestAApprouv" [disabled]="frm.invalid  ||    editForm.invalid  ||  !tiersLength || !PointChocRequired || !refBar " type="submit" class="btn btn-sm btn-primary" (click)="approuve()">
                
                        <span style="color:#ff7414">Approuver</span>
                    </button>
                    <button *ngIf="sinisterPec.prestAApprouv" [disabled]="frm.invalid  ||  editForm.invalid  ||  !tiersLength || !PointChocRequired || !refBar " type="submit" class="btn btn-sm btn-primary" (click)="approuveWithModif()">
                    <span>Approuver avec modification</span>
                    </button>
                    <button *ngIf="decisionPrest" [disabled]="frm.invalid  ||  editForm.invalid  ||  !tiersLength  || !PointChocRequired || !refBar" type="submit" class="btn btn-sm btn-primary" (click)="decider()">
                       <span>Décision</span>
                    </button>
                    <button *ngIf="sendPrest" [disabled]="frm.invalid  ||  editForm.invalid  ||  !tiersLength || !refBar " type="submit" class="btn btn-sm btn-primary" (click)="envoyer()">
                        <span>Envoyer</span>
                     </button>

                    <button *ngIf="affectReparateur && !annulerAffectReparateur && buttonAffReparateur" [disabled]="frm.invalid  ||  editForm.invalid  " type="submit" class="btn btn-sm btn-primary" (click)="AffectationReparateur()">
                        <span>Affecter réparateur</span>
                    </button>
                    <button *ngIf="annulerAffectReparateur"  type="submit" class="btn btn-sm btn-primary" [disabled]="frm.invalid  ||  editForm.invalid  " (click)="annulerAffectationReparateur()">
                        <span>Annulation affectation réparateur</span>
                    </button>

                    <button *ngIf="expertMissionary == true && cancelExpertMissionary == false && buttonMissExpert == true" [disabled]="frm.invalid  ||  editForm.invalid  " type="submit" class="btn btn-sm btn-primary" (click)="MissionerExpert()">
                        <span>Missionner expert</span>
                    </button>
                    <button *ngIf="cancelExpertMissionary == true"  type="submit" class="btn btn-sm btn-primary" [disabled]="frm.invalid  ||  editForm.invalid  " (click)="annulerMissionExpert()">
                        <span>Annulation mission expert</span>
                    </button>
                    <button *ngIf="isAcceptedWithChangeStatus"   type="submit" [disabled]="frm.invalid  ||  editForm.invalid  ||  !tiersLength  || !PointChocRequired" class="btn btn-sm btn-primary" (click)="accepter()">
                        <span>Accepter</span>
                    </button>
                    <button *ngIf="isAcceptedWithChangeStatus"  type="submit" [disabled]="frm.invalid  ||  editForm.invalid  ||  !tiersLength || !PointChocRequired " class="btn btn-sm btn-primary" (click)="refuser()">
                        <span> Refuser</span>
                    </button>
                    <button *ngIf="reopenPrest"  type="submit" [disabled]="frm.invalid  ||  editForm.invalid  ||  !tiersLength " class="btn btn-sm btn-primary" (click)="reopen()">
                        <span>Reprise prestation</span>
                    </button>
                    <div class="form-group" *ngIf="isSinPecChangeStatus">
                        &nbsp;&nbsp;
                        <button type="submit" [routerLink]="['/sinister-pec-change-status']" replaceUrl="true" class="btn btn-default btn-sm pull-right margin-right-5">
                            <span jhiTranslate="entity.action.back">retour</span>
                        </button>
                        &nbsp;&nbsp;
                    </div>
                    <button *ngIf="isSinPecBonSortie"  type="submit"  class="btn btn-sm btn-primary" (click)="genererBonSortie()">
                        <span>Générer bon de sortie</span>
                    </button>
                    <button *ngIf="isSinPecVerifOrgPrinted"  type="submit"  class="btn btn-sm btn-primary" (click)="nonConforme()">
                        <span>Non conforme</span>
                    </button>
                    <button *ngIf="isSinPecVerifOrgPrinted"  type="submit"  class="btn btn-sm btn-primary" (click)="conforme()" [disabled]="imprimesAttachments.length == 0">
                        <span>Conforme</span>
                    </button>
                    <button *ngIf="isCancPec && annulPrest"  type="submit"  class="btn btn-sm btn-primary" (click)="annulerPrestation()">
                        <span>Annuler prestation</span>
                    </button>
                    <button *ngIf="isCancPec && confirmPrest "  type="submit"  class="btn btn-sm btn-primary" (click)="ConfirmerAnnulPrest()">
                        <span>Confirmer</span>
                    </button>
                    
                    
                    <button *ngIf="isConfirmCancPec "  type="submit"  class="btn btn-sm btn-primary" (click)="nonConfirmerAnnul()">
                        <span>Ne pas confirmer</span>
                    </button>
                    <button *ngIf="isConfirmCancPec "  type="submit"  class="btn btn-sm btn-primary" (click)="ConfirmerAnnul()">
                        <span>Confirmer</span>
                    </button>
                    <button *ngIf="isRefusPec && annulPrest"  type="submit"  class="btn btn-sm btn-primary" (click)="annulerPrestation()">
                        <span>Refuser prestation</span>
                    </button>
                    <button *ngIf="isRefusPec"  type="submit"  class="btn btn-sm btn-primary" (click)="ConfirmerRefusPrest()">
                        <span>Confirmer</span>
                    </button>
                    
                    <button *ngIf="isConfirmRefusPec "  type="submit"  class="btn btn-sm btn-primary" (click)="nonConfirmerRefus()">
                        <span>Ne pas Confirmer</span>
                    </button>
                    <button *ngIf="isConfirmRefusPec"  type="submit"  class="btn btn-sm btn-primary" (click)="ConfirmerRefus()">
                        <span>Confirmer</span>
                    </button>
                </div>
            </form>
        </div>
    </section>
    <!-- PRESTATION PEC AGENT-->